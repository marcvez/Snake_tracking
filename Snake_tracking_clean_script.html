<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marc Vez-Garzón">

<title>Snake tracking</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Snake_tracking_clean_script_files/libs/clipboard/clipboard.min.js"></script>
<script src="Snake_tracking_clean_script_files/libs/quarto-html/quarto.js"></script>
<script src="Snake_tracking_clean_script_files/libs/quarto-html/popper.min.js"></script>
<script src="Snake_tracking_clean_script_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Snake_tracking_clean_script_files/libs/quarto-html/anchor.min.js"></script>
<link href="Snake_tracking_clean_script_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Snake_tracking_clean_script_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Snake_tracking_clean_script_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Snake_tracking_clean_script_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Snake_tracking_clean_script_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Snake tracking</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marc Vez-Garzón </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="snake-tracking" class="level1">
<h1>Snake tracking</h1>
<p>This document includes all the parts dedicated to analyse the movement and behaviour of multiple individuals of <em>Hemorrhois hippocrepis</em> collected on the island of Ibiza during the months of April to June 2023 and 2024.</p>
<p>In this study, we try to find if there are significant differences in the use of space, boldness, and exploratory behaviour between regions of the island recently invaded with populations of <em>Podarcis pityusensis</em> (endemic lizard of the island of Ibiza, threatened by this invasive snake) and regions of the island invaded for a long time and without natural populations of lizards.</p>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">0. Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(utils)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsurvfit)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">1. Load data</h2>
<p>Load the required files needed to run this script. Files can be found in https://github.com/marcvez/Snake_tracking.git</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load file with snake info</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Snake_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Snake_captures.xlsx"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset tracked snakes</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked <span class="ot">&lt;-</span> Snake_data[Snake_data<span class="sc">$</span>Tracking <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Y"</span>), ]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset tracked + genetics/isotopes + x-ray sample </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked <span class="ot">&lt;-</span> Snake_data_tracked[<span class="sc">!</span><span class="fu">is.na</span>(Snake_data_tracked<span class="sc">$</span>SVL), ]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load snake 3D array</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Snake_array.Rda"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Load arena 3D array</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Arena_array.Rda"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Load summary file from all snake trials</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>summary_tracking <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"summary_tracking.xlsx"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Load summary file from all snake trials + environmental variables</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"summary_tracking_complete.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For some analyses, we might need a data frame with only the first trials of each snakes, without gravid females, or with only those individuals that got out of the initial refuge and explored the arena.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>time_limit <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># No repeated indiviuals, only with new ones</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep <span class="ot">&lt;-</span> summary_tracking_complete[summary_tracking_complete<span class="sc">$</span>Repeatability <span class="sc">==</span> <span class="st">"N"</span>,]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, for some individuals, we are only going to use individuals that actually got out of the refuge (Body-out != 3000)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep_outside <span class="ot">&lt;-</span> summary_tracking_complete_no_rep[summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw <span class="sc">!=</span> time_limit, ]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create one without gravid individuals that got out (visual exploration)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep_outside_noeggs <span class="ot">&lt;-</span> summary_tracking_complete_no_rep_outside[summary_tracking_complete_no_rep_outside<span class="sc">$</span>N_eggs <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create one without gravid individuals with censored data (head-out and body-out)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep_noeggs <span class="ot">&lt;-</span> summary_tracking_complete_no_rep[summary_tracking_complete_no_rep<span class="sc">$</span>N_eggs <span class="sc">==</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="snake-position-extraction" class="level3">
<h3 class="anchored" data-anchor-id="snake-position-extraction">1.1. Snake position extraction</h3>
<p>Don’t run if <code>Snake_array</code> and <code>Arena_array</code> have been already loaded, as these functions take a lot of time to run.</p>
<p><code>Snake_array</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable names for each column</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"Central_area"</span>, <span class="st">"Intermediate_area"</span>, <span class="st">"Refuge_area_1"</span>, <span class="st">"Refuge_area_2"</span>, <span class="st">"Initial_refuge"</span>, <span class="st">"Distant_wall"</span>, <span class="st">"Lateral_1"</span>, <span class="st">"Lateral_2"</span>, <span class="st">"Arena_area"</span>, <span class="st">"Area"</span>, <span class="st">"dist_hole_0"</span>, <span class="st">"dist_hole_1"</span>, <span class="st">"dist_hole_2"</span>, <span class="st">"dist_hole_3"</span>, <span class="st">"dist_hole_4"</span>, <span class="st">"dist_min"</span>, <span class="st">"hole_dist_min"</span>, <span class="st">"dist_traveled"</span>, <span class="st">"behaviour"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We create empty data frame that is going to store: x axis = time step, y = variables, z = individuals</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Snake_array <span class="ot">&lt;-</span>  <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3600</span>, <span class="fu">length</span>(variable_names), <span class="fu">nrow</span>(Snake_data_tracked)))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We set the column names for the variables across the array</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(Snake_array)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> variable_names</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We set the ID code for all tracked snakes across the array</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(Snake_array)[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> Snake_data_tracked<span class="sc">$</span>Snake_ID</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For each tracked individual </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS TAKES A LOT OF TIME. DO NOT RUN AND LOAD DIRECTLY FROM WD</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Snake_data_tracked)){</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it is the first trial (no repeatability)...</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Repeatability[i] <span class="sc">==</span> <span class="st">"N"</span>){</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... set the working directory in the correct folder...</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking/Excels tracking"</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... and if it didn't get out of the original refuge, fill the correspondent data layer with 0. Otherwise...</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">==</span> <span class="st">"NA"</span>){</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We copy an already complete file</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      coordinates_complete <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[, , <span class="dv">1</span>])</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># And fill with 0</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Central_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Intermediate_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Refuge_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Refuge_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Initial_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Distant_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Lateral_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Lateral_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Arena_area <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Area <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_1 <span class="ot">&lt;-</span> <span class="fl">0.86</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_2 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_3 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_4 <span class="ot">&lt;-</span> <span class="fl">0.86</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_min <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>hole_dist_min <span class="ot">&lt;-</span> <span class="st">"dist_hole_0"</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_traveled <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>behaviour <span class="ot">&lt;-</span> <span class="st">"hidden"</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>      <span class="co"># It might happen that the snake is being recorded for more than 1h, and we want to know their behaviour in 1h-tests. It's for this reason that we are going to cut all videos to 1h (3600 sec). If the video lasts less than 1h, for the moment we are not going to do anything.</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_complete) <span class="sc">&gt;</span> <span class="dv">3600</span>){</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>        coordinates_complete <span class="ot">&lt;-</span> coordinates_complete[<span class="dv">1</span><span class="sc">:</span><span class="dv">3600</span>, ]</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>      Snake_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_complete), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coordinates_complete[ , ])</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Snake_array"</span>, Snake_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Snake_array"</span>, i)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ... extract data from its tracked Excel file.</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">!=</span> <span class="st">"NA"</span>){</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select data based on snake's ID</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>      data_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID[i], <span class="st">"_coordinates.xlsx"</span>)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Standardized name for data</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>      coordinates <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(data_name)</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select arena limits and refuges from specific individual</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>      name_arena <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID[i], <span class="st">"_arena.xlsx"</span>)</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(name_arena)</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How much time does the snake hide before first head-out</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>      sec_bf_head_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i])</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Let's find which seconds is the snake missing in the recording (hidden)</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>      missing_time <span class="ot">&lt;-</span> <span class="fu">min</span>(coordinates<span class="sc">$</span>t)<span class="sc">:</span><span class="fu">max</span>(coordinates<span class="sc">$</span>t)</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How many seconds does the snake stay inside the refuges after coming out the initial refuge</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>      missing_time_recorded <span class="ot">&lt;-</span> <span class="fu">length</span>(missing_time[<span class="sc">!</span>missing_time <span class="sc">%in%</span> coordinates<span class="sc">$</span>t])</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which seconds is the snake missing</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>      missing_time_sec <span class="ot">&lt;-</span> missing_time[<span class="sc">!</span>missing_time <span class="sc">%in%</span> coordinates<span class="sc">$</span>t]</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>      <span class="co"># See in which area is the snake at each time step</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>      <span class="co"># The snake, even if it is outside the arena, is still over a certain area, so we are going to widen the limits of the areas for detecting in which area is the snake even if it is outside the arena limits. It does not have an effect over the behaviour</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>      off_limit <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Central area</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>      Central_area <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>                                       coordinates<span class="sc">$</span>y, </span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.75</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.75</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.75</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.75</span>), </span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.5</span>))</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Central_area <span class="ot">&lt;-</span> Central_area</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Intermediate area</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>      Intermediate_area <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>                                            coordinates<span class="sc">$</span>y, </span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>), </span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>))</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Intermediate_area <span class="ot">&lt;-</span> Intermediate_area</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Intermediate_area <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>Intermediate_area <span class="sc">-</span> coordinates<span class="sc">$</span>Central_area</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Refuge area 1</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>      Refuge_area_1 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>                                        coordinates<span class="sc">$</span>y, </span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>),</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>))</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Refuge_area_1 <span class="ot">&lt;-</span> Refuge_area_1</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Refuge area 2</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>      Refuge_area_2 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>                                        coordinates<span class="sc">$</span>y, </span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>))</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Refuge_area_2 <span class="ot">&lt;-</span> Refuge_area_2</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Initial refuge area</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>      Initial_refuge <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>                                         coordinates<span class="sc">$</span>y, </span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span><span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit))</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Initial_refuge <span class="ot">&lt;-</span> Initial_refuge</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Distant wall area</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>      Distant_wall <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>                                       coordinates<span class="sc">$</span>y, </span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>))</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Distant_wall <span class="ot">&lt;-</span> Distant_wall</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Lateral refuge area 1</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>      Lateral_1 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>                                    coordinates<span class="sc">$</span>y, </span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>),</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit))</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Lateral_1 <span class="ot">&lt;-</span> Lateral_1</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Lateral refuge area 2</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>      Lateral_2 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>                                    coordinates<span class="sc">$</span>y, </span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit))</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Lateral_2 <span class="ot">&lt;-</span> Lateral_2</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Arena area. We are going to expand the arena limits 2cm on each side, in order to take into account edge exploration as inside the arena, not ouside</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>      Arena_area <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>                                     coordinates<span class="sc">$</span>y, </span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.02</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.02</span>),</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.02</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.02</span>))</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Arena_area <span class="ot">&lt;-</span> Arena_area</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Column that indicates the area the snake is at every time step</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(coordinates<span class="sc">$</span>Arena_area[j] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> coordinates<span class="sc">$</span>Arena_area[j] <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates<span class="sc">$</span>Lateral_2[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Lateral 2"</span></span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Lateral_1[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Lateral 1"</span></span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Distant_wall[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Distant wall"</span></span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Refuge_area_1[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Refuge area 1"</span></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Refuge_area_2[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Refuge area 2"</span></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Initial_refuge[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Intermediate_area[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Intermediate area"</span></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Central_area[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Central area"</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span>  {</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>              <span class="co"># Initial frame</span></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>              coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>              <span class="co"># If any of the conditions are met, repeat previous area</span></span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>              coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>Area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Distance to each hole</span></span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Entrance hole (hole_0)</span></span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>      hole_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">5</span>, <span class="dv">2</span>], arena[<span class="dv">5</span>, <span class="dv">3</span>])</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_0[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_0[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_0[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 1</span></span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>      hole_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">6</span>, <span class="dv">2</span>], arena[<span class="dv">6</span>, <span class="dv">3</span>])</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_1[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_1[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_1[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 2</span></span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a>      hole_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">7</span>, <span class="dv">2</span>], arena[<span class="dv">7</span>, <span class="dv">3</span>])</span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_2[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_2[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_2[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 3</span></span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>      hole_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">8</span>, <span class="dv">2</span>], arena[<span class="dv">8</span>, <span class="dv">3</span>])</span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_3[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_3[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_3[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 4</span></span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a>      hole_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">9</span>, <span class="dv">2</span>], arena[<span class="dv">9</span>, <span class="dv">3</span>])</span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_4[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_4[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_4[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which is the hole the snake is closest to at each moment</span></span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a>        a <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_0[k]</span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a>        b <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_1[k]</span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a>        c <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_2[k]</span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a>        d <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_3[k]</span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>        e <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_4[k]</span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Write the distance to the closest hole</span></span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_min[k] <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(a, b, c, d, e))</span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>        <span class="co"># And the name of that hole</span></span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>hole_dist_min[k] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(coordinates[<span class="fu">which</span>((coordinates[k, ] <span class="sc">==</span> coordinates<span class="sc">$</span>dist_min[k]) <span class="sc">==</span> <span class="cn">TRUE</span>)])[<span class="dv">1</span>]</span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which distance has the snake traveled from 1 sec to the next one</span></span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>      dist_traveled <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(coordinates)))</span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a>        dist_traveled[k, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> coordinates<span class="sc">$</span>x[k <span class="sc">-</span> <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> coordinates<span class="sc">$</span>y[k <span class="sc">-</span> <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>      dist_traveled[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>dist_traveled <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dist_traveled[, <span class="dv">1</span>])</span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which behaviour is the snake exhibiting?</span></span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(coordinates<span class="sc">$</span>Arena_area[k] <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates<span class="sc">$</span>dist_traveled[k] <span class="sc">&lt;</span> <span class="fl">0.01</span>){</span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"hiding / head-out"</span></span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-328"><a href="#cb4-328" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb4-329"><a href="#cb4-329" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-330"><a href="#cb4-330" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"exploring wall"</span></span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates<span class="sc">$</span>dist_traveled[k] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>dist_min[k] <span class="sc">&lt;</span> <span class="fl">0.1</span>){</span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"head-out"</span></span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>dist_traveled[k] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>dist_min[k] <span class="sc">&gt;</span> <span class="fl">0.1</span>){</span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"immobile exposed"</span></span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"moving"</span></span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We put the correct time steps to each frame</span></span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>t <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>t <span class="sc">+</span> <span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We create a data set that is going to keep all the information to what happens during the whole video</span></span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How long is the total video (nº sec recorded + nº sec snake is hidden bf exiting for the first time + nº seconds hidden during recording)</span></span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>      total_frames <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="fu">nrow</span>(coordinates) <span class="sc">+</span> missing_time_recorded</span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Column names</span></span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a>      col_names_coordinates <span class="ot">&lt;-</span> <span class="fu">colnames</span>(coordinates)</span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We create the data frame</span></span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>      coordinates_complete <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="fu">ncol</span>(coordinates), <span class="at">nrow =</span> total_frames))</span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true" tabindex="-1"></a>      <span class="co"># And put the column names</span></span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(coordinates_complete) <span class="ot">&lt;-</span> col_names_coordinates</span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Seconds that the whole recordind lasts</span></span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>total_frames)</span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Now, we assign each recorded parameter to its correspondent second on the 1h record</span></span>
<span id="cb4-376"><a href="#cb4-376" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-377"><a href="#cb4-377" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-378"><a href="#cb4-378" aria-hidden="true" tabindex="-1"></a>        values_coordinates <span class="ot">&lt;-</span> coordinates[k, ]</span>
<span id="cb4-379"><a href="#cb4-379" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-380"><a href="#cb4-380" aria-hidden="true" tabindex="-1"></a>        coordinates_complete[<span class="fu">as.numeric</span>(values_coordinates[<span class="dv">1</span>]), ] <span class="ot">&lt;-</span> values_coordinates</span>
<span id="cb4-381"><a href="#cb4-381" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-382"><a href="#cb4-382" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-383"><a href="#cb4-383" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-384"><a href="#cb4-384" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-385"><a href="#cb4-385" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-386"><a href="#cb4-386" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Values for when the snake is still inside the initial refuge</span></span>
<span id="cb4-387"><a href="#cb4-387" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_complete)){</span>
<span id="cb4-388"><a href="#cb4-388" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-389"><a href="#cb4-389" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If the snake hasn't exited the initial refuge</span></span>
<span id="cb4-390"><a href="#cb4-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(j <span class="sc">&lt;=</span> <span class="fu">as.numeric</span>(sec_bf_head_out)){</span>
<span id="cb4-391"><a href="#cb4-391" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-392"><a href="#cb4-392" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>x[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-393"><a href="#cb4-393" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>y[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-394"><a href="#cb4-394" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Central_area[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-395"><a href="#cb4-395" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Intermediate_area[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-396"><a href="#cb4-396" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Refuge_area_1[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-397"><a href="#cb4-397" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Refuge_area_2[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-398"><a href="#cb4-398" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Initial_refuge[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-399"><a href="#cb4-399" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Distant_wall[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-400"><a href="#cb4-400" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Lateral_1[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-401"><a href="#cb4-401" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Lateral_2[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-402"><a href="#cb4-402" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Arena_area[j] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb4-403"><a href="#cb4-403" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-404"><a href="#cb4-404" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_0[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-405"><a href="#cb4-405" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_1[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-406"><a href="#cb4-406" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_2[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-407"><a href="#cb4-407" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_3[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_3[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-408"><a href="#cb4-408" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_4[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_4[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-409"><a href="#cb4-409" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_min[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-410"><a href="#cb4-410" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>hole_dist_min[j] <span class="ot">&lt;-</span> <span class="st">"dist_hole_0"</span></span>
<span id="cb4-411"><a href="#cb4-411" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_traveled[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-412"><a href="#cb4-412" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>behaviour[j] <span class="ot">&lt;-</span> <span class="st">"hidden"</span></span>
<span id="cb4-413"><a href="#cb4-413" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-414"><a href="#cb4-414" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-415"><a href="#cb4-415" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-416"><a href="#cb4-416" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-417"><a href="#cb4-417" aria-hidden="true" tabindex="-1"></a>          <span class="co"># If the snake is missing (hidden), which parameters are going to exhibit those frames. We are going to copy the parameters from the last recorded frame, except specific parameters.</span></span>
<span id="cb4-418"><a href="#cb4-418" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">is.na</span>(coordinates_complete<span class="sc">$</span>x[j]) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb4-419"><a href="#cb4-419" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-420"><a href="#cb4-420" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>x[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>x[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-421"><a href="#cb4-421" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>y[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>y[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-422"><a href="#cb4-422" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Central_area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Central_area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-423"><a href="#cb4-423" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Intermediate_area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Intermediate_area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-424"><a href="#cb4-424" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Refuge_area_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Refuge_area_1[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-425"><a href="#cb4-425" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Refuge_area_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Refuge_area_2[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-426"><a href="#cb4-426" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Initial_refuge[j] <span class="ot">&lt;-</span>  coordinates_complete<span class="sc">$</span>Initial_refuge[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-427"><a href="#cb4-427" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Distant_wall[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Distant_wall[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-428"><a href="#cb4-428" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Lateral_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Lateral_1[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-429"><a href="#cb4-429" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Lateral_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Lateral_2[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-430"><a href="#cb4-430" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Arena_area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Arena_area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-431"><a href="#cb4-431" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-432"><a href="#cb4-432" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_0[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_0[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-433"><a href="#cb4-433" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_1[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-434"><a href="#cb4-434" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_2[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-435"><a href="#cb4-435" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_3[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_3[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-436"><a href="#cb4-436" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_4[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_4[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-437"><a href="#cb4-437" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_min[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-438"><a href="#cb4-438" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>hole_dist_min[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>hole_dist_min[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-439"><a href="#cb4-439" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_traveled[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-440"><a href="#cb4-440" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>behaviour[j] <span class="ot">&lt;-</span> <span class="st">"hidden"</span></span>
<span id="cb4-441"><a href="#cb4-441" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-442"><a href="#cb4-442" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-443"><a href="#cb4-443" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-444"><a href="#cb4-444" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-445"><a href="#cb4-445" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-446"><a href="#cb4-446" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-447"><a href="#cb4-447" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-448"><a href="#cb4-448" aria-hidden="true" tabindex="-1"></a>      <span class="co"># It might happen that the snake is being recorded for more than 1h, and we want to know their behaviour in 1h-tests. It's for this reason that we are going to cut all videos to 1h (3600 sec). If the video lasts less than 1h, for the moment we are not going to do anything.</span></span>
<span id="cb4-449"><a href="#cb4-449" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_complete) <span class="sc">&gt;</span> <span class="dv">3600</span>){</span>
<span id="cb4-450"><a href="#cb4-450" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-451"><a href="#cb4-451" aria-hidden="true" tabindex="-1"></a>        coordinates_complete <span class="ot">&lt;-</span> coordinates_complete[<span class="dv">1</span><span class="sc">:</span><span class="dv">3600</span>, ]</span>
<span id="cb4-452"><a href="#cb4-452" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-453"><a href="#cb4-453" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb4-454"><a href="#cb4-454" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-455"><a href="#cb4-455" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-456"><a href="#cb4-456" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-457"><a href="#cb4-457" aria-hidden="true" tabindex="-1"></a>      Snake_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_complete), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coordinates_complete[ , ])</span>
<span id="cb4-458"><a href="#cb4-458" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-459"><a href="#cb4-459" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Snake_array"</span>, Snake_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb4-460"><a href="#cb4-460" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-461"><a href="#cb4-461" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Snake_array"</span>, i)</span>
<span id="cb4-462"><a href="#cb4-462" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-463"><a href="#cb4-463" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-464"><a href="#cb4-464" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-465"><a href="#cb4-465" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If it is a snake used for repeatability, ...</span></span>
<span id="cb4-466"><a href="#cb4-466" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Repeatability[i] <span class="sc">==</span> <span class="st">"Y"</span>){</span>
<span id="cb4-467"><a href="#cb4-467" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-468"><a href="#cb4-468" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... set the correct wd ...</span></span>
<span id="cb4-469"><a href="#cb4-469" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking/Excels tracking/Replicates"</span>)</span>
<span id="cb4-470"><a href="#cb4-470" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-471"><a href="#cb4-471" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... and check if the snake did get out of the initial refuge or not. If it didn't, fill with 0.</span></span>
<span id="cb4-472"><a href="#cb4-472" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">==</span> <span class="st">"NA"</span>){</span>
<span id="cb4-473"><a href="#cb4-473" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-474"><a href="#cb4-474" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-475"><a href="#cb4-475" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We copy an already complete file</span></span>
<span id="cb4-476"><a href="#cb4-476" aria-hidden="true" tabindex="-1"></a>      coordinates_complete <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[, , <span class="dv">1</span>])</span>
<span id="cb4-477"><a href="#cb4-477" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-478"><a href="#cb4-478" aria-hidden="true" tabindex="-1"></a>      <span class="co"># And fill with 0</span></span>
<span id="cb4-479"><a href="#cb4-479" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-480"><a href="#cb4-480" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-481"><a href="#cb4-481" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Central_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-482"><a href="#cb4-482" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Intermediate_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-483"><a href="#cb4-483" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Refuge_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-484"><a href="#cb4-484" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Refuge_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-485"><a href="#cb4-485" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Initial_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-486"><a href="#cb4-486" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Distant_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-487"><a href="#cb4-487" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Lateral_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-488"><a href="#cb4-488" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Lateral_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-489"><a href="#cb4-489" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Arena_area <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb4-490"><a href="#cb4-490" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>Area <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-491"><a href="#cb4-491" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-492"><a href="#cb4-492" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_1 <span class="ot">&lt;-</span> <span class="fl">0.86</span></span>
<span id="cb4-493"><a href="#cb4-493" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_2 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb4-494"><a href="#cb4-494" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_3 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb4-495"><a href="#cb4-495" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_hole_4 <span class="ot">&lt;-</span> <span class="fl">0.86</span></span>
<span id="cb4-496"><a href="#cb4-496" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_min <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-497"><a href="#cb4-497" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>hole_dist_min <span class="ot">&lt;-</span> <span class="st">"dist_hole_0"</span></span>
<span id="cb4-498"><a href="#cb4-498" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>dist_traveled <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-499"><a href="#cb4-499" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>behaviour <span class="ot">&lt;-</span> <span class="st">"hidden"</span></span>
<span id="cb4-500"><a href="#cb4-500" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-501"><a href="#cb4-501" aria-hidden="true" tabindex="-1"></a>      <span class="co"># It might happen that the snake is being recorded for more than 1h, and we want to know their behaviour in 1h-tests. It's for this reason that we are going to cut all videos to 1h (3600 sec). If the video lasts less than 1h, for the moment we are not going to do anything.</span></span>
<span id="cb4-502"><a href="#cb4-502" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_complete) <span class="sc">&gt;</span> <span class="dv">3600</span>){</span>
<span id="cb4-503"><a href="#cb4-503" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-504"><a href="#cb4-504" aria-hidden="true" tabindex="-1"></a>        coordinates_complete <span class="ot">&lt;-</span> coordinates_complete[<span class="dv">1</span><span class="sc">:</span><span class="dv">3600</span>, ]</span>
<span id="cb4-505"><a href="#cb4-505" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-506"><a href="#cb4-506" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb4-507"><a href="#cb4-507" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-508"><a href="#cb4-508" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-509"><a href="#cb4-509" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-510"><a href="#cb4-510" aria-hidden="true" tabindex="-1"></a>      Snake_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_complete), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coordinates_complete[ , ])</span>
<span id="cb4-511"><a href="#cb4-511" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-512"><a href="#cb4-512" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Snake_array"</span>, Snake_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb4-513"><a href="#cb4-513" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-514"><a href="#cb4-514" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Snake_array"</span>, i)</span>
<span id="cb4-515"><a href="#cb4-515" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-516"><a href="#cb4-516" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-517"><a href="#cb4-517" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-518"><a href="#cb4-518" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If the snake did get out of the refuge, extract data from excel</span></span>
<span id="cb4-519"><a href="#cb4-519" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">!=</span> <span class="st">"NA"</span>){</span>
<span id="cb4-520"><a href="#cb4-520" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-521"><a href="#cb4-521" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select data based on snake's ID</span></span>
<span id="cb4-522"><a href="#cb4-522" aria-hidden="true" tabindex="-1"></a>      data_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID[i], <span class="st">"_coordinates.xlsx"</span>)</span>
<span id="cb4-523"><a href="#cb4-523" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-524"><a href="#cb4-524" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Standardized name for data</span></span>
<span id="cb4-525"><a href="#cb4-525" aria-hidden="true" tabindex="-1"></a>      coordinates <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(data_name)</span>
<span id="cb4-526"><a href="#cb4-526" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-527"><a href="#cb4-527" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select arena limits and refuges from specific individual</span></span>
<span id="cb4-528"><a href="#cb4-528" aria-hidden="true" tabindex="-1"></a>      name_arena <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID[i], <span class="st">"_arena.xlsx"</span>)</span>
<span id="cb4-529"><a href="#cb4-529" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-530"><a href="#cb4-530" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(name_arena)</span>
<span id="cb4-531"><a href="#cb4-531" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-532"><a href="#cb4-532" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How much time does the snake hide before first head-out</span></span>
<span id="cb4-533"><a href="#cb4-533" aria-hidden="true" tabindex="-1"></a>      sec_bf_head_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i])</span>
<span id="cb4-534"><a href="#cb4-534" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-535"><a href="#cb4-535" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Let's find which seconds is the snake missing in the recording (hidden)</span></span>
<span id="cb4-536"><a href="#cb4-536" aria-hidden="true" tabindex="-1"></a>      missing_time <span class="ot">&lt;-</span> <span class="fu">min</span>(coordinates<span class="sc">$</span>t)<span class="sc">:</span><span class="fu">max</span>(coordinates<span class="sc">$</span>t)</span>
<span id="cb4-537"><a href="#cb4-537" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-538"><a href="#cb4-538" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How many seconds does the snake stay inside the refuges after coming out the initial refuge</span></span>
<span id="cb4-539"><a href="#cb4-539" aria-hidden="true" tabindex="-1"></a>      missing_time_recorded <span class="ot">&lt;-</span> <span class="fu">length</span>(missing_time[<span class="sc">!</span>missing_time <span class="sc">%in%</span> coordinates<span class="sc">$</span>t])</span>
<span id="cb4-540"><a href="#cb4-540" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-541"><a href="#cb4-541" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which seconds is the snake missing</span></span>
<span id="cb4-542"><a href="#cb4-542" aria-hidden="true" tabindex="-1"></a>      missing_time_sec <span class="ot">&lt;-</span> missing_time[<span class="sc">!</span>missing_time <span class="sc">%in%</span> coordinates<span class="sc">$</span>t]</span>
<span id="cb4-543"><a href="#cb4-543" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-544"><a href="#cb4-544" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-545"><a href="#cb4-545" aria-hidden="true" tabindex="-1"></a>      <span class="co"># See in which area is the snake at each time step</span></span>
<span id="cb4-546"><a href="#cb4-546" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-547"><a href="#cb4-547" aria-hidden="true" tabindex="-1"></a>      <span class="co"># The snake, even if it is outside the arena, is still over a certain area, so we are going to widen the limits of the areas for detecting in which area is the snake even if it is outside the arena limits. It does not have an effect over the behaviour</span></span>
<span id="cb4-548"><a href="#cb4-548" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-549"><a href="#cb4-549" aria-hidden="true" tabindex="-1"></a>      off_limit <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb4-550"><a href="#cb4-550" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-551"><a href="#cb4-551" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Central area</span></span>
<span id="cb4-552"><a href="#cb4-552" aria-hidden="true" tabindex="-1"></a>      Central_area <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-553"><a href="#cb4-553" aria-hidden="true" tabindex="-1"></a>                                       coordinates<span class="sc">$</span>y, </span>
<span id="cb4-554"><a href="#cb4-554" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.75</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.75</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.75</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.75</span>), </span>
<span id="cb4-555"><a href="#cb4-555" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.5</span>))</span>
<span id="cb4-556"><a href="#cb4-556" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-557"><a href="#cb4-557" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Central_area <span class="ot">&lt;-</span> Central_area</span>
<span id="cb4-558"><a href="#cb4-558" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-559"><a href="#cb4-559" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Intermediate area</span></span>
<span id="cb4-560"><a href="#cb4-560" aria-hidden="true" tabindex="-1"></a>      Intermediate_area <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-561"><a href="#cb4-561" aria-hidden="true" tabindex="-1"></a>                                            coordinates<span class="sc">$</span>y, </span>
<span id="cb4-562"><a href="#cb4-562" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>), </span>
<span id="cb4-563"><a href="#cb4-563" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>))</span>
<span id="cb4-564"><a href="#cb4-564" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-565"><a href="#cb4-565" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Intermediate_area <span class="ot">&lt;-</span> Intermediate_area</span>
<span id="cb4-566"><a href="#cb4-566" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-567"><a href="#cb4-567" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Intermediate_area <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>Intermediate_area <span class="sc">-</span> coordinates<span class="sc">$</span>Central_area</span>
<span id="cb4-568"><a href="#cb4-568" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-569"><a href="#cb4-569" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Refuge area 1</span></span>
<span id="cb4-570"><a href="#cb4-570" aria-hidden="true" tabindex="-1"></a>      Refuge_area_1 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-571"><a href="#cb4-571" aria-hidden="true" tabindex="-1"></a>                                        coordinates<span class="sc">$</span>y, </span>
<span id="cb4-572"><a href="#cb4-572" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>),</span>
<span id="cb4-573"><a href="#cb4-573" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>))</span>
<span id="cb4-574"><a href="#cb4-574" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-575"><a href="#cb4-575" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Refuge_area_1 <span class="ot">&lt;-</span> Refuge_area_1</span>
<span id="cb4-576"><a href="#cb4-576" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-577"><a href="#cb4-577" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Refuge area 2</span></span>
<span id="cb4-578"><a href="#cb4-578" aria-hidden="true" tabindex="-1"></a>      Refuge_area_2 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-579"><a href="#cb4-579" aria-hidden="true" tabindex="-1"></a>                                        coordinates<span class="sc">$</span>y, </span>
<span id="cb4-580"><a href="#cb4-580" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-581"><a href="#cb4-581" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>))</span>
<span id="cb4-582"><a href="#cb4-582" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-583"><a href="#cb4-583" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Refuge_area_2 <span class="ot">&lt;-</span> Refuge_area_2</span>
<span id="cb4-584"><a href="#cb4-584" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-585"><a href="#cb4-585" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-586"><a href="#cb4-586" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Initial refuge area</span></span>
<span id="cb4-587"><a href="#cb4-587" aria-hidden="true" tabindex="-1"></a>      Initial_refuge <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-588"><a href="#cb4-588" aria-hidden="true" tabindex="-1"></a>                                         coordinates<span class="sc">$</span>y, </span>
<span id="cb4-589"><a href="#cb4-589" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span><span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-590"><a href="#cb4-590" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit))</span>
<span id="cb4-591"><a href="#cb4-591" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-592"><a href="#cb4-592" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Initial_refuge <span class="ot">&lt;-</span> Initial_refuge</span>
<span id="cb4-593"><a href="#cb4-593" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-594"><a href="#cb4-594" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-595"><a href="#cb4-595" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Distant wall area</span></span>
<span id="cb4-596"><a href="#cb4-596" aria-hidden="true" tabindex="-1"></a>      Distant_wall <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-597"><a href="#cb4-597" aria-hidden="true" tabindex="-1"></a>                                       coordinates<span class="sc">$</span>y, </span>
<span id="cb4-598"><a href="#cb4-598" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-599"><a href="#cb4-599" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">c</span>(arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>))</span>
<span id="cb4-600"><a href="#cb4-600" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-601"><a href="#cb4-601" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Distant_wall <span class="ot">&lt;-</span> Distant_wall</span>
<span id="cb4-602"><a href="#cb4-602" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-603"><a href="#cb4-603" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-604"><a href="#cb4-604" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Lateral refuge area 1</span></span>
<span id="cb4-605"><a href="#cb4-605" aria-hidden="true" tabindex="-1"></a>      Lateral_1 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-606"><a href="#cb4-606" aria-hidden="true" tabindex="-1"></a>                                    coordinates<span class="sc">$</span>y, </span>
<span id="cb4-607"><a href="#cb4-607" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>),</span>
<span id="cb4-608"><a href="#cb4-608" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit))</span>
<span id="cb4-609"><a href="#cb4-609" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-610"><a href="#cb4-610" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Lateral_1 <span class="ot">&lt;-</span> Lateral_1</span>
<span id="cb4-611"><a href="#cb4-611" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-612"><a href="#cb4-612" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Lateral refuge area 2</span></span>
<span id="cb4-613"><a href="#cb4-613" aria-hidden="true" tabindex="-1"></a>      Lateral_2 <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-614"><a href="#cb4-614" aria-hidden="true" tabindex="-1"></a>                                    coordinates<span class="sc">$</span>y, </span>
<span id="cb4-615"><a href="#cb4-615" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb4-616"><a href="#cb4-616" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> off_limit, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> off_limit))</span>
<span id="cb4-617"><a href="#cb4-617" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-618"><a href="#cb4-618" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Lateral_2 <span class="ot">&lt;-</span> Lateral_2</span>
<span id="cb4-619"><a href="#cb4-619" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-620"><a href="#cb4-620" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-621"><a href="#cb4-621" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Arena area. We are going to expand the arena limits 2cm on each side, in order to take into account edge exploration as inside the arena, not ouside</span></span>
<span id="cb4-622"><a href="#cb4-622" aria-hidden="true" tabindex="-1"></a>      Arena_area <span class="ot">&lt;-</span> <span class="fu">point.in.polygon</span>(coordinates<span class="sc">$</span>x, </span>
<span id="cb4-623"><a href="#cb4-623" aria-hidden="true" tabindex="-1"></a>                                     coordinates<span class="sc">$</span>y, </span>
<span id="cb4-624"><a href="#cb4-624" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.02</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.02</span>),</span>
<span id="cb4-625"><a href="#cb4-625" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.02</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.02</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.02</span>))</span>
<span id="cb4-626"><a href="#cb4-626" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-627"><a href="#cb4-627" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>Arena_area <span class="ot">&lt;-</span> Arena_area</span>
<span id="cb4-628"><a href="#cb4-628" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-629"><a href="#cb4-629" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Column that indicates the area the snake is at every time step</span></span>
<span id="cb4-630"><a href="#cb4-630" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-631"><a href="#cb4-631" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-632"><a href="#cb4-632" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(coordinates<span class="sc">$</span>Arena_area[j] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> coordinates<span class="sc">$</span>Arena_area[j] <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb4-633"><a href="#cb4-633" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-634"><a href="#cb4-634" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates<span class="sc">$</span>Lateral_2[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-635"><a href="#cb4-635" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-636"><a href="#cb4-636" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Lateral 2"</span></span>
<span id="cb4-637"><a href="#cb4-637" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-638"><a href="#cb4-638" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Lateral_1[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-639"><a href="#cb4-639" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-640"><a href="#cb4-640" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Lateral 1"</span></span>
<span id="cb4-641"><a href="#cb4-641" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-642"><a href="#cb4-642" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Distant_wall[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-643"><a href="#cb4-643" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-644"><a href="#cb4-644" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Distant wall"</span></span>
<span id="cb4-645"><a href="#cb4-645" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-646"><a href="#cb4-646" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Refuge_area_1[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-647"><a href="#cb4-647" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-648"><a href="#cb4-648" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Refuge area 1"</span></span>
<span id="cb4-649"><a href="#cb4-649" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-650"><a href="#cb4-650" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Refuge_area_2[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-651"><a href="#cb4-651" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-652"><a href="#cb4-652" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Refuge area 2"</span></span>
<span id="cb4-653"><a href="#cb4-653" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-654"><a href="#cb4-654" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Initial_refuge[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-655"><a href="#cb4-655" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-656"><a href="#cb4-656" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-657"><a href="#cb4-657" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-658"><a href="#cb4-658" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Intermediate_area[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-659"><a href="#cb4-659" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-660"><a href="#cb4-660" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Intermediate area"</span></span>
<span id="cb4-661"><a href="#cb4-661" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-662"><a href="#cb4-662" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>Central_area[j] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-663"><a href="#cb4-663" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-664"><a href="#cb4-664" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Central area"</span></span>
<span id="cb4-665"><a href="#cb4-665" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-666"><a href="#cb4-666" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span>  {</span>
<span id="cb4-667"><a href="#cb4-667" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-668"><a href="#cb4-668" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-669"><a href="#cb4-669" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-670"><a href="#cb4-670" aria-hidden="true" tabindex="-1"></a>              <span class="co"># Initial frame</span></span>
<span id="cb4-671"><a href="#cb4-671" aria-hidden="true" tabindex="-1"></a>              coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-672"><a href="#cb4-672" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-673"><a href="#cb4-673" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb4-674"><a href="#cb4-674" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-675"><a href="#cb4-675" aria-hidden="true" tabindex="-1"></a>              <span class="co"># If any of the conditions are met, repeat previous area</span></span>
<span id="cb4-676"><a href="#cb4-676" aria-hidden="true" tabindex="-1"></a>              coordinates<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>Area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-677"><a href="#cb4-677" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-678"><a href="#cb4-678" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-679"><a href="#cb4-679" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-680"><a href="#cb4-680" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-681"><a href="#cb4-681" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-682"><a href="#cb4-682" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-683"><a href="#cb4-683" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-684"><a href="#cb4-684" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-685"><a href="#cb4-685" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-686"><a href="#cb4-686" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-687"><a href="#cb4-687" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-688"><a href="#cb4-688" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Distance to each hole</span></span>
<span id="cb4-689"><a href="#cb4-689" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-690"><a href="#cb4-690" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Entrance hole (hole_0)</span></span>
<span id="cb4-691"><a href="#cb4-691" aria-hidden="true" tabindex="-1"></a>      hole_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">5</span>, <span class="dv">2</span>], arena[<span class="dv">5</span>, <span class="dv">3</span>])</span>
<span id="cb4-692"><a href="#cb4-692" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-693"><a href="#cb4-693" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-694"><a href="#cb4-694" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-695"><a href="#cb4-695" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_0[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_0[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_0[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-696"><a href="#cb4-696" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-697"><a href="#cb4-697" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-698"><a href="#cb4-698" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-699"><a href="#cb4-699" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 1</span></span>
<span id="cb4-700"><a href="#cb4-700" aria-hidden="true" tabindex="-1"></a>      hole_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">6</span>, <span class="dv">2</span>], arena[<span class="dv">6</span>, <span class="dv">3</span>])</span>
<span id="cb4-701"><a href="#cb4-701" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-702"><a href="#cb4-702" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-703"><a href="#cb4-703" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-704"><a href="#cb4-704" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_1[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_1[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_1[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-705"><a href="#cb4-705" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-706"><a href="#cb4-706" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-707"><a href="#cb4-707" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-708"><a href="#cb4-708" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 2</span></span>
<span id="cb4-709"><a href="#cb4-709" aria-hidden="true" tabindex="-1"></a>      hole_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">7</span>, <span class="dv">2</span>], arena[<span class="dv">7</span>, <span class="dv">3</span>])</span>
<span id="cb4-710"><a href="#cb4-710" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-711"><a href="#cb4-711" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-712"><a href="#cb4-712" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-713"><a href="#cb4-713" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_2[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_2[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_2[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-714"><a href="#cb4-714" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-715"><a href="#cb4-715" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-716"><a href="#cb4-716" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-717"><a href="#cb4-717" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 3</span></span>
<span id="cb4-718"><a href="#cb4-718" aria-hidden="true" tabindex="-1"></a>      hole_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">8</span>, <span class="dv">2</span>], arena[<span class="dv">8</span>, <span class="dv">3</span>])</span>
<span id="cb4-719"><a href="#cb4-719" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-720"><a href="#cb4-720" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-721"><a href="#cb4-721" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-722"><a href="#cb4-722" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_3[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_3[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_3[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-723"><a href="#cb4-723" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-724"><a href="#cb4-724" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-725"><a href="#cb4-725" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-726"><a href="#cb4-726" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hole 4</span></span>
<span id="cb4-727"><a href="#cb4-727" aria-hidden="true" tabindex="-1"></a>      hole_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(arena[<span class="dv">9</span>, <span class="dv">2</span>], arena[<span class="dv">9</span>, <span class="dv">3</span>])</span>
<span id="cb4-728"><a href="#cb4-728" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-729"><a href="#cb4-729" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-730"><a href="#cb4-730" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-731"><a href="#cb4-731" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_hole_4[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_4[<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> <span class="fu">as.numeric</span>(hole_4[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-732"><a href="#cb4-732" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-733"><a href="#cb4-733" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-734"><a href="#cb4-734" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-735"><a href="#cb4-735" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-736"><a href="#cb4-736" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which is the hole the snake is closest to at each moment</span></span>
<span id="cb4-737"><a href="#cb4-737" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-738"><a href="#cb4-738" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-739"><a href="#cb4-739" aria-hidden="true" tabindex="-1"></a>        a <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_0[k]</span>
<span id="cb4-740"><a href="#cb4-740" aria-hidden="true" tabindex="-1"></a>        b <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_1[k]</span>
<span id="cb4-741"><a href="#cb4-741" aria-hidden="true" tabindex="-1"></a>        c <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_2[k]</span>
<span id="cb4-742"><a href="#cb4-742" aria-hidden="true" tabindex="-1"></a>        d <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_3[k]</span>
<span id="cb4-743"><a href="#cb4-743" aria-hidden="true" tabindex="-1"></a>        e <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>dist_hole_4[k]</span>
<span id="cb4-744"><a href="#cb4-744" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-745"><a href="#cb4-745" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Write the distance to the closest hole</span></span>
<span id="cb4-746"><a href="#cb4-746" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>dist_min[k] <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(a, b, c, d, e))</span>
<span id="cb4-747"><a href="#cb4-747" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-748"><a href="#cb4-748" aria-hidden="true" tabindex="-1"></a>        <span class="co"># And the name of that hole</span></span>
<span id="cb4-749"><a href="#cb4-749" aria-hidden="true" tabindex="-1"></a>        coordinates<span class="sc">$</span>hole_dist_min[k] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(coordinates[<span class="fu">which</span>((coordinates[k, ] <span class="sc">==</span> coordinates<span class="sc">$</span>dist_min[k]) <span class="sc">==</span> <span class="cn">TRUE</span>)])[<span class="dv">1</span>]</span>
<span id="cb4-750"><a href="#cb4-750" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-751"><a href="#cb4-751" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-752"><a href="#cb4-752" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-753"><a href="#cb4-753" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-754"><a href="#cb4-754" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which distance has the snake traveled from 1 sec to the next one</span></span>
<span id="cb4-755"><a href="#cb4-755" aria-hidden="true" tabindex="-1"></a>      dist_traveled <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(coordinates)))</span>
<span id="cb4-756"><a href="#cb4-756" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-757"><a href="#cb4-757" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-758"><a href="#cb4-758" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-759"><a href="#cb4-759" aria-hidden="true" tabindex="-1"></a>        dist_traveled[k, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((coordinates<span class="sc">$</span>x[k] <span class="sc">-</span> coordinates<span class="sc">$</span>x[k <span class="sc">-</span> <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (coordinates<span class="sc">$</span>y[k] <span class="sc">-</span> coordinates<span class="sc">$</span>y[k <span class="sc">-</span> <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-760"><a href="#cb4-760" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-761"><a href="#cb4-761" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-762"><a href="#cb4-762" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-763"><a href="#cb4-763" aria-hidden="true" tabindex="-1"></a>      dist_traveled[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-764"><a href="#cb4-764" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-765"><a href="#cb4-765" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>dist_traveled <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dist_traveled[, <span class="dv">1</span>])</span>
<span id="cb4-766"><a href="#cb4-766" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-767"><a href="#cb4-767" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-768"><a href="#cb4-768" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Which behaviour is the snake exhibiting?</span></span>
<span id="cb4-769"><a href="#cb4-769" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-770"><a href="#cb4-770" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-771"><a href="#cb4-771" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(coordinates<span class="sc">$</span>Arena_area[k] <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb4-772"><a href="#cb4-772" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-773"><a href="#cb4-773" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates<span class="sc">$</span>dist_traveled[k] <span class="sc">&lt;</span> <span class="fl">0.01</span>){</span>
<span id="cb4-774"><a href="#cb4-774" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-775"><a href="#cb4-775" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"hiding / head-out"</span></span>
<span id="cb4-776"><a href="#cb4-776" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-777"><a href="#cb4-777" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb4-778"><a href="#cb4-778" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-779"><a href="#cb4-779" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"exploring wall"</span></span>
<span id="cb4-780"><a href="#cb4-780" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-781"><a href="#cb4-781" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-782"><a href="#cb4-782" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-783"><a href="#cb4-783" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-784"><a href="#cb4-784" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-785"><a href="#cb4-785" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates<span class="sc">$</span>dist_traveled[k] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>dist_min[k] <span class="sc">&lt;</span> <span class="fl">0.1</span>){</span>
<span id="cb4-786"><a href="#cb4-786" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-787"><a href="#cb4-787" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"head-out"</span></span>
<span id="cb4-788"><a href="#cb4-788" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-789"><a href="#cb4-789" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>dist_traveled[k] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>dist_min[k] <span class="sc">&gt;</span> <span class="fl">0.1</span>){</span>
<span id="cb4-790"><a href="#cb4-790" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-791"><a href="#cb4-791" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"immobile exposed"</span></span>
<span id="cb4-792"><a href="#cb4-792" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-793"><a href="#cb4-793" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb4-794"><a href="#cb4-794" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-795"><a href="#cb4-795" aria-hidden="true" tabindex="-1"></a>            coordinates<span class="sc">$</span>behaviour[k] <span class="ot">&lt;-</span> <span class="st">"moving"</span></span>
<span id="cb4-796"><a href="#cb4-796" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-797"><a href="#cb4-797" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-798"><a href="#cb4-798" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-799"><a href="#cb4-799" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-800"><a href="#cb4-800" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-801"><a href="#cb4-801" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-802"><a href="#cb4-802" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-803"><a href="#cb4-803" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-804"><a href="#cb4-804" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We put the correct time steps to each frame</span></span>
<span id="cb4-805"><a href="#cb4-805" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>t <span class="ot">&lt;-</span> coordinates<span class="sc">$</span>t <span class="sc">+</span> <span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-806"><a href="#cb4-806" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-807"><a href="#cb4-807" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We create a data set that is going to keep all the information to what happens during the whole video</span></span>
<span id="cb4-808"><a href="#cb4-808" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-809"><a href="#cb4-809" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How long is the total video (nº sec recorded + nº sec snake is hidden bf exiting for the first time + nº seconds hidden during recording)</span></span>
<span id="cb4-810"><a href="#cb4-810" aria-hidden="true" tabindex="-1"></a>      total_frames <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="fu">nrow</span>(coordinates) <span class="sc">+</span> missing_time_recorded</span>
<span id="cb4-811"><a href="#cb4-811" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-812"><a href="#cb4-812" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Column names</span></span>
<span id="cb4-813"><a href="#cb4-813" aria-hidden="true" tabindex="-1"></a>      col_names_coordinates <span class="ot">&lt;-</span> <span class="fu">colnames</span>(coordinates)</span>
<span id="cb4-814"><a href="#cb4-814" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-815"><a href="#cb4-815" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We create the data frame</span></span>
<span id="cb4-816"><a href="#cb4-816" aria-hidden="true" tabindex="-1"></a>      coordinates_complete <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="fu">ncol</span>(coordinates), <span class="at">nrow =</span> total_frames))</span>
<span id="cb4-817"><a href="#cb4-817" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-818"><a href="#cb4-818" aria-hidden="true" tabindex="-1"></a>      <span class="co"># And put the column names</span></span>
<span id="cb4-819"><a href="#cb4-819" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(coordinates_complete) <span class="ot">&lt;-</span> col_names_coordinates</span>
<span id="cb4-820"><a href="#cb4-820" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-821"><a href="#cb4-821" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Seconds that the whole recordind lasts</span></span>
<span id="cb4-822"><a href="#cb4-822" aria-hidden="true" tabindex="-1"></a>      coordinates_complete<span class="sc">$</span>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>total_frames)</span>
<span id="cb4-823"><a href="#cb4-823" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-824"><a href="#cb4-824" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Now, we assign each recorded parameter to its correspondent second on the 1h record</span></span>
<span id="cb4-825"><a href="#cb4-825" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb4-826"><a href="#cb4-826" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-827"><a href="#cb4-827" aria-hidden="true" tabindex="-1"></a>        values_coordinates <span class="ot">&lt;-</span> coordinates[k, ]</span>
<span id="cb4-828"><a href="#cb4-828" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-829"><a href="#cb4-829" aria-hidden="true" tabindex="-1"></a>        coordinates_complete[<span class="fu">as.numeric</span>(values_coordinates[<span class="dv">1</span>]), ] <span class="ot">&lt;-</span> values_coordinates</span>
<span id="cb4-830"><a href="#cb4-830" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-831"><a href="#cb4-831" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-832"><a href="#cb4-832" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-833"><a href="#cb4-833" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-834"><a href="#cb4-834" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-835"><a href="#cb4-835" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Values for when the snake is still inside the initial refuge</span></span>
<span id="cb4-836"><a href="#cb4-836" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_complete)){</span>
<span id="cb4-837"><a href="#cb4-837" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-838"><a href="#cb4-838" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If the snake hasn't exited the initial refuge</span></span>
<span id="cb4-839"><a href="#cb4-839" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(j <span class="sc">&lt;=</span> <span class="fu">as.numeric</span>(sec_bf_head_out)){</span>
<span id="cb4-840"><a href="#cb4-840" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-841"><a href="#cb4-841" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>x[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-842"><a href="#cb4-842" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>y[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-843"><a href="#cb4-843" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Central_area[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-844"><a href="#cb4-844" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Intermediate_area[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-845"><a href="#cb4-845" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Refuge_area_1[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-846"><a href="#cb4-846" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Refuge_area_2[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-847"><a href="#cb4-847" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Initial_refuge[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-848"><a href="#cb4-848" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Distant_wall[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-849"><a href="#cb4-849" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Lateral_1[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-850"><a href="#cb4-850" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Lateral_2[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-851"><a href="#cb4-851" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Arena_area[j] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb4-852"><a href="#cb4-852" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> <span class="st">"Initial refuge"</span></span>
<span id="cb4-853"><a href="#cb4-853" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_0[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-854"><a href="#cb4-854" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_1[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-855"><a href="#cb4-855" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_2[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-856"><a href="#cb4-856" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_3[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_3[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-857"><a href="#cb4-857" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_hole_4[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_4[<span class="fu">as.numeric</span>(sec_bf_head_out) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb4-858"><a href="#cb4-858" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_min[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-859"><a href="#cb4-859" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>hole_dist_min[j] <span class="ot">&lt;-</span> <span class="st">"dist_hole_0"</span></span>
<span id="cb4-860"><a href="#cb4-860" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>dist_traveled[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-861"><a href="#cb4-861" aria-hidden="true" tabindex="-1"></a>          coordinates_complete<span class="sc">$</span>behaviour[j] <span class="ot">&lt;-</span> <span class="st">"hidden"</span></span>
<span id="cb4-862"><a href="#cb4-862" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-863"><a href="#cb4-863" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-864"><a href="#cb4-864" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-865"><a href="#cb4-865" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-866"><a href="#cb4-866" aria-hidden="true" tabindex="-1"></a>          <span class="co"># If the snake is missing (hidden), which parameters are going to exhibit those frames. We are going to copy the parameters from the last recorded frame, except specific parameters.</span></span>
<span id="cb4-867"><a href="#cb4-867" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">is.na</span>(coordinates_complete<span class="sc">$</span>x[j]) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb4-868"><a href="#cb4-868" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-869"><a href="#cb4-869" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>x[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>x[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-870"><a href="#cb4-870" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>y[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>y[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-871"><a href="#cb4-871" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Central_area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Central_area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-872"><a href="#cb4-872" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Intermediate_area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Intermediate_area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-873"><a href="#cb4-873" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Refuge_area_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Refuge_area_1[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-874"><a href="#cb4-874" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Refuge_area_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Refuge_area_2[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-875"><a href="#cb4-875" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Initial_refuge[j] <span class="ot">&lt;-</span>  coordinates_complete<span class="sc">$</span>Initial_refuge[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-876"><a href="#cb4-876" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Distant_wall[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Distant_wall[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-877"><a href="#cb4-877" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Lateral_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Lateral_1[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-878"><a href="#cb4-878" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Lateral_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Lateral_2[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-879"><a href="#cb4-879" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Arena_area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Arena_area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-880"><a href="#cb4-880" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>Area[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>Area[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-881"><a href="#cb4-881" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_0[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_0[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-882"><a href="#cb4-882" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_1[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_1[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-883"><a href="#cb4-883" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_2[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_2[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-884"><a href="#cb4-884" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_3[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_3[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-885"><a href="#cb4-885" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_hole_4[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>dist_hole_4[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-886"><a href="#cb4-886" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_min[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-887"><a href="#cb4-887" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>hole_dist_min[j] <span class="ot">&lt;-</span> coordinates_complete<span class="sc">$</span>hole_dist_min[j <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb4-888"><a href="#cb4-888" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>dist_traveled[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-889"><a href="#cb4-889" aria-hidden="true" tabindex="-1"></a>            coordinates_complete<span class="sc">$</span>behaviour[j] <span class="ot">&lt;-</span> <span class="st">"hidden"</span></span>
<span id="cb4-890"><a href="#cb4-890" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-891"><a href="#cb4-891" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-892"><a href="#cb4-892" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb4-893"><a href="#cb4-893" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-894"><a href="#cb4-894" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-895"><a href="#cb4-895" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-896"><a href="#cb4-896" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-897"><a href="#cb4-897" aria-hidden="true" tabindex="-1"></a>      <span class="co"># It might happen that the snake is being recorded for more than 1h, and we want to know their behaviour in 1h-tests. It's for this reason that we are going to cut all videos to 1h (3600 sec). If the video lasts less than 1h, for the moment we are not going to do anything.</span></span>
<span id="cb4-898"><a href="#cb4-898" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_complete) <span class="sc">&gt;</span> <span class="dv">3600</span>){</span>
<span id="cb4-899"><a href="#cb4-899" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-900"><a href="#cb4-900" aria-hidden="true" tabindex="-1"></a>        coordinates_complete <span class="ot">&lt;-</span> coordinates_complete[<span class="dv">1</span><span class="sc">:</span><span class="dv">3600</span>, ]</span>
<span id="cb4-901"><a href="#cb4-901" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-902"><a href="#cb4-902" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb4-903"><a href="#cb4-903" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-904"><a href="#cb4-904" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-905"><a href="#cb4-905" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-906"><a href="#cb4-906" aria-hidden="true" tabindex="-1"></a>      Snake_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_complete), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coordinates_complete[ , ])</span>
<span id="cb4-907"><a href="#cb4-907" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-908"><a href="#cb4-908" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Snake_array"</span>, Snake_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb4-909"><a href="#cb4-909" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-910"><a href="#cb4-910" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Snake_array"</span>, i)</span>
<span id="cb4-911"><a href="#cb4-911" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-912"><a href="#cb4-912" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-913"><a href="#cb4-913" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-914"><a href="#cb4-914" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-915"><a href="#cb4-915" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-916"><a href="#cb4-916" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-917"><a href="#cb4-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-918"><a href="#cb4-918" aria-hidden="true" tabindex="-1"></a><span class="co"># Set WD to save 3D array</span></span>
<span id="cb4-919"><a href="#cb4-919" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking"</span>)</span>
<span id="cb4-920"><a href="#cb4-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-921"><a href="#cb4-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Save 3D array</span></span>
<span id="cb4-922"><a href="#cb4-922" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(Snake_array, <span class="at">file=</span><span class="st">"Snake_array.Rda"</span>)</span>
<span id="cb4-923"><a href="#cb4-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-924"><a href="#cb4-924" aria-hidden="true" tabindex="-1"></a><span class="co"># Load snake 3D array</span></span>
<span id="cb4-925"><a href="#cb4-925" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Snake_array.Rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Arena_array</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arena array</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable names for each column</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We create empty data frame that is going to store: x axis = time step, y = variables, z = individuals</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Arena_array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="fu">length</span>(variable_names), <span class="fu">nrow</span>(Snake_data_tracked)))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We set the column names for the variables across the array</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(Arena_array)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> variable_names</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We set the ID code for all tracked snakes across the array</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(Arena_array)[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> Snake_data_tracked<span class="sc">$</span>Snake_ID</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Arena array</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS TAKES A LOT OF TIME. DO NOT RUN AND LOAD DIRECTLY FROM WD</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Snake_data_tracked)){</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it is the first trial (no repeatability)...</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Repeatability[i] <span class="sc">==</span> <span class="st">"N"</span>){</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... set the working directory in the correct folder...</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking/Excels tracking"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... and if it didn't get out of the original refuge, fill the correspondent data layer with 0. Otherwise...</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">==</span> <span class="st">"NA"</span>){</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># There is no arena drown for snakes that didn't get out of the refuge, so we have to draw them manually</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">13</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(arena) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      arena<span class="sc">$</span>t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">1</span>))</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>      arena<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>      arena<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.43</span>, <span class="fl">1.06</span>, <span class="fl">1.06</span>, <span class="fl">0.43</span>, <span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>      Arena_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(arena), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(arena[ , ])</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Arena_array"</span>, Arena_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Arena_array"</span>, i)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ... extract data from its tracked Excel file.</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">!=</span> <span class="st">"NA"</span>){</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select arena limits and refuges from specific individual</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>      name_arena <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID[i], <span class="st">"_arena.xlsx"</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(name_arena)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>      Arena_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(arena), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(arena[ , ])</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Arena_array"</span>, Arena_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Arena_array"</span>, i)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If it is a snake used for repeatability, ...</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Repeatability[i] <span class="sc">==</span> <span class="st">"Y"</span>){</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... set the correct wd ...</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking/Excels tracking/Replicates"</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... and check if the snake did get out of the initial refuge or not. If it didn't, fill with 0.</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">==</span> <span class="st">"NA"</span>){</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># There is no arena drown for snakes that didn't get out of the refuge, so we have to draw them manually</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">13</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(arena) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>      arena<span class="sc">$</span>t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">1</span>))</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>      arena<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>, <span class="sc">-</span><span class="fl">0.73</span>)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>      arena<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.43</span>, <span class="fl">1.06</span>, <span class="fl">1.06</span>, <span class="fl">0.43</span>, <span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>      Arena_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(arena), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(arena[ , ])</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Arena_array"</span>, Arena_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Arena_array"</span>, i)</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If the snake did get out of the refuge, extract data from excel</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">!=</span> <span class="st">"NA"</span>){</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select arena limits and refuges from specific individual</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>      name_arena <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID[i], <span class="st">"_arena.xlsx"</span>)</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(name_arena)</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>      Arena_array[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(arena), , i] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(arena[ , ])</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"Arena_array"</span>, Arena_array, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Arena_array"</span>, i)</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Set WD to save 3D array</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/marc9/Desktop/Marc/CREAF/Snake tracking"</span>)</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Save 3D array</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(Arena_array, <span class="at">file=</span><span class="st">"Arena_array.Rda"</span>)</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Load arena 3D array</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Arena_array.Rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarized-data" class="level3">
<h3 class="anchored" data-anchor-id="summarized-data">1.2. Summarized data</h3>
<p>No need to run if <code>summary_tracking</code> and <code>summary_tracking_complete</code> are already loaded.</p>
<p><code>summary_tracking</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>variables_track <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"time_central_area"</span>, <span class="st">"time_intermediate_area"</span>, <span class="st">"time_refuge_area_1"</span>, <span class="st">"time_refuge_area_2"</span>, <span class="st">"time_initial_refuge"</span>, <span class="st">"time_distant_wall"</span>, <span class="st">"time_lateral_1"</span>, <span class="st">"time_lateral_2"</span>, <span class="st">"time_hidden_bf_head_out"</span>, <span class="st">"total_time_hidden"</span>, <span class="st">"time_entrance"</span>, <span class="st">"time_hole_1"</span>, <span class="st">"time_hole_2"</span>, <span class="st">"time_hole_3"</span>, <span class="st">"time_hole_4"</span>, <span class="st">"mean_dist_refuge"</span>, <span class="st">"mean_dist_closest_refuge"</span>, <span class="st">"beh_moving"</span>, <span class="st">"beh_exploring_wall"</span>, <span class="st">"beh_immobile_exposed"</span>, <span class="st">"beh_head-out"</span>, <span class="st">"beh_hiding-head-out"</span>, <span class="st">"beh_head-out_after_body_out"</span>, <span class="st">"avg_speed"</span>, <span class="st">"avg_speed_exploring"</span>, <span class="st">"total_dist_travelled"</span>, <span class="st">"dist_travelled_exploring"</span>, <span class="st">"dist_trav_5min_body_out"</span>, <span class="st">"dist_trav_10min_body_out"</span>, <span class="st">"dist_trav_15min_body_out"</span>, <span class="st">"dist_trav_20min_body_out"</span>, <span class="st">"dist_trav_25min_body_out"</span>, <span class="st">"dist_trav_30min_body_out"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We create the data frame that is going to store all the data</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>summary_tracking <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="fu">length</span>(variables_track), <span class="at">nrow =</span> <span class="fu">nrow</span>(Snake_data_tracked)))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summary_tracking) <span class="ot">&lt;-</span> variables_track</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We generate the final data frame based on a fixed number of seconds</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>generate_summary_tracking <span class="ot">&lt;-</span> <span class="cf">function</span>(time_limit){</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Snake_data_tracked)){</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">!=</span> <span class="st">"NA"</span> <span class="sc">&amp;</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i]) <span class="sc">&lt;</span> time_limit){</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract snake info from array</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , i])</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract arena info from array</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      arena <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Arena_array[, , i])</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How much time does the snake hide before first head-out</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      sec_bf_head_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[i])</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># for those individuals that do head-out, but not body-out</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(Snake_data_tracked<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">!=</span> <span class="st">"NA"</span>){</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        sec_bf_body_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_body_out_sec_raw[i])</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span>  {</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        sec_bf_body_out <span class="ot">&lt;-</span> time_limit</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Let's compile all the info we have</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      tracking_ind <span class="ot">&lt;-</span> summary_tracking[<span class="dv">1</span>, ]</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      tracking_ind[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ID</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>ID <span class="ot">&lt;-</span> Snake_data_tracked<span class="sc">$</span>Snake_ID[i]</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Area use</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      Time_central_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>      Time_intermediate_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>      Time_refuge_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>      Time_refuge_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>      Time_initial_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>      Time_distant_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>      Time_lateral_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>      Time_lateral_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>      Time_hidden <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>      <span class="co"># How much time does the snake spend in each area</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"hidden"</span>){</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>          Time_hidden <span class="ot">&lt;-</span> Time_hidden <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Central area"</span>) {</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>            Time_central_area <span class="ot">&lt;-</span> Time_central_area <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Intermediate area"</span>) {</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>            Time_intermediate_area <span class="ot">&lt;-</span> Time_intermediate_area <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Refuge area 1"</span>){</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>            Time_refuge_area_1 <span class="ot">&lt;-</span> Time_refuge_area_1 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Refuge area 2"</span>){</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>            Time_refuge_area_2 <span class="ot">&lt;-</span> Time_refuge_area_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Initial refuge"</span>){</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>            Time_initial_refuge <span class="ot">&lt;-</span> Time_initial_refuge <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Distant wall"</span>){</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>            Time_distant_wall <span class="ot">&lt;-</span> Time_distant_wall <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Lateral 1"</span>){</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>            Time_lateral_area_1 <span class="ot">&lt;-</span> Time_lateral_area_1 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[k] <span class="sc">==</span> <span class="st">"Lateral 2"</span>){</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>            Time_lateral_area_2 <span class="ot">&lt;-</span> Time_lateral_area_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_central_area <span class="ot">&lt;-</span> Time_central_area</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_intermediate_area <span class="ot">&lt;-</span> Time_intermediate_area</span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_refuge_area_1 <span class="ot">&lt;-</span> Time_refuge_area_1</span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_refuge_area_2 <span class="ot">&lt;-</span> Time_refuge_area_2</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_initial_refuge <span class="ot">&lt;-</span> Time_initial_refuge</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_distant_wall <span class="ot">&lt;-</span> Time_distant_wall</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_lateral_1 <span class="ot">&lt;-</span> Time_lateral_area_1</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_lateral_2 <span class="ot">&lt;-</span> Time_lateral_area_2</span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hidden_bf_head_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sec_bf_head_out)</span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>total_time_hidden <span class="ot">&lt;-</span> Time_hidden</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Proximity to refuges</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>      no_hidden <span class="ot">&lt;-</span> coordinates[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"hidden"</span>, coordinates<span class="sc">$</span>behaviour), ]</span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>      hole_proximity <span class="ot">&lt;-</span> <span class="fu">table</span>(no_hidden<span class="sc">$</span>hole_dist_min)</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_entrance <span class="ot">&lt;-</span> hole_proximity[<span class="dv">1</span>]</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_1 <span class="ot">&lt;-</span> hole_proximity[<span class="dv">2</span>]</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_2 <span class="ot">&lt;-</span> hole_proximity[<span class="dv">3</span>]</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_3 <span class="ot">&lt;-</span> hole_proximity[<span class="dv">4</span>]</span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_4 <span class="ot">&lt;-</span> hole_proximity[<span class="dv">5</span>]</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>      dist_refuges <span class="ot">&lt;-</span> <span class="fu">c</span>(no_hidden<span class="sc">$</span>dist_hole_0, no_hidden<span class="sc">$</span>dist_hole_1, no_hidden<span class="sc">$</span>dist_hole_2, no_hidden<span class="sc">$</span>dist_hole_3, no_hidden<span class="sc">$</span>dist_hole_4)</span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>mean_dist_refuge <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(dist_refuges))</span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>mean_dist_closest_refuge <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(no_hidden<span class="sc">$</span>dist_min))</span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Behaviour</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>      moving <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>      exploring_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>      head_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>      hidden_head_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>      immobile <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>      hidden <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"moving"</span>){</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>          moving <span class="ot">&lt;-</span> moving <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"exploring wall"</span>){</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>          exploring_wall <span class="ot">&lt;-</span> exploring_wall <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"head-out"</span>){</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>          head_out <span class="ot">&lt;-</span> head_out <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"hiding / head-out"</span>){</span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>          hidden_head_out <span class="ot">&lt;-</span> hidden_head_out <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"immobile exposed"</span>){</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>          immobile <span class="ot">&lt;-</span> immobile <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[k] <span class="sc">==</span> <span class="st">"hidden"</span>){</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>          hidden <span class="ot">&lt;-</span> hidden <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>      <span class="co"># To find how many seconds the snake does head-out after exiting the initial refuge</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(sec_bf_body_out <span class="sc">!=</span> time_limit){</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>        coordinates_body_out <span class="ot">&lt;-</span> coordinates[sec_bf_body_out<span class="sc">:</span><span class="fu">nrow</span>(coordinates), ]</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>        head_out_after_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_body_out)){</span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(coordinates_body_out<span class="sc">$</span>behaviour[j] <span class="sc">==</span> <span class="st">"head-out"</span>){</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>            head_out_after_body_out <span class="ot">&lt;-</span> head_out_after_body_out <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a>        coordinates_body_out <span class="ot">&lt;-</span> coordinates[<span class="dv">1</span>, ]</span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>        head_out_after_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>beh_moving <span class="ot">&lt;-</span> moving</span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>beh_exploring_wall <span class="ot">&lt;-</span> exploring_wall</span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>beh_immobile_exposed <span class="ot">&lt;-</span> immobile</span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span><span class="st">`</span><span class="at">beh_head-out</span><span class="st">`</span> <span class="ot">&lt;-</span> head_out</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span><span class="st">`</span><span class="at">beh_hiding-head-out</span><span class="st">`</span> <span class="ot">&lt;-</span> hidden_head_out</span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span><span class="st">`</span><span class="at">beh_head-out_after_body_out</span><span class="st">`</span> <span class="ot">&lt;-</span> head_out_after_body_out</span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>avg_speed <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(coordinates<span class="sc">$</span>dist_traveled))</span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>total_dist_travelled <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates<span class="sc">$</span>dist_traveled))</span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Distance travelled when moving in the floor, not wall exploration</span></span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a>      moving <span class="ot">&lt;-</span> coordinates[coordinates<span class="sc">$</span>behaviour <span class="sc">==</span> <span class="st">"moving"</span>, ]</span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>avg_speed_exploring <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(moving<span class="sc">$</span>dist_traveled))</span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_travelled_exploring <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(moving<span class="sc">$</span>dist_traveled))</span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if the snake is out for more than 5 min</span></span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_body_out) <span class="sc">&gt;=</span> <span class="dv">300</span>){</span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a>        <span class="co"># distance travelled in those 5 min</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a>        tracking_ind<span class="sc">$</span>dist_trav_5min_body_out <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates_body_out<span class="sc">$</span>dist_traveled[<span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>]))</span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Then, if the snake has been out for 10 min or more</span></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_body_out) <span class="sc">&gt;=</span> <span class="dv">600</span>){</span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a>          <span class="co"># distance travelled in those 10 min</span></span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a>          tracking_ind<span class="sc">$</span>dist_trav_10min_body_out <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates_body_out<span class="sc">$</span>dist_traveled[<span class="dv">1</span><span class="sc">:</span><span class="dv">600</span>]))</span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a>          <span class="co"># and if it has been outside for more than 15 min</span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_body_out) <span class="sc">&gt;=</span> <span class="dv">900</span>){</span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a>            <span class="co"># distance travelled in those 15 min</span></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a>            tracking_ind<span class="sc">$</span>dist_trav_15min_body_out <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates_body_out<span class="sc">$</span>dist_traveled[<span class="dv">1</span><span class="sc">:</span><span class="dv">900</span>]))</span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_body_out) <span class="sc">&gt;=</span> <span class="dv">1200</span>){</span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a>              <span class="co"># distance travelled in those 20 min</span></span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a>              tracking_ind<span class="sc">$</span>dist_trav_20min_body_out <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates_body_out<span class="sc">$</span>dist_traveled[<span class="dv">1</span><span class="sc">:</span><span class="dv">1200</span>]))</span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_body_out) <span class="sc">&gt;=</span> <span class="dv">1500</span>){</span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a>                <span class="co"># distance travelled in those 25 min</span></span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a>                tracking_ind<span class="sc">$</span>dist_trav_25min_body_out <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates_body_out<span class="sc">$</span>dist_traveled[<span class="dv">1</span><span class="sc">:</span><span class="dv">1500</span>]))</span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span>(<span class="fu">nrow</span>(coordinates_body_out) <span class="sc">&gt;=</span> <span class="dv">1800</span>){</span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># distance travelled in those 25 min</span></span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a>                  tracking_ind<span class="sc">$</span>dist_trav_30min_body_out <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(coordinates_body_out<span class="sc">$</span>dist_traveled[<span class="dv">1</span><span class="sc">:</span><span class="dv">1800</span>]))</span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a>        <span class="co"># do nothing</span></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Merge ind data to global database</span></span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a>      summary_tracking[i, ] <span class="ot">&lt;-</span> tracking_ind</span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a>      summary_tracking[i, ][summary_tracking[i, ] <span class="sc">==</span> <span class="st">"NaN"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a>      summary_tracking[i, ][<span class="fu">is.na</span>(summary_tracking[i, ])] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"summary_tracking"</span>, summary_tracking, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a>      tracking_ind <span class="ot">&lt;-</span> summary_tracking[<span class="dv">1</span>, ]</span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a>      tracking_ind[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ID</span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>ID <span class="ot">&lt;-</span> Snake_data_tracked<span class="sc">$</span>Snake_ID[i]</span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Area use</span></span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_central_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_intermediate_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_refuge_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_refuge_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_initial_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_distant_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_lateral_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_lateral_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hidden_bf_head_out <span class="ot">&lt;-</span> time_limit</span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>total_time_hidden <span class="ot">&lt;-</span> time_limit</span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Proximity to refuges</span></span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_entrance <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_3 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>time_hole_4 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>mean_dist_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>mean_dist_closest_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Behaviour</span></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>beh_moving <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>beh_exploring_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>beh_immobile_exposed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span><span class="st">`</span><span class="at">beh_head-out</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span><span class="st">`</span><span class="at">beh_hiding-head-out</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span><span class="st">`</span><span class="at">beh_head-out_after_body_out</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>avg_speed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>avg_speed_exploring <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>total_dist_travelled <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_travelled_exploring <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_trav_5min_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_trav_10min_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_trav_15min_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_trav_20min_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_trav_25min_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a>      tracking_ind<span class="sc">$</span>dist_trav_30min_body_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Merge ind data to global database</span></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a>      summary_tracking[i, ] <span class="ot">&lt;-</span> tracking_ind</span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="st">"summary_tracking"</span>, summary_tracking, <span class="at">envir=</span><span class="fu">globalenv</span>())</span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_summary_tracking</span>(<span class="dv">3000</span>)</span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Save file in correspondant folder</span></span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(summary_tracking, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">marc9</span><span class="sc">\\</span><span class="st">Desktop</span><span class="sc">\\</span><span class="st">Marc</span><span class="sc">\\</span><span class="st">CREAF</span><span class="sc">\\</span><span class="st">Snake tracking</span><span class="sc">\\</span><span class="st">summary_tracking.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>summary_tracking_complete</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>time_limit <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns of interest</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final <span class="ot">&lt;-</span> Snake_data_tracked[, <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"Trap_ID"</span>, <span class="st">"Locality"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Inv_situation"</span>, <span class="st">"Capture_day"</span>, <span class="st">"Test_day"</span>, <span class="st">"Acc_time"</span>, <span class="st">"Hour manip."</span>, <span class="st">"Hour accl."</span>, <span class="st">"Hour test"</span>, <span class="st">"Time_head_out_sec_raw"</span>, <span class="st">"Time_body_out_sec_raw"</span>, <span class="st">"Temperature"</span>, <span class="st">"R_H"</span>, <span class="st">"Weather"</span>, <span class="st">"Arena"</span>, <span class="st">"Official"</span>, <span class="st">"Repeatability"</span>, <span class="st">"Tracking"</span>, <span class="st">"Year_invasion"</span>, <span class="st">"Distance_Noahs"</span>, <span class="st">"SVL"</span>, <span class="st">"Real_Weight"</span>, <span class="st">"Condition"</span>, <span class="st">"Sex"</span>, <span class="st">"N_eggs"</span>, <span class="st">"Hard_Drive"</span>)]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform variable into numeric</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Time_head_out_sec_raw <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked_final<span class="sc">$</span>Time_head_out_sec_raw)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Time_body_out_sec_raw <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked_final<span class="sc">$</span>Time_body_out_sec_raw)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If snake didn't get out, the number of seconds is 3000</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final <span class="ot">&lt;-</span> Snake_data_tracked_final <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time_head_out_sec_raw =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Time_head_out_sec_raw), time_limit, Time_head_out_sec_raw))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final <span class="ot">&lt;-</span> Snake_data_tracked_final <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time_body_out_sec_raw =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Time_body_out_sec_raw), time_limit, Time_body_out_sec_raw))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># If head-out/Body-out time is larger than 3000 sec, cut it at 3000 </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Snake_data_tracked_final)){</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Snake_data_tracked_final<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">&gt;</span> time_limit){</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    Snake_data_tracked_final<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="ot">&lt;-</span> time_limit</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Snake_data_tracked_final<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">&gt;</span> time_limit){</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    Snake_data_tracked_final<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="ot">&lt;-</span> time_limit</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Change type of variable for some variables</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Locality <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Locality)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Inv_situation <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Inv_situation)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Capture_day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Capture_day)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Test_day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Test_day)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Acc_time <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Acc_time)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Arena <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Arena)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Official <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Official)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Repeatability <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Repeatability)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>Snake_data_tracked_final<span class="sc">$</span>Tracking <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Snake_data_tracked_final<span class="sc">$</span>Tracking)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Snake_data_tracked_final, summary_tracking)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete <span class="ot">&lt;-</span> <span class="fu">add_column</span>(summary_tracking_complete, <span class="at">Visual_exp =</span> summary_tracking_complete<span class="sc">$</span>Time_body_out_sec_raw <span class="sc">-</span> summary_tracking_complete<span class="sc">$</span>Time_head_out_sec_raw, <span class="at">.after =</span> summary_tracking_complete<span class="sc">$</span>Time_body_out_sec_raw)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Save file as CSV in order to plot it in QGIS and extract year of invasion, distance to Noah's garden, ...</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(summary_tracking_complete, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">marc9</span><span class="sc">\\</span><span class="st">Desktop</span><span class="sc">\\</span><span class="st">Marc</span><span class="sc">\\</span><span class="st">CREAF</span><span class="sc">\\</span><span class="st">Snake tracking</span><span class="sc">\\</span><span class="st">summary_tracking_complete.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(summary_tracking_complete, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">marc9</span><span class="sc">\\</span><span class="st">Desktop</span><span class="sc">\\</span><span class="st">Marc</span><span class="sc">\\</span><span class="st">CREAF</span><span class="sc">\\</span><span class="st">Snake tracking</span><span class="sc">\\</span><span class="st">summary_tracking_complete.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="individual-plots" class="level2">
<h2 class="anchored" data-anchor-id="individual-plots">2. Individual plots</h2>
<p>This part is dedicated to the visualisation of the movement of each individual inside the arena. There are also plots dedicated to showing the proportion of time taken by each snake to explore the different areas of the arena, the behaviour expressed and the speed of movement at each instant.</p>
<p>For the visualization of these plots, you must choose the ID of the individual, if it is the first behavioural test that it did (N) or if it is one of the individuals that repeated the experiments to study the repeatability of the behaviour (Y), and the time in seconds that you want to analyse (maximum 3000 seconds).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">&lt;-</span> <span class="dv">202308</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>repeatability <span class="ot">&lt;-</span> <span class="st">"N"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>time_limit <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>data_visualization <span class="ot">&lt;-</span> <span class="cf">function</span>(ID, repeatability, time_limit){</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which snake are we going to visualize</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  selected_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID <span class="sc">==</span> ID <span class="sc">&amp;</span> Snake_data_tracked<span class="sc">$</span>Repeatability <span class="sc">==</span> repeatability)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract snake info from array</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , selected_ind])</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract arena info from array</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  arena <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Arena_array[, , selected_ind])</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Let's start drawing</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.6</span>), <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>) </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lateral refuge area 1</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>], arena[<span class="dv">2</span>, <span class="dv">2</span>], arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>], arena[<span class="dv">2</span>, <span class="dv">3</span>], arena[<span class="dv">2</span>, <span class="dv">3</span>], arena[<span class="dv">1</span>, <span class="dv">3</span>]),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>]) </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lateral refuge area 2</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">3</span>, <span class="dv">2</span>], arena[<span class="dv">4</span>, <span class="dv">2</span>], arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">3</span>, <span class="dv">3</span>], arena[<span class="dv">4</span>, <span class="dv">3</span>], arena[<span class="dv">4</span>, <span class="dv">3</span>], arena[<span class="dv">3</span>, <span class="dv">3</span>]),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>])</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Distant wall area</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>], arena[<span class="dv">3</span>, <span class="dv">3</span>], arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">5</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">5</span>]) </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initial refuge area</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span><span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span><span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>], arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>]),</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">4</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">4</span>]) </span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Refuge area 1</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>),</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>]) </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Refuge area 2</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>])</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intermediate area</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span>),</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.25</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.25</span>),</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">2</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">2</span>]) </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Central area</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">-</span> <span class="fl">0.75</span>, arena[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.75</span>, arena[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.75</span>, arena[<span class="dv">4</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.75</span>),</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.5</span>, arena[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>, arena[<span class="dv">4</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">0.5</span>),</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">1</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">1</span>]) </span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Border real arena</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">2</span>], arena[<span class="dv">2</span>, <span class="dv">2</span>], arena[<span class="dv">3</span>, <span class="dv">2</span>], arena[<span class="dv">4</span>, <span class="dv">2</span>]),</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">c</span>(arena[<span class="dv">1</span>, <span class="dv">3</span>], arena[<span class="dv">2</span>, <span class="dv">3</span>], arena[<span class="dv">3</span>, <span class="dv">3</span>], arena[<span class="dv">4</span>, <span class="dv">3</span>]),  </span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">lwd =</span> <span class="dv">2</span>) </span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Refuge coordinates</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>  refuges <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(arena[<span class="dv">5</span>, <span class="dv">2</span>], arena[<span class="dv">6</span>, <span class="dv">2</span>], arena[<span class="dv">7</span>, <span class="dv">2</span>], arena[<span class="dv">8</span>, <span class="dv">2</span>], arena[<span class="dv">9</span>, <span class="dv">2</span>]),</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">c</span>(arena[<span class="dv">5</span>, <span class="dv">3</span>], arena[<span class="dv">6</span>, <span class="dv">3</span>], arena[<span class="dv">7</span>, <span class="dv">3</span>], arena[<span class="dv">8</span>, <span class="dv">3</span>], arena[<span class="dv">9</span>, <span class="dv">3</span>])))</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot refuges</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(refuges, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot snakee trail</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(coordinates<span class="sc">$</span>x, coordinates<span class="sc">$</span>y, <span class="at">type =</span><span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># In case you want to draw lateral refuge limits </span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lines(c(arena[10, 2], arena[11, 2]), c(arena[10, 3], arena[11, 3]))</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lines(c(arena[12, 2], arena[13, 2]), c(arena[12, 3], arena[13, 3]))</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exit from refuge (Last frame you were missing, and now I have detected you)</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> <span class="st">"hidden"</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>behaviour[i] <span class="sc">!=</span> <span class="st">"hidden"</span>){</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">points</span>(coordinates<span class="sc">$</span>x[i], coordinates<span class="sc">$</span>y[i], </span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>             <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">24</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enter to refuge (Now I see you, but next frame I don't)</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(coordinates) <span class="sc">-</span> <span class="dv">1</span>)){</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">!=</span> <span class="st">"hidden"</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>behaviour[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">==</span> <span class="st">"hidden"</span>){</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>      <span class="fu">points</span>(coordinates<span class="sc">$</span>x[i], coordinates<span class="sc">$</span>y[i], </span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>             <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">25</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>density_function <span class="ot">&lt;-</span> <span class="cf">function</span>(ID, repeatability, time_limit){</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which snake are we going to visualize</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>  selected_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID <span class="sc">==</span> ID <span class="sc">&amp;</span> Snake_data_tracked<span class="sc">$</span>Repeatability <span class="sc">==</span> repeatability)</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract snake info from array</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , selected_ind])</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>  no_hidden <span class="ot">&lt;-</span> coordinates[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"hidden"</span>, coordinates<span class="sc">$</span>behaviour), ]</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> no_hidden</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(coordinates, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.numeric</span>(x), <span class="at">y=</span><span class="fu">as.numeric</span>(y))) <span class="sc">+</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bin2d</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_continuous</span>(<span class="at">type =</span> <span class="st">"viridis"</span>) <span class="sc">+</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot(coordinates, aes(x=x, y=y) ) +</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_density_2d(aes(fill = ..level..), geom = "polygon", colour="white")</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>graph_area <span class="ot">&lt;-</span> <span class="cf">function</span>(ID, repeatability, time_limit){</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which snake are we going to visualize</span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>  selected_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID <span class="sc">==</span> ID <span class="sc">&amp;</span> Snake_data_tracked<span class="sc">$</span>Repeatability <span class="sc">==</span> repeatability)</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract snake info from array</span></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , selected_ind])</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># How many seconds the snake has the snake been in each region</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>  Time_central_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>  Time_intermediate_area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>  Time_refuge_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>  Time_refuge_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>  Time_initial_refuge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>  Time_distant_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>  Time_lateral_area_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>  Time_lateral_area_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>  Time_hidden <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>  <span class="co"># How much time does the snake spend in each area</span></span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hidden"</span>){</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>      Time_hidden <span class="ot">&lt;-</span> Time_hidden <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Central area"</span>) {</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>        Time_central_area <span class="ot">&lt;-</span> Time_central_area <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Intermediate area"</span>) {</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>        Time_intermediate_area <span class="ot">&lt;-</span> Time_intermediate_area <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Refuge area 1"</span>){</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>        Time_refuge_area_1 <span class="ot">&lt;-</span> Time_refuge_area_1 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Refuge area 2"</span>){</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>        Time_refuge_area_2 <span class="ot">&lt;-</span> Time_refuge_area_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Initial refuge"</span>){</span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>        Time_initial_refuge <span class="ot">&lt;-</span> Time_initial_refuge <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Distant wall"</span>){</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>        Time_distant_wall <span class="ot">&lt;-</span> Time_distant_wall <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Lateral 1"</span>){</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>        Time_lateral_area_1 <span class="ot">&lt;-</span> Time_lateral_area_1 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (coordinates<span class="sc">$</span>Area[i] <span class="sc">==</span> <span class="st">"Lateral 2"</span>){</span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>        Time_lateral_area_2 <span class="ot">&lt;-</span> Time_lateral_area_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vector with number of seconds</span></span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>  total_use  <span class="ot">&lt;-</span> <span class="fu">c</span>(Time_hidden, Time_lateral_area_1, Time_lateral_area_2, Time_distant_wall, Time_initial_refuge, Time_refuge_area_1, Time_refuge_area_2, Time_intermediate_area, Time_central_area)</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vector with percentage </span></span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>  percent_total_use <span class="ot">&lt;-</span> <span class="fu">round</span>(total_use<span class="sc">/</span><span class="fu">sum</span>(total_use)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>  percent_total_use <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(percent_total_use)</span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>  area_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Hidden"</span>, <span class="st">"Lateral refuge 1"</span>, <span class="st">"Lateral refuge 2"</span>, <span class="st">"Distant wall"</span>, <span class="st">"Initial refuge"</span>,  <span class="st">"Refuge 1"</span>, <span class="st">"Refuge 2"</span>, <span class="st">"Intermediate"</span>,  <span class="st">"Central"</span>)</span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> percent_total_use, <span class="fu">aes</span>(<span class="at">x =</span> area_names, <span class="at">y =</span> percent_total_use)) <span class="sc">+</span></span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">5</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">4</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">2</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> percent_total_use), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> area_names) <span class="sc">+</span> </span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span> <span class="fu">paste0</span>(<span class="st">"Percentage of time spent by snake "</span>, ID , <span class="st">" in each area ("</span>, time_limit, <span class="st">" sec)"</span>), </span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span> </span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>graph_hole <span class="ot">&lt;-</span> <span class="cf">function</span>(ID, repeatability, time_limit){</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which snake are we going to visualize</span></span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>  selected_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID <span class="sc">==</span> ID <span class="sc">&amp;</span> Snake_data_tracked<span class="sc">$</span>Repeatability <span class="sc">==</span> repeatability)</span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract snake info from array</span></span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , selected_ind])</span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>  <span class="co"># How much time does the snake hide before first head-out</span></span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>  sec_bf_head_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[selected_ind])</span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We are not interested in the proximity to any hole when the snake is inside a hole, hidden, so we delete the records when the snake is hidden</span></span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a>  no_hidden <span class="ot">&lt;-</span> coordinates[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"hidden"</span>, coordinates<span class="sc">$</span>behaviour), ]</span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> no_hidden</span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which is the closest hole</span></span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>  hole_proximity <span class="ot">&lt;-</span> <span class="fu">table</span>(coordinates<span class="sc">$</span>hole_dist_min)</span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a>  percent_hole_proximity <span class="ot">&lt;-</span> <span class="fu">round</span>(hole_proximity<span class="sc">/</span><span class="fu">sum</span>(hole_proximity)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>  percent_hole_proximity <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(percent_hole_proximity)</span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>  percent_hole_proximity<span class="sc">$</span>Var1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Entrance"</span>, <span class="st">"Hole 1"</span>, <span class="st">"Hole 2"</span>, <span class="st">"Hole 3"</span>, <span class="st">"Hole 4"</span>)</span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> percent_hole_proximity, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Freq)) <span class="sc">+</span></span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill =</span> <span class="fu">c</span>(<span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">5</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">4</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">3</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">2</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> percent_hole_proximity<span class="sc">$</span>Var1) <span class="sc">+</span> </span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste0</span>(<span class="st">"Which is the closest refuge while the snake "</span>, ID, <span class="st">" is out? ("</span>, time_limit, <span class="st">" sec)"</span>), </span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">"Hole"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span> </span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a>graph_behaviour <span class="ot">&lt;-</span> <span class="cf">function</span>(ID, repeatability, time_limit){</span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which snake are we going to visualize</span></span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a>  selected_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID <span class="sc">==</span> ID <span class="sc">&amp;</span> Snake_data_tracked<span class="sc">$</span>Repeatability <span class="sc">==</span> repeatability)</span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract snake info from array</span></span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , selected_ind])</span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which is the behaviour</span></span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a>  moving <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a>  exploring_wall <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-279"><a href="#cb8-279" aria-hidden="true" tabindex="-1"></a>  head_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-280"><a href="#cb8-280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-281"><a href="#cb8-281" aria-hidden="true" tabindex="-1"></a>  hidden_head_out <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-282"><a href="#cb8-282" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-283"><a href="#cb8-283" aria-hidden="true" tabindex="-1"></a>  immobile <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-284"><a href="#cb8-284" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-285"><a href="#cb8-285" aria-hidden="true" tabindex="-1"></a>  hidden <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-286"><a href="#cb8-286" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-287"><a href="#cb8-287" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb8-288"><a href="#cb8-288" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-289"><a href="#cb8-289" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"moving"</span>){</span>
<span id="cb8-290"><a href="#cb8-290" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-291"><a href="#cb8-291" aria-hidden="true" tabindex="-1"></a>      moving <span class="ot">&lt;-</span> moving <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-292"><a href="#cb8-292" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-293"><a href="#cb8-293" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"exploring wall"</span>){</span>
<span id="cb8-294"><a href="#cb8-294" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-295"><a href="#cb8-295" aria-hidden="true" tabindex="-1"></a>      exploring_wall <span class="ot">&lt;-</span> exploring_wall <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-296"><a href="#cb8-296" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-297"><a href="#cb8-297" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"head-out"</span>){</span>
<span id="cb8-298"><a href="#cb8-298" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-299"><a href="#cb8-299" aria-hidden="true" tabindex="-1"></a>      head_out <span class="ot">&lt;-</span> head_out <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-300"><a href="#cb8-300" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-301"><a href="#cb8-301" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hiding / head-out"</span>){</span>
<span id="cb8-302"><a href="#cb8-302" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-303"><a href="#cb8-303" aria-hidden="true" tabindex="-1"></a>      hidden_head_out <span class="ot">&lt;-</span> hidden_head_out <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-304"><a href="#cb8-304" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"immobile exposed"</span>){</span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-307"><a href="#cb8-307" aria-hidden="true" tabindex="-1"></a>      immobile <span class="ot">&lt;-</span> immobile <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-308"><a href="#cb8-308" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-309"><a href="#cb8-309" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hidden"</span>){</span>
<span id="cb8-310"><a href="#cb8-310" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-311"><a href="#cb8-311" aria-hidden="true" tabindex="-1"></a>      hidden <span class="ot">&lt;-</span> hidden <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-312"><a href="#cb8-312" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-313"><a href="#cb8-313" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-314"><a href="#cb8-314" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-315"><a href="#cb8-315" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-316"><a href="#cb8-316" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-317"><a href="#cb8-317" aria-hidden="true" tabindex="-1"></a>  behaviour  <span class="ot">&lt;-</span> <span class="fu">c</span>(hidden, moving, exploring_wall, head_out, hidden_head_out, immobile)</span>
<span id="cb8-318"><a href="#cb8-318" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-319"><a href="#cb8-319" aria-hidden="true" tabindex="-1"></a>  percent_behaviour <span class="ot">&lt;-</span> <span class="fu">round</span>(behaviour<span class="sc">/</span><span class="fu">sum</span>(behaviour)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb8-320"><a href="#cb8-320" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-321"><a href="#cb8-321" aria-hidden="true" tabindex="-1"></a>  percent_behaviour <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(percent_behaviour)</span>
<span id="cb8-322"><a href="#cb8-322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-323"><a href="#cb8-323" aria-hidden="true" tabindex="-1"></a>  behaviour_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Hidden"</span>, <span class="st">"Moving"</span>, <span class="st">"Exploring wall"</span>, <span class="st">"Head-out"</span>, <span class="st">"Hidden / Head-out"</span>, <span class="st">"Immobile exposed"</span>)</span>
<span id="cb8-324"><a href="#cb8-324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-325"><a href="#cb8-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> percent_behaviour, <span class="fu">aes</span>(<span class="at">x =</span> behaviour_names, <span class="at">y =</span> percent_behaviour)) <span class="sc">+</span></span>
<span id="cb8-326"><a href="#cb8-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">5</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">4</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">3</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">2</span>], <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb8-327"><a href="#cb8-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> percent_behaviour), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb8-328"><a href="#cb8-328" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> behaviour_names) <span class="sc">+</span> </span>
<span id="cb8-329"><a href="#cb8-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste0</span>(<span class="st">"Which behaviour is the snake "</span>, ID, <span class="st">" exhibiting? ("</span>, time_limit, <span class="st">" sec)"</span>), </span>
<span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">"Behaviour"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span> </span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a>speed_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(ID, repeatability, time_limit) {</span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span>))  </span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which snake are we going to visualize</span></span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a>  selected_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Snake_data_tracked<span class="sc">$</span>Snake_ID <span class="sc">==</span> ID <span class="sc">&amp;</span> Snake_data_tracked<span class="sc">$</span>Repeatability <span class="sc">==</span> repeatability)</span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract snake info from array</span></span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array[<span class="dv">1</span><span class="sc">:</span>time_limit, , selected_ind])</span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We are going to delete those recordings where the snake comes out from a refuge, because the speed that the snake might exhibit is not real, it comes from going from refuge A to B from "one frame to the next one"</span></span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> <span class="st">"hidden"</span> <span class="sc">&amp;&amp;</span> coordinates<span class="sc">$</span>behaviour[i] <span class="sc">!=</span> <span class="st">"hidden"</span>){</span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a>      coordinates<span class="sc">$</span>dist_traveled[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We plot the results</span></span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(coordinates)), <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fu">max</span>(<span class="fu">as.numeric</span>(coordinates<span class="sc">$</span>dist_traveled))), </span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Time (s)"</span>, </span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Speed (m/s)"</span>,</span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a>       <span class="at">xaxt =</span> <span class="st">"n"</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>,</span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a>       <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-365"><a href="#cb8-365" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-366"><a href="#cb8-366" aria-hidden="true" tabindex="-1"></a>  ticks_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(coordinates), <span class="at">by =</span> <span class="fu">nrow</span>(coordinates)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb8-367"><a href="#cb8-367" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-368"><a href="#cb8-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> ticks_x, </span>
<span id="cb8-369"><a href="#cb8-369" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">c</span>(ticks_x[<span class="dv">1</span>],</span>
<span id="cb8-370"><a href="#cb8-370" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">2</span>], <span class="dv">5</span>),</span>
<span id="cb8-371"><a href="#cb8-371" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">3</span>], <span class="dv">5</span>),</span>
<span id="cb8-372"><a href="#cb8-372" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">4</span>], <span class="dv">5</span>),</span>
<span id="cb8-373"><a href="#cb8-373" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">5</span>], <span class="dv">5</span>),</span>
<span id="cb8-374"><a href="#cb8-374" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">6</span>], <span class="dv">5</span>),</span>
<span id="cb8-375"><a href="#cb8-375" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">7</span>], <span class="dv">5</span>)))</span>
<span id="cb8-376"><a href="#cb8-376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-377"><a href="#cb8-377" aria-hidden="true" tabindex="-1"></a>  ticks_y <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">as.numeric</span>(coordinates<span class="sc">$</span>dist_traveled)), <span class="dv">2</span>)</span>
<span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">round</span>((ticks_y<span class="sc">/</span><span class="dv">3</span>), <span class="dv">2</span>), <span class="fu">round</span>(((ticks_y<span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span><span class="dv">2</span>), <span class="dv">2</span>), ticks_y), <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-384"><a href="#cb8-384" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We plot the behaviour underneath</span></span>
<span id="cb8-385"><a href="#cb8-385" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates)){</span>
<span id="cb8-386"><a href="#cb8-386" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-387"><a href="#cb8-387" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hidden"</span>) {</span>
<span id="cb8-388"><a href="#cb8-388" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-389"><a href="#cb8-389" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-390"><a href="#cb8-390" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-391"><a href="#cb8-391" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"grey50"</span>, <span class="at">border =</span> <span class="st">"grey50"</span>)</span>
<span id="cb8-392"><a href="#cb8-392" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-393"><a href="#cb8-393" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"moving"</span>) {</span>
<span id="cb8-394"><a href="#cb8-394" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-395"><a href="#cb8-395" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-396"><a href="#cb8-396" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-397"><a href="#cb8-397" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">5</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">5</span>])</span>
<span id="cb8-398"><a href="#cb8-398" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-399"><a href="#cb8-399" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"exploring wall"</span>) {</span>
<span id="cb8-400"><a href="#cb8-400" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-401"><a href="#cb8-401" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">4</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">4</span>])</span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-405"><a href="#cb8-405" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"head-out"</span>) {</span>
<span id="cb8-406"><a href="#cb8-406" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-407"><a href="#cb8-407" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-408"><a href="#cb8-408" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-409"><a href="#cb8-409" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">3</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">3</span>])</span>
<span id="cb8-410"><a href="#cb8-410" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-411"><a href="#cb8-411" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hiding / head-out"</span>) {</span>
<span id="cb8-412"><a href="#cb8-412" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-413"><a href="#cb8-413" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-414"><a href="#cb8-414" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-415"><a href="#cb8-415" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">2</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">2</span>])</span>
<span id="cb8-416"><a href="#cb8-416" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-417"><a href="#cb8-417" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"immobile exposed"</span>) {</span>
<span id="cb8-418"><a href="#cb8-418" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-419"><a href="#cb8-419" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-420"><a href="#cb8-420" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-421"><a href="#cb8-421" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span>])</span>
<span id="cb8-422"><a href="#cb8-422" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-423"><a href="#cb8-423" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-424"><a href="#cb8-424" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-425"><a href="#cb8-425" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-426"><a href="#cb8-426" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-427"><a href="#cb8-427" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We plot the speed</span></span>
<span id="cb8-428"><a href="#cb8-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(coordinates<span class="sc">$</span>t, coordinates<span class="sc">$</span>dist_traveled, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb8-429"><a href="#cb8-429" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-430"><a href="#cb8-430" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-431"><a href="#cb8-431" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now for only the part where the snake has exited the initial refuge</span></span>
<span id="cb8-432"><a href="#cb8-432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-433"><a href="#cb8-433" aria-hidden="true" tabindex="-1"></a>  <span class="co"># How much time does the snake hide before first head-out</span></span>
<span id="cb8-434"><a href="#cb8-434" aria-hidden="true" tabindex="-1"></a>  sec_bf_head_out <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Snake_data_tracked<span class="sc">$</span>Time_head_out_sec_raw[selected_ind])</span>
<span id="cb8-435"><a href="#cb8-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-436"><a href="#cb8-436" aria-hidden="true" tabindex="-1"></a>  coordinates_2 <span class="ot">&lt;-</span> coordinates[(sec_bf_head_out <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(coordinates), ]</span>
<span id="cb8-437"><a href="#cb8-437" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-438"><a href="#cb8-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(coordinates_2)), <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fu">max</span>(<span class="fu">as.numeric</span>(coordinates_2<span class="sc">$</span>dist_traveled))),</span>
<span id="cb8-439"><a href="#cb8-439" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb8-440"><a href="#cb8-440" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Time (s)"</span>, </span>
<span id="cb8-441"><a href="#cb8-441" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Speed (m/s)"</span>,</span>
<span id="cb8-442"><a href="#cb8-442" aria-hidden="true" tabindex="-1"></a>       <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">xaxt =</span> <span class="st">"n"</span>,</span>
<span id="cb8-443"><a href="#cb8-443" aria-hidden="true" tabindex="-1"></a>       <span class="at">axes =</span> <span class="cn">FALSE</span></span>
<span id="cb8-444"><a href="#cb8-444" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-445"><a href="#cb8-445" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-446"><a href="#cb8-446" aria-hidden="true" tabindex="-1"></a>  ticks_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(coordinates_2), <span class="at">by =</span> <span class="fu">nrow</span>(coordinates_2)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb8-447"><a href="#cb8-447" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-448"><a href="#cb8-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> ticks_x, </span>
<span id="cb8-449"><a href="#cb8-449" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">c</span>(ticks_x[<span class="dv">1</span>] <span class="sc">+</span> sec_bf_head_out <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb8-450"><a href="#cb8-450" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">2</span>] <span class="sc">+</span> sec_bf_head_out, <span class="dv">5</span>),</span>
<span id="cb8-451"><a href="#cb8-451" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">3</span>] <span class="sc">+</span> sec_bf_head_out, <span class="dv">5</span>),</span>
<span id="cb8-452"><a href="#cb8-452" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">4</span>] <span class="sc">+</span> sec_bf_head_out, <span class="dv">5</span>),</span>
<span id="cb8-453"><a href="#cb8-453" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">5</span>] <span class="sc">+</span> sec_bf_head_out, <span class="dv">5</span>),</span>
<span id="cb8-454"><a href="#cb8-454" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">6</span>] <span class="sc">+</span> sec_bf_head_out, <span class="dv">5</span>),</span>
<span id="cb8-455"><a href="#cb8-455" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round_any</span>(ticks_x[<span class="dv">7</span>] <span class="sc">+</span> sec_bf_head_out, <span class="dv">5</span>)))</span>
<span id="cb8-456"><a href="#cb8-456" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-457"><a href="#cb8-457" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-458"><a href="#cb8-458" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-459"><a href="#cb8-459" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-460"><a href="#cb8-460" aria-hidden="true" tabindex="-1"></a>  ticks_y <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">as.numeric</span>(coordinates_2<span class="sc">$</span>dist_traveled)), <span class="dv">2</span>)</span>
<span id="cb8-461"><a href="#cb8-461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-462"><a href="#cb8-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">round</span>((ticks_y<span class="sc">/</span><span class="dv">3</span>), <span class="dv">2</span>), <span class="fu">round</span>(((ticks_y<span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span><span class="dv">2</span>), <span class="dv">2</span>), ticks_y), <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb8-463"><a href="#cb8-463" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-464"><a href="#cb8-464" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We plot the behaviour underneath</span></span>
<span id="cb8-465"><a href="#cb8-465" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_2)){</span>
<span id="cb8-466"><a href="#cb8-466" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-467"><a href="#cb8-467" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coordinates_2<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hidden"</span>) {</span>
<span id="cb8-468"><a href="#cb8-468" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-469"><a href="#cb8-469" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"grey50"</span>, <span class="at">border =</span> <span class="st">"grey50"</span>)</span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates_2<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"moving"</span>) {</span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">5</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">5</span>])</span>
<span id="cb8-478"><a href="#cb8-478" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-479"><a href="#cb8-479" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates_2<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"exploring wall"</span>) {</span>
<span id="cb8-480"><a href="#cb8-480" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-481"><a href="#cb8-481" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-482"><a href="#cb8-482" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-483"><a href="#cb8-483" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">4</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">4</span>])</span>
<span id="cb8-484"><a href="#cb8-484" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-485"><a href="#cb8-485" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates_2<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"head-out"</span>) {</span>
<span id="cb8-486"><a href="#cb8-486" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-487"><a href="#cb8-487" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-488"><a href="#cb8-488" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-489"><a href="#cb8-489" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">3</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">3</span>])</span>
<span id="cb8-490"><a href="#cb8-490" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-491"><a href="#cb8-491" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates_2<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"hiding / head-out"</span>) {</span>
<span id="cb8-492"><a href="#cb8-492" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-493"><a href="#cb8-493" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-494"><a href="#cb8-494" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-495"><a href="#cb8-495" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">2</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">2</span>])</span>
<span id="cb8-496"><a href="#cb8-496" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-497"><a href="#cb8-497" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(coordinates_2<span class="sc">$</span>behaviour[i] <span class="sc">==</span> <span class="st">"immobile exposed"</span>) {</span>
<span id="cb8-498"><a href="#cb8-498" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-499"><a href="#cb8-499" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>((i <span class="sc">-</span> <span class="dv">1</span>), (i), (i), (i <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb8-500"><a href="#cb8-500" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.08</span>, <span class="sc">-</span><span class="fl">0.08</span>),</span>
<span id="cb8-501"><a href="#cb8-501" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span>], <span class="at">border =</span> <span class="fu">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span>])</span>
<span id="cb8-502"><a href="#cb8-502" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-503"><a href="#cb8-503" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-504"><a href="#cb8-504" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-505"><a href="#cb8-505" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-506"><a href="#cb8-506" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-507"><a href="#cb8-507" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We plot the speed</span></span>
<span id="cb8-508"><a href="#cb8-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coordinates_2), coordinates_2<span class="sc">$</span>dist_traveled, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb8-509"><a href="#cb8-509" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-510"><a href="#cb8-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb8-511"><a href="#cb8-511" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-512"><a href="#cb8-512" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-513"><a href="#cb8-513" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-514"><a href="#cb8-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-515"><a href="#cb8-515" aria-hidden="true" tabindex="-1"></a><span class="fu">data_visualization</span>(ID, repeatability, time_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/individual%20plots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">density_function</span>(ID, repeatability, time_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/individual%20plots-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_area</span>(ID, repeatability, time_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/individual%20plots-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_hole</span>(ID, repeatability, time_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/individual%20plots-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_behaviour</span>(ID, repeatability, time_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/individual%20plots-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">speed_plot</span>(ID, repeatability, time_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/individual%20plots-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="repeatability" class="level2">
<h2 class="anchored" data-anchor-id="repeatability">3. Repeatability</h2>
<p>In this part we study whether head-out, body-out and visual exploration behaviour are maintained in the same range of values for the same individual, demonstrating a certain repeatability in the experiments and a certain animal personality. In addition, it also allows us to see if there is any trend between different experimental trials depending on the area the snake comes from.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT DONE YET, AS I NEED SEX, SVL, AND CONDITION STATUS FOR 2024 INDIVIDUALS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="survival-analysis-cox-regression" class="level2">
<h2 class="anchored" data-anchor-id="survival-analysis-cox-regression">4. Survival analysis + Cox regression</h2>
<p>Here we performed a survival analysis and a Cox regression to see if there are differences between snakes from the invasion front (<em>FRONT</em>) and those from the initially invaded zone (<em>CORE</em>) for the time it takes for the snakes to get their heads out of the initial refuge for the first time (<em>Head-out</em>) and to get completely out of the initial refuge for the first time (<em>Body-out</em>).</p>
<section id="no-log-transformation" class="level3">
<h3 class="anchored" data-anchor-id="no-log-transformation">4.1. No log-transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We add columns for saying if data is censored (0) or the event has happened within the time frame (1)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep <span class="ot">&lt;-</span> <span class="fu">add_column</span>(summary_tracking_complete_no_rep, <span class="at">Head_out_01 =</span> <span class="cn">NA</span>, <span class="at">.after =</span> <span class="st">"Time_head_out_sec_raw"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep <span class="ot">&lt;-</span> <span class="fu">add_column</span>(summary_tracking_complete_no_rep, <span class="at">Body_out_01 =</span> <span class="cn">NA</span>, <span class="at">.after =</span> <span class="st">"Time_body_out_sec_raw"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 for event (head-out/body-out) and 0 for censored data</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(summary_tracking_complete_no_rep)){</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">==</span> <span class="dv">3000</span>){</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    summary_tracking_complete_no_rep<span class="sc">$</span>Head_out_01[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    summary_tracking_complete_no_rep<span class="sc">$</span>Head_out_01[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">==</span> <span class="dv">3000</span>){</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    summary_tracking_complete_no_rep<span class="sc">$</span>Body_out_01[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    summary_tracking_complete_no_rep<span class="sc">$</span>Body_out_01[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Head-out</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>fit_head_out <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(Time_head_out_sec_raw, Head_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit_head_out,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table.col =</span> <span class="st">"strata"</span>, </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">"hv"</span>,</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">"CORE"</span>, <span class="st">"FRONT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/survival%20analysis-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(Time_head_out_sec_raw, Head_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Time_head_out_sec_raw, Head_out_01) ~ Inv_situation, 
    data = summary_tracking_complete_no_rep)

                     coef exp(coef) se(coef)     z     p
Inv_situationFRONT 0.3264    1.3860   0.3189 1.024 0.306

Likelihood ratio test=1.08  on 1 df, p=0.2984
n= 58, number of events= 45 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Body-out</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fit_body_out <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(Time_body_out_sec_raw, Body_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit_body_out,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table.col =</span> <span class="st">"strata"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">"hv"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">"CORE"</span>, <span class="st">"FRONT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/survival%20analysis-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(Time_body_out_sec_raw, Body_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Time_body_out_sec_raw, Body_out_01) ~ Inv_situation, 
    data = summary_tracking_complete_no_rep)

                     coef exp(coef) se(coef)     z     p
Inv_situationFRONT 0.2578    1.2940   0.3216 0.802 0.423

Likelihood ratio test=0.66  on 1 df, p=0.4172
n= 58, number of events= 44 </code></pre>
</div>
</div>
</section>
<section id="log-transformation" class="level3">
<h3 class="anchored" data-anchor-id="log-transformation">4.2. Log-transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Head-out</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fit_head_out <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(<span class="fu">log</span>(Time_head_out_sec_raw), Head_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit_head_out,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table.col =</span> <span class="st">"strata"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">"hv"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">"CORE"</span>, <span class="st">"FRONT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = 0, y = max(y2), xend = max(x1), yend = max(y2)), : All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?
All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?
All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?
All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20survival%20analysis-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(<span class="fu">log</span>(Time_head_out_sec_raw), Head_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(log(Time_head_out_sec_raw), Head_out_01) ~ 
    Inv_situation, data = summary_tracking_complete_no_rep)

                     coef exp(coef) se(coef)     z     p
Inv_situationFRONT 0.3264    1.3860   0.3189 1.024 0.306

Likelihood ratio test=1.08  on 1 df, p=0.2984
n= 58, number of events= 45 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Body-out</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fit_body_out <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(<span class="fu">log</span>(Time_body_out_sec_raw), Body_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit_body_out,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table.col =</span> <span class="st">"strata"</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">"hv"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">"CORE"</span>, <span class="st">"FRONT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = 0, y = max(y2), xend = max(x1), yend = max(y2)), : All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?
All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?
All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?
All aesthetics have length 1, but the data has 2 rows.
ℹ Did you mean to use `annotate()`?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20survival%20analysis-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(<span class="fu">log</span>(Time_body_out_sec_raw), Body_out_01) <span class="sc">~</span> Inv_situation, <span class="at">data =</span> summary_tracking_complete_no_rep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(log(Time_body_out_sec_raw), Body_out_01) ~ 
    Inv_situation, data = summary_tracking_complete_no_rep)

                     coef exp(coef) se(coef)     z     p
Inv_situationFRONT 0.2578    1.2940   0.3216 0.802 0.423

Likelihood ratio test=0.66  on 1 df, p=0.4172
n= 58, number of events= 44 </code></pre>
</div>
</div>
</section>
</section>
<section id="censored-data-regressions" class="level2">
<h2 class="anchored" data-anchor-id="censored-data-regressions">5. Censored data regressions</h2>
<p>In this section, we will use a method for estimating linear regressions with censored data. For the moment, I am including gravid females, but they can be removed.</p>
<section id="head-out" class="level3">
<h3 class="anchored" data-anchor-id="head-out">5.1. Head-out</h3>
<section id="no-log-transformation-1" class="level4">
<h4 class="anchored" data-anchor-id="no-log-transformation-1">5.1.1. No log-transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We create a data frame for only the "OLS detect" linear regression</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep_detect <span class="ot">&lt;-</span> summary_tracking_complete_no_rep[</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw <span class="sc">&lt;</span> <span class="dv">3000</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Invasion year</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Time_head_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> (<span class="dv">3000</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Time_head_out_sec_raw) ~ Year_invasion, left = -Inf, 
    right = (3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             45             13 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)    8.818e+04  1.558e+05   0.566   0.571    
Year_invasion -4.290e+01  7.713e+01  -0.556   0.578    
logSigma       7.151e+00  1.132e-01  63.168  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 8 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -400.2705 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_head_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_head_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-1369.4  -932.2  -284.5   818.1  1794.6 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    88169.46  121776.85   0.724    0.472
Year_invasion    -42.97      60.30  -0.713    0.479

Residual standard error: 1035 on 56 degrees of freedom
Multiple R-squared:  0.008987,  Adjusted R-squared:  -0.008709 
F-statistic: 0.5079 on 1 and 56 DF,  p-value: 0.479</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time_head_out_sec_raw <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time_head_out_sec_raw ~ Year_invasion, data = summary_tracking_complete_no_rep_detect)

Residuals:
   Min     1Q Median     3Q    Max 
-850.0 -538.7 -121.0  313.2 1449.6 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -44861.35   90529.86  -0.496    0.623
Year_invasion     22.67      44.82   0.506    0.616

Residual standard error: 626.3 on 43 degrees of freedom
Multiple R-squared:  0.005912,  Adjusted R-squared:  -0.01721 
F-statistic: 0.2557 on 1 and 43 DF,  p-value: 0.6156</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion, (summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">'Head-out vs. Invasion year'</span>, <span class="at">xlab =</span> <span class="st">"Invasion year"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20head%20out-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Distance to Noah's garden</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Time_head_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> (<span class="dv">3000</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Time_head_out_sec_raw) ~ Distance_Noahs, left = -Inf, 
    right = (3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             45             13 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)    1.384e+03  6.164e+02   2.245  0.0248 *  
Distance_Noahs 1.517e-02  6.178e-02   0.246  0.8060    
logSigma       7.155e+00  1.133e-01  63.169  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 9 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -400.5542 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_head_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_head_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-1239.4  -876.0  -350.5   894.1  1724.5 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    1.245e+03  4.898e+02   2.542   0.0138 *
Distance_Noahs 1.474e-02  4.912e-02   0.300   0.7652  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1039 on 56 degrees of freedom
Multiple R-squared:  0.001606,  Adjusted R-squared:  -0.01622 
F-statistic: 0.09007 on 1 and 56 DF,  p-value: 0.7652</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time_head_out_sec_raw <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time_head_out_sec_raw ~ Distance_Noahs, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-759.14 -516.14  -91.92  354.28 1450.73 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    731.77134  334.23082   2.189    0.034 *
Distance_Noahs   0.01968    0.03350   0.587    0.560  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 625.6 on 43 degrees of freedom
Multiple R-squared:  0.007959,  Adjusted R-squared:  -0.01511 
F-statistic: 0.345 on 1 and 43 DF,  p-value: 0.56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs, (summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Head-out vs. Distance to Noah's garden"</span>, <span class="at">xlab =</span> <span class="st">"Distance to Noah's garden (m)"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20head%20out-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Condition</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Time_head_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> (<span class="dv">3000</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Time_head_out_sec_raw) ~ Condition, left = -Inf, 
    right = (3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             45             13 

Coefficients:
             Estimate Std. error t value Pr(&gt; t)    
(Intercept)  231.5033  1513.8199   0.153   0.878    
Condition   1261.2396  1464.5722   0.861   0.389    
logSigma       7.1510     0.1132  63.160  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 25 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -400.2079 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_head_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_head_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-1262.6  -881.4  -312.8   909.0  1780.2 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    549.4     1164.8   0.472    0.639
Condition      812.7     1123.2   0.724    0.472

Residual standard error: 1035 on 56 degrees of freedom
Multiple R-squared:  0.009263,  Adjusted R-squared:  -0.008429 
F-statistic: 0.5236 on 1 and 56 DF,  p-value: 0.4723</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time_head_out_sec_raw <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time_head_out_sec_raw ~ Condition, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-822.84 -514.02  -70.43  390.17 1406.96 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1497.2     1008.2   1.485    0.145
Condition     -565.5      984.0  -0.575    0.568

Residual standard error: 625.7 on 43 degrees of freedom
Multiple R-squared:  0.007624,  Adjusted R-squared:  -0.01545 
F-statistic: 0.3304 on 1 and 43 DF,  p-value: 0.5684</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Condition, (summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Head-out vs. Condition"</span>, <span class="at">xlab =</span> <span class="st">"Condition"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20head%20out-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="log-transformation-1" class="level4">
<h4 class="anchored" data-anchor-id="log-transformation-1">5.1.2. Log-transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> <span class="fu">log</span>(<span class="dv">3000</span>))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = log(Time_head_out_sec_raw) ~ Year_invasion, 
    left = -Inf, right = log(3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             45             13 

Coefficients:
              Estimate Std. error t value Pr(&gt; t)
(Intercept)   78.36739        Inf       0       1
Year_invasion -0.03532        Inf       0       1
logSigma       0.10930        Inf       0       1

Newton-Raphson maximisation, 4 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -82.10584 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_head_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.20876 -0.67712  0.07351  0.81289  1.18276 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    38.47015  107.84287   0.357    0.723
Year_invasion  -0.01564    0.05340  -0.293    0.771

Residual standard error: 0.917 on 56 degrees of freedom
Multiple R-squared:  0.001529,  Adjusted R-squared:  -0.0163 
F-statistic: 0.08576 on 1 and 56 DF,  p-value: 0.7707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_head_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9695 -0.6354  0.1074  0.5033  1.2747 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -68.15967  112.39334  -0.606    0.547
Year_invasion   0.03700    0.05564   0.665    0.510

Residual standard error: 0.7775 on 43 degrees of freedom
Multiple R-squared:  0.01018,   Adjusted R-squared:  -0.01284 
F-statistic: 0.442 on 1 and 43 DF,  p-value: 0.5097</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion, <span class="fu">log</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Head-out) vs. Invasion year"</span>, <span class="at">xlab =</span> <span class="st">"Invasion year"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20head%20out-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Distance to Noah's garden</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> <span class="fu">log</span>(<span class="dv">3000</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = log(Time_head_out_sec_raw) ~ Distance_Noahs, 
    left = -Inf, right = log(3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             45             13 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)    6.657e+00  5.350e-01  12.443  &lt;2e-16 ***
Distance_Noahs 3.851e-05  5.364e-05   0.718   0.473    
logSigma       1.038e-01  1.119e-01   0.927   0.354    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 4 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -81.98694 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_head_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.13031 -0.68987  0.03492  0.90230  1.39474 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    6.536e+00  4.297e-01  15.210   &lt;2e-16 ***
Distance_Noahs 3.692e-05  4.309e-05   0.857    0.395    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9118 on 56 degrees of freedom
Multiple R-squared:  0.01294,   Adjusted R-squared:  -0.004689 
F-statistic: 0.734 on 1 and 56 DF,  p-value: 0.3953</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_head_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7762 -0.5779  0.1303  0.5580  1.3576 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    6.108e+00  4.111e-01  14.857   &lt;2e-16 ***
Distance_Noahs 4.792e-05  4.121e-05   1.163    0.251    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7695 on 43 degrees of freedom
Multiple R-squared:  0.03049,   Adjusted R-squared:  0.007939 
F-statistic: 1.352 on 1 and 43 DF,  p-value: 0.2513</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs, <span class="fu">log</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Head-out) vs. Distance to Noah's garden"</span>, <span class="at">xlab =</span> <span class="st">"Distance to Noah's garden (m)"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20head%20out-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Condition</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> <span class="fu">log</span>(<span class="dv">3000</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = log(Time_head_out_sec_raw) ~ Condition, left = -Inf, 
    right = log(3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             45             13 

Coefficients:
            Estimate Std. error t value  Pr(&gt; t)    
(Intercept)   5.9034     1.3325   4.430 9.41e-06 ***
Condition     1.0926     1.2899   0.847    0.397    
logSigma      0.1057     0.1118   0.945    0.345    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 4 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -81.88201 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_head_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.22055 -0.60349  0.08833  0.87373  1.24953 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   6.2232     1.0286   6.050 1.26e-07 ***
Condition     0.6469     0.9918   0.652    0.517    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9142 on 56 degrees of freedom
Multiple R-squared:  0.00754,   Adjusted R-squared:  -0.01018 
F-statistic: 0.4254 on 1 and 56 DF,  p-value: 0.5169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_head_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_head_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9158 -0.6671  0.1604  0.6119  1.1849 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   6.7853     1.2587   5.391 2.79e-06 ***
Condition    -0.2141     1.2285  -0.174    0.862    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7812 on 43 degrees of freedom
Multiple R-squared:  0.0007062, Adjusted R-squared:  -0.02253 
F-statistic: 0.03039 on 1 and 43 DF,  p-value: 0.8624</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Condition, <span class="fu">log</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Head-out) vs. Condition"</span>, <span class="at">xlab =</span> <span class="st">"Condition"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20head%20out-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="body-out" class="level3">
<h3 class="anchored" data-anchor-id="body-out">5.2. Body-out</h3>
<section id="no-log-transformation-2" class="level4">
<h4 class="anchored" data-anchor-id="no-log-transformation-2">5.2.1. No log-transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Invasion year</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Time_body_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> (<span class="dv">3000</span>))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Time_body_out_sec_raw) ~ Year_invasion, left = -Inf, 
    right = (3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             44             14 

Coefficients:
               Estimate Std. error t value Pr(&gt; t)
(Intercept)   25942.530        Inf       0       1
Year_invasion   -11.951        Inf       0       1
logSigma          7.098        Inf       0       1

Newton-Raphson maximisation, 9 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -389.7635 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_body_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_body_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-1458.0  -808.2  -171.7  1104.2  1399.1 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    25935.12  113733.19   0.228    0.820
Year_invasion    -12.02      56.31  -0.214    0.832

Residual standard error: 967.1 on 56 degrees of freedom
Multiple R-squared:  0.0008134, Adjusted R-squared:  -0.01703 
F-statistic: 0.04559 on 1 and 56 DF,  p-value: 0.8317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_body_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_body_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-1173.2  -471.8  -145.7   499.6  1645.0 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -109873.66  101884.04  -1.078    0.287
Year_invasion      55.02      50.44   1.091    0.281

Residual standard error: 704.8 on 43 degrees of freedom
Multiple R-squared:  0.02693,   Adjusted R-squared:  0.004296 
F-statistic:  1.19 on 1 and 43 DF,  p-value: 0.2814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion, (summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Body-out vs. Invasion year"</span>, <span class="at">xlab =</span> <span class="st">"Invasion year"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20body%20out-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Distance to Noah's garden</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Time_body_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> (<span class="dv">3000</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Time_body_out_sec_raw) ~ Distance_Noahs, left = -Inf, 
    right = (3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             44             14 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)    1.315e+03  5.798e+02   2.268  0.0233 *  
Distance_Noahs 5.117e-02  5.829e-02   0.878  0.3801    
logSigma       7.091e+00  1.146e-01  61.871  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 9 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -389.4294 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_body_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_body_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-1357.8  -860.0  -274.4  1097.5  1667.4 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    1.246e+03  4.525e+02   2.753  0.00794 **
Distance_Noahs 4.238e-02  4.537e-02   0.934  0.35427   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 960 on 56 degrees of freedom
Multiple R-squared:  0.01534,   Adjusted R-squared:  -0.002242 
F-statistic: 0.8725 on 1 and 56 DF,  p-value: 0.3543</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_body_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_body_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep_detect)

Residuals:
   Min     1Q Median     3Q    Max 
-932.0 -517.2 -124.1  407.6 1540.8 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    734.73398  372.41373   1.973    0.055 .
Distance_Noahs   0.05504    0.03733   1.474    0.148  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 697.1 on 43 degrees of freedom
Multiple R-squared:  0.04812,   Adjusted R-squared:  0.02599 
F-statistic: 2.174 on 1 and 43 DF,  p-value: 0.1477</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs, (summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Body-out vs. Distance to Noah's garden"</span>, <span class="at">xlab =</span> <span class="st">"Distance to Noah's garden (m)"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20body%20out-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Condition</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Time_body_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> (<span class="dv">3000</span>))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Time_body_out_sec_raw) ~ Condition, left = -Inf, 
    right = (3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             44             14 

Coefficients:
             Estimate Std. error t value Pr(&gt; t)    
(Intercept)  648.7971  1439.3332   0.451   0.652    
Condition   1124.0041  1392.1422   0.807   0.419    
logSigma       7.0935     0.1146  61.912  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 23 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -389.4813 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_body_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_body_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-1460.9  -796.8  -183.3  1042.6  1504.7 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    866.9     1083.3   0.800    0.427
Condition      761.8     1044.6   0.729    0.469

Residual standard error: 962.9 on 56 degrees of freedom
Multiple R-squared:  0.009408,  Adjusted R-squared:  -0.008281 
F-statistic: 0.5319 on 1 and 56 DF,  p-value: 0.4689</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>((Time_body_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Time_body_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-1093.0  -504.3  -118.5   409.4  1705.7 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1567.0     1150.2   1.362    0.180
Condition     -298.9     1122.6  -0.266    0.791

Residual standard error: 713.9 on 43 degrees of freedom
Multiple R-squared:  0.001646,  Adjusted R-squared:  -0.02157 
F-statistic: 0.0709 on 1 and 43 DF,  p-value: 0.7913</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Condition, (summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Body-out vs. Condition"</span>, <span class="at">xlab =</span> <span class="st">"Condition"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20body%20out-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="log-transformation-2" class="level4">
<h4 class="anchored" data-anchor-id="log-transformation-2">5.2.2. Log-transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> <span class="fu">log</span>(<span class="dv">3000</span>))</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = log(Time_body_out_sec_raw) ~ Year_invasion, 
    left = -Inf, right = log(3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             44             14 

Coefficients:
               Estimate Std. error t value Pr(&gt; t)
(Intercept)   20.761570        Inf       0       1
Year_invasion -0.006655        Inf       0       1
logSigma      -0.122283        Inf       0       1

Newton-Raphson maximisation, 5 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -70.96592 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_body_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0539 -0.4865  0.0825  0.7078  0.8299 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -2.477176  84.184041  -0.029    0.977
Year_invasion  0.004791   0.041682   0.115    0.909

Residual standard error: 0.7158 on 56 degrees of freedom
Multiple R-squared:  0.0002359, Adjusted R-squared:  -0.01762 
F-statistic: 0.01321 on 1 and 56 DF,  p-value: 0.9089</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_body_out_sec_raw) ~ Year_invasion, data = summary_tracking_complete_no_rep_detect)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.89061 -0.32730  0.04786  0.46298  0.97366 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -96.15692   91.61523  -1.050    0.300
Year_invasion   0.05105    0.04536   1.126    0.267

Residual standard error: 0.6338 on 43 degrees of freedom
Multiple R-squared:  0.02862,   Adjusted R-squared:  0.006031 
F-statistic: 1.267 on 1 and 43 DF,  p-value: 0.2666</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion, <span class="fu">log</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Body-out) vs. Invasion year"</span>, <span class="at">xlab =</span> <span class="st">"Invasion year"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20body%20out-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Distance to Noah's garden</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> <span class="fu">log</span>(<span class="dv">3000</span>))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = log(Time_body_out_sec_raw) ~ Distance_Noahs, 
    left = -Inf, right = log(3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             44             14 

Coefficients:
                 Estimate Std. error t value Pr(&gt; t)    
(Intercept)     6.776e+00  4.198e-01  16.140  &lt;2e-16 ***
Distance_Noahs  5.682e-05  4.225e-05   1.345   0.179    
logSigma       -1.421e-01  1.133e-01  -1.255   0.210    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-likelihood: -70.08435 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_body_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.90688 -0.52220  0.00587  0.70238  1.17402 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    6.732e+00  3.311e-01  20.333   &lt;2e-16 ***
Distance_Noahs 4.871e-05  3.320e-05   1.467    0.148    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7025 on 56 degrees of freedom
Multiple R-squared:  0.03702,   Adjusted R-squared:  0.01982 
F-statistic: 2.153 on 1 and 56 DF,  p-value: 0.1479</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_body_out_sec_raw) ~ Distance_Noahs, data = summary_tracking_complete_no_rep_detect)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.63298 -0.35166  0.05759  0.33744  1.16705 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    6.363e+00  3.299e-01  19.286   &lt;2e-16 ***
Distance_Noahs 6.292e-05  3.307e-05   1.902   0.0638 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6176 on 43 degrees of freedom
Multiple R-squared:  0.07764,   Adjusted R-squared:  0.05619 
F-statistic: 3.619 on 1 and 43 DF,  p-value: 0.06382</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs, <span class="fu">log</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Body-out) vs. Distance to Noah's garden"</span>, <span class="at">xlab =</span> <span class="st">"Distance to Noah's garden (m)"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20body%20out-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Condition</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">right =</span> <span class="fu">log</span>(<span class="dv">3000</span>))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = log(Time_body_out_sec_raw) ~ Condition, left = -Inf, 
    right = log(3000), data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58              0             44             14 

Coefficients:
            Estimate Std. error t value  Pr(&gt; t)    
(Intercept)   6.3768     1.0609   6.011 1.85e-09 ***
Condition     0.9178     1.0267   0.894    0.371    
logSigma     -0.1290     0.1132  -1.139    0.255    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -70.57256 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_body_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.03164 -0.44516  0.09028  0.63308  0.93207 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   6.5726     0.8010   8.205 3.56e-11 ***
Condition     0.6082     0.7724   0.787    0.434    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.712 on 56 degrees of freedom
Multiple R-squared:  0.01095,   Adjusted R-squared:  -0.006711 
F-statistic:  0.62 on 1 and 56 DF,  p-value: 0.4344</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Time_body_out_sec_raw) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Time_body_out_sec_raw) ~ Condition, data = summary_tracking_complete_no_rep_detect)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.81063 -0.33140  0.04695  0.48601  1.05574 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   6.8224     1.0358   6.586 5.12e-08 ***
Condition     0.1406     1.0110   0.139     0.89    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6429 on 43 degrees of freedom
Multiple R-squared:  0.0004493, Adjusted R-squared:  -0.0228 
F-statistic: 0.01933 on 1 and 43 DF,  p-value: 0.8901</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Condition, <span class="fu">log</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Body-out) vs. Condition"</span>, <span class="at">xlab =</span> <span class="st">"Condition"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20body%20out-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="visual-exploration" class="level3">
<h3 class="anchored" data-anchor-id="visual-exploration">5.3. Visual exploration</h3>
<section id="no-log-transformation-3" class="level4">
<h4 class="anchored" data-anchor-id="no-log-transformation-3">5.3.1. No log-transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create filtered data frame for this part of the analysis</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep_detect <span class="ot">&lt;-</span> summary_tracking_complete_no_rep[summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Invasion year</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Visual_exp) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="cn">Inf</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Visual_exp) ~ Year_invasion, left = 0, right = Inf, 
    data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58             13             45              0 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)   -6.391e+04  3.616e+04  -1.768  0.0771 .  
Year_invasion  3.176e+01  1.790e+01   1.774  0.0761 .  
logSigma       5.682e+00  1.108e-01  51.260  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 150 iterations
Return code 4: Iteration limit exceeded (iterlim)
Log-likelihood: -332.0988 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Visual_exp) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Visual_exp) ~ Year_invasion, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-395.54 -152.15  -65.72  158.50  813.27 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -62234.34   28732.06  -2.166   0.0346 *
Year_invasion     30.95      14.23   2.175   0.0338 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 244.3 on 56 degrees of freedom
Multiple R-squared:  0.07791,   Adjusted R-squared:  0.06145 
F-statistic: 4.732 on 1 and 56 DF,  p-value: 0.03385</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Visual_exp <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Visual_exp ~ Year_invasion, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-358.38 -185.38   -8.64  134.04  741.24 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -65012.31   33013.23  -1.969   0.0554 .
Year_invasion     32.36      16.34   1.980   0.0542 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 228.4 on 43 degrees of freedom
Multiple R-squared:  0.08353,   Adjusted R-squared:  0.06221 
F-statistic: 3.919 on 1 and 43 DF,  p-value: 0.05417</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS *"</span>,</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion, (summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Visual exploration vs. Invasion year"</span>, <span class="at">xlab =</span> <span class="st">"Invasion year"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20visual-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Distance to Noah's garden</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Visual_exp) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="cn">Inf</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Visual_exp) ~ Distance_Noahs, left = 0, right = Inf, 
    data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58             13             45              0 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)    -53.64557  142.81219  -0.376  0.7072    
Distance_Noahs   0.02933    0.01427   2.055  0.0399 *  
logSigma         5.67778    0.11122  51.050  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 10 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -332.2782 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Visual_exp) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Visual_exp) ~ Distance_Noahs, data = summary_tracking_complete_no_rep)

Residuals:
   Min     1Q Median     3Q    Max 
-407.4 -161.0  -66.5  173.3  783.1 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)      0.42409  114.11273   0.004    0.997  
Distance_Noahs   0.02764    0.01144   2.415    0.019 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 242.1 on 56 degrees of freedom
Multiple R-squared:  0.09435,   Adjusted R-squared:  0.07818 
F-statistic: 5.834 on 1 and 56 DF,  p-value: 0.01901</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Visual_exp <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Visual_exp ~ Distance_Noahs, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-305.46 -173.18  -45.79  138.87  689.94 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)      2.96263  115.53551   0.026  0.97966   
Distance_Noahs   0.03536    0.01158   3.053  0.00387 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 216.3 on 43 degrees of freedom
Multiple R-squared:  0.1782,    Adjusted R-squared:  0.1591 
F-statistic: 9.324 on 1 and 43 DF,  p-value: 0.003872</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored *"</span>,</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS *"</span>,</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects *"</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs, (summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Visual exploration vs. Distance to Noah's garden"</span>, <span class="at">xlab =</span> <span class="st">"Distance to Noah's garden (m)"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20visual-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Condition</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Visual_exp) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="cn">Inf</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Visual_exp) ~ Condition, left = 0, right = Inf, 
    data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58             13             45              0 

Coefficients:
             Estimate Std. error t value Pr(&gt; t)    
(Intercept)  394.0729   369.0533   1.068   0.286    
Condition   -164.4492   357.1482  -0.460   0.645    
logSigma       5.7267     0.1111  51.557  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 7 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -334.1932 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Visual_exp) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Visual_exp) ~ Condition, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-275.57 -192.58  -62.73  148.97  836.58 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   317.54     286.16   1.110    0.272
Condition     -50.88     275.92  -0.184    0.854

Residual standard error: 254.3 on 56 degrees of freedom
Multiple R-squared:  0.0006068, Adjusted R-squared:  -0.01724 
F-statistic: 0.034 on 1 and 56 DF,  p-value: 0.8544</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Visual_exp <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Visual_exp ~ Condition, data = summary_tracking_complete_no_rep_detect)

Residuals:
   Min     1Q Median     3Q    Max 
-303.2 -167.9  -92.4  150.8  796.6 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    69.73     382.09   0.182    0.856
Condition     266.62     372.93   0.715    0.479

Residual standard error: 237.2 on 43 degrees of freedom
Multiple R-squared:  0.01175,   Adjusted R-squared:  -0.01124 
F-statistic: 0.5111 on 1 and 43 DF,  p-value: 0.4785</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Condition, (summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"Visual exploration vs. Condition"</span>, <span class="at">xlab =</span> <span class="st">"Condition"</span>, <span class="at">ylab =</span> <span class="st">"Time (s)"</span>)</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/censored%20visual-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="log-transformation-3" class="level4">
<h4 class="anchored" data-anchor-id="log-transformation-3">5.3.2. Log-transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log variable</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp_log <span class="ot">&lt;-</span> <span class="fu">log1p</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the same variable for the only detection data frame</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>summary_tracking_complete_no_rep_detect<span class="sc">$</span>Visual_exp_log <span class="ot">&lt;-</span> <span class="fu">log1p</span>(summary_tracking_complete_no_rep_detect<span class="sc">$</span>Visual_exp)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Invasion year</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Visual_exp_log) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="cn">Inf</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Visual_exp_log) ~ Year_invasion, left = 0, 
    right = Inf, data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58             13             45              0 

Coefficients:
               Estimate Std. error t value Pr(&gt; t)
(Intercept)   -535.0485        Inf       0       1
Year_invasion    0.2669        Inf       0       1
logSigma         1.0955        Inf       0       1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -128.4781 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Visual_exp_log) <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Visual_exp_log) ~ Year_invasion, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2430 -0.3235  0.9103  1.6779  2.4674 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -425.9525   283.5917  -1.502    0.139
Year_invasion    0.2131     0.1404   1.517    0.135

Residual standard error: 2.411 on 56 degrees of freedom
Multiple R-squared:  0.03949,   Adjusted R-squared:  0.02234 
F-statistic: 2.302 on 1 and 56 DF,  p-value: 0.1348</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Visual_exp_log <span class="sc">~</span> Year_invasion, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Visual_exp_log ~ Year_invasion, data = summary_tracking_complete_no_rep_detect)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6405 -0.5278  0.1455  0.5285  1.3441 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -168.11211  101.53885  -1.656   0.1051  
Year_invasion    0.08600    0.05027   1.711   0.0943 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7024 on 43 degrees of freedom
Multiple R-squared:  0.06373,   Adjusted R-squared:  0.04195 
F-statistic: 2.927 on 1 and 43 DF,  p-value: 0.09432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion, (summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp_log), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Visual exploration) vs. Invasion year"</span>, <span class="at">xlab =</span> <span class="st">"Invasion year"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20visual-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Distance to Noah's garden</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Visual_exp_log) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="cn">Inf</span>)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Visual_exp_log) ~ Distance_Noahs, left = 0, 
    right = Inf, data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58             13             45              0 

Coefficients:
                Estimate Std. error t value Pr(&gt; t)    
(Intercept)    3.243e+00  1.464e+00   2.216  0.0267 *  
Distance_Noahs 8.187e-05  1.466e-04   0.558  0.5765    
logSigma       1.112e+00  1.141e-01   9.749  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -129.4116 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Visual_exp_log) <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Visual_exp_log) ~ Distance_Noahs, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.7488  0.1210  0.9613  1.6904  2.4965 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    3.594e+00  1.155e+00   3.112  0.00292 **
Distance_Noahs 7.841e-05  1.158e-04   0.677  0.50117   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.45 on 56 degrees of freedom
Multiple R-squared:  0.008119,  Adjusted R-squared:  -0.009593 
F-statistic: 0.4584 on 1 and 56 DF,  p-value: 0.5012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Visual_exp_log <span class="sc">~</span> Distance_Noahs, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Visual_exp_log ~ Distance_Noahs, data = summary_tracking_complete_no_rep_detect)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.50353 -0.50496  0.06429  0.59334  1.19772 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.656e+00  3.576e-01  13.019  &lt; 2e-16 ***
Distance_Noahs 9.864e-05  3.585e-05   2.752  0.00864 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6694 on 43 degrees of freedom
Multiple R-squared:  0.1497,    Adjusted R-squared:   0.13 
F-statistic: 7.573 on 1 and 43 DF,  p-value: 0.008641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects *"</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs, (summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp_log), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Visual exploration) vs. Distance to Noah's garden"</span>, <span class="at">xlab =</span> <span class="st">"Distance to Noah's garden (m)"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20visual-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~ Condition</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Censored regression</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>fit.cen <span class="ot">&lt;-</span> <span class="fu">censReg</span>((Visual_exp_log) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="cn">Inf</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.cen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = (Visual_exp_log) ~ Condition, left = 0, right = Inf, 
    data = summary_tracking_complete_no_rep)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            58             13             45              0 

Coefficients:
            Estimate Std. error t value Pr(&gt; t)    
(Intercept)    7.513      3.581   2.098  0.0359 *  
Condition     -3.389      3.464  -0.978  0.3279    
logSigma       1.109      0.114   9.724  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -129.0874 on 3 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a line using OLS regression (linear regression)</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>fit.OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>((Visual_exp_log) <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (Visual_exp_log) ~ Condition, data = summary_tracking_complete_no_rep)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8266 -0.1166  1.0351  1.6610  2.4438 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    6.763      2.749   2.460    0.017 *
Condition     -2.347      2.651  -0.885    0.380  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.443 on 56 degrees of freedom
Multiple R-squared:  0.01381,   Adjusted R-squared:  -0.003804 
F-statistic: 0.784 on 1 and 56 DF,  p-value: 0.3797</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression only of non-censored data</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>fit.detect <span class="ot">&lt;-</span> <span class="fu">lm</span>(Visual_exp_log <span class="sc">~</span> Condition, <span class="at">data =</span> summary_tracking_complete_no_rep_detect)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.detect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Visual_exp_log ~ Condition, data = summary_tracking_complete_no_rep_detect)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.53989 -0.48239 -0.08419  0.57648  1.54593 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.387      1.155   3.799 0.000452 ***
Condition      1.190      1.127   1.056 0.296911    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7167 on 43 degrees of freedom
Multiple R-squared:  0.02527,   Adjusted R-squared:  0.002605 
F-statistic: 1.115 on 1 and 43 DF,  p-value: 0.2969</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.cen)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.OLS), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(fit.detect), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"topleft"</span>,</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Censored"</span>,</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS"</span>,</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"OLS Detects"</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">par</span>(<span class="st">"cex"</span>),</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>),</span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.font =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">y.intersp =</span> <span class="fl">1.3</span></span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Condition, (summary_tracking_complete_no_rep<span class="sc">$</span>Visual_exp_log), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">'grey60'</span>, <span class="at">main =</span> <span class="st">"log(Visual exploration) vs. Condition"</span>, <span class="at">xlab =</span> <span class="st">"Condition"</span>, <span class="at">ylab =</span> <span class="st">"log(Time (s))"</span>)</span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/log%20censored%20visual-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="permanova-betadisper" class="level2">
<h2 class="anchored" data-anchor-id="permanova-betadisper">6. PERMANOVA + betadisper</h2>
<p>This section analyses whether there are differences in the behaviour and use of the snake area. The analyses contain gravid females, but they can be removed if necessary.</p>
<section id="correlation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="correlation-analysis">6.1. Correlation analysis</h3>
<p>First we are going to carry out a correlation test between variables to see if we can omit some of them when carrying out the analyses, as they could be highly correlated with each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select environmental variables</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>variables_lm <span class="ot">&lt;-</span> summary_tracking_complete_no_rep[, <span class="fu">c</span>(<span class="st">"Distance_Noahs"</span>, <span class="st">"Year_invasion"</span>, <span class="st">"SVL"</span>, <span class="st">"Condition"</span>, <span class="st">"Temperature"</span>, <span class="st">"R_H"</span>)]</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform SVL to log</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>variables_lm<span class="sc">$</span>SVL <span class="ot">&lt;-</span> <span class="fu">log</span>(variables_lm<span class="sc">$</span>SVL)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation results</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(variables_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Distance_Noahs Year_invasion         SVL   Condition Temperature
Distance_Noahs     1.00000000    0.60296767 -0.05239930  0.03031377   0.1617957
Year_invasion      0.60296767    1.00000000 -0.03211695  0.10203083   0.3760371
SVL               -0.05239930   -0.03211695  1.00000000  0.89446469   0.1120937
Condition          0.03031377    0.10203083  0.89446469  1.00000000   0.1712075
Temperature        0.16179573    0.37603711  0.11209374  0.17120754   1.0000000
R_H               -0.19047385   -0.32869555 -0.10046571 -0.17266226  -0.8448673
                      R_H
Distance_Noahs -0.1904739
Year_invasion  -0.3286956
SVL            -0.1004657
Condition      -0.1726623
Temperature    -0.8448673
R_H             1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation plot</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(variables_lm), <span class="at">method=</span><span class="st">"color"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/correlation-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distance to Noah’s garden and year of invasion are highly correlated with each other, as are SVL and condition, or relative humidity and temperature. For the analyses to come, we will use only one of each pair of these correlations to perform the analyses (distance to Noah’s garden, SVL, and temperature), along with the sex variable.</p>
</section>
<section id="behaviour-analysis" class="level3">
<h3 class="anchored" data-anchor-id="behaviour-analysis">6.2. Behaviour analysis</h3>
<p>In this section we are going to analyse whether for a given study time (15 min, for example), we observe differences in the type of behaviours expressed by the snakes, depending on different variables (PERMANOVA), and whether the variability of these behaviours is greater or lesser in certain groups (betadisper).</p>
<section id="stacked-behaviour-plot" class="level4">
<h4 class="anchored" data-anchor-id="stacked-behaviour-plot">6.2.1. Stacked behaviour plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete duplications from the array</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># No repeatability filter</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicate data frame</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>Snake_array_dupl <span class="ot">&lt;-</span> Snake_array</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co"># No repeatability filter</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>snake_id <span class="ot">&lt;-</span> <span class="fu">names</span>(Snake_array[<span class="dv">1</span>,<span class="dv">1</span>,])</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>dupl_positions <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>)</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify duplicated positions</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(snake_id)){</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">duplicated</span>(snake_id)[i] <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>    dupl_positions[a] <span class="ot">&lt;-</span> i</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> a <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Final data frame without duplicates (repeatability)</span></span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a>Snake_array_dupl <span class="ot">&lt;-</span> Snake_array_dupl[, , <span class="sc">-</span>dupl_positions]</span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a><span class="co"># How much time do we want to analyse</span></span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>study_time <span class="ot">&lt;-</span> <span class="dv">900</span></span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>behaviour_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">15</span>, <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">names</span>(Snake_array_dupl[<span class="dv">1</span>,<span class="dv">1</span>,]))))</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Column names</span></span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(behaviour_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"headout_bf_bodyout"</span>, <span class="st">"headout_after_bodyout"</span>, <span class="st">"exploring_arena"</span>, <span class="st">"exploring_wall"</span>, <span class="st">"immobile_exposed"</span>, <span class="st">"hiding"</span>, <span class="st">"hiding_corner"</span>, <span class="st">"year"</span>, <span class="st">"distance"</span>, <span class="st">"Sex"</span>, <span class="st">"SVL"</span>, <span class="st">"treatment"</span>, <span class="st">"n_eggs"</span>, <span class="st">"temperature"</span>)</span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a><span class="co"># For all individuals</span></span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(Snake_array_dupl[<span class="dv">1</span>,<span class="dv">1</span>,]))){</span>
<span id="cb158-44"><a href="#cb158-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-45"><a href="#cb158-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the individual put its head out of the initial refuge 15 min (study time) before the time ended:</span></span>
<span id="cb158-46"><a href="#cb158-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time <span class="sc">&lt;=</span> <span class="dv">3000</span>){</span>
<span id="cb158-47"><a href="#cb158-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-48"><a href="#cb158-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ID individual</span></span>
<span id="cb158-49"><a href="#cb158-49" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>Snake_ID[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Snake_ID[i]</span>
<span id="cb158-50"><a href="#cb158-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-51"><a href="#cb158-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How much time did the snake use doing head-out behaviour(visual exploration) before exiting the initial refuge for the first time</span></span>
<span id="cb158-52"><a href="#cb158-52" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>headout_bf_bodyout[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">min</span>((summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time), summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i]), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"head-out"</span>)</span>
<span id="cb158-53"><a href="#cb158-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-54"><a href="#cb158-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How much time did the snake do head-out in the rest of refuges after exiting for the first time the initial refuge</span></span>
<span id="cb158-55"><a href="#cb158-55" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>headout_after_bodyout[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[<span class="fu">min</span>((summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>),(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time <span class="sc">+</span> <span class="dv">1</span>), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"head-out"</span>)</span>
<span id="cb158-56"><a href="#cb158-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-57"><a href="#cb158-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How much time does the snake spend moving around the arena</span></span>
<span id="cb158-58"><a href="#cb158-58" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>exploring_arena[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"moving"</span>)</span>
<span id="cb158-59"><a href="#cb158-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-60"><a href="#cb158-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How much time did the snake spend exploring the walls (vertically)</span></span>
<span id="cb158-61"><a href="#cb158-61" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>exploring_wall[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"exploring wall"</span>)</span>
<span id="cb158-62"><a href="#cb158-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-63"><a href="#cb158-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How much time did the snake spend inmobile in the midle of the arena</span></span>
<span id="cb158-64"><a href="#cb158-64" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>immobile_exposed[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"immobile exposed"</span>)</span>
<span id="cb158-65"><a href="#cb158-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-66"><a href="#cb158-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How much time did the snake hide during trial</span></span>
<span id="cb158-67"><a href="#cb158-67" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>hiding[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"hidden"</span>)</span>
<span id="cb158-68"><a href="#cb158-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-69"><a href="#cb158-69" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>hiding_corner[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_head_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">22</span>, i] <span class="sc">==</span> <span class="st">"hiding / head-out"</span>)</span>
<span id="cb158-70"><a href="#cb158-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-71"><a href="#cb158-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Other variables</span></span>
<span id="cb158-72"><a href="#cb158-72" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>year[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion[i]</span>
<span id="cb158-73"><a href="#cb158-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-74"><a href="#cb158-74" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>distance[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs[i]</span>
<span id="cb158-75"><a href="#cb158-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-76"><a href="#cb158-76" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>Sex[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Sex[i]</span>
<span id="cb158-77"><a href="#cb158-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-78"><a href="#cb158-78" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>SVL[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>SVL[i]</span>
<span id="cb158-79"><a href="#cb158-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-80"><a href="#cb158-80" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>treatment[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Inv_situation[i]</span>
<span id="cb158-81"><a href="#cb158-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-82"><a href="#cb158-82" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>n_eggs[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>N_eggs[i]</span>
<span id="cb158-83"><a href="#cb158-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-84"><a href="#cb158-84" aria-hidden="true" tabindex="-1"></a>    behaviour_df<span class="sc">$</span>temperature[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Temperature[i]</span>
<span id="cb158-85"><a href="#cb158-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-86"><a href="#cb158-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-87"><a href="#cb158-87" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb158-88"><a href="#cb158-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-89"><a href="#cb158-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-90"><a href="#cb158-90" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb158-91"><a href="#cb158-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb158-92"><a href="#cb158-92" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-93"><a href="#cb158-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-94"><a href="#cb158-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-95"><a href="#cb158-95" aria-hidden="true" tabindex="-1"></a>behaviour_df <span class="ot">&lt;-</span> behaviour_df <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(Snake_ID)</span>
<span id="cb158-96"><a href="#cb158-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-97"><a href="#cb158-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Behaviour</span></span>
<span id="cb158-98"><a href="#cb158-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns of interest for stacked behaviour plot</span></span>
<span id="cb158-99"><a href="#cb158-99" aria-hidden="true" tabindex="-1"></a>stacked_behaviour <span class="ot">&lt;-</span> behaviour_df[, <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"headout_bf_bodyout"</span>, <span class="st">"headout_after_bodyout"</span>, <span class="st">"exploring_arena"</span>, <span class="st">"exploring_wall"</span>, <span class="st">"immobile_exposed"</span>, <span class="st">"hiding"</span>, <span class="st">"hiding_corner"</span>)]</span>
<span id="cb158-100"><a href="#cb158-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-101"><a href="#cb158-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Snake_ID ordered by year of invasion</span></span>
<span id="cb158-102"><a href="#cb158-102" aria-hidden="true" tabindex="-1"></a>snakes_order_by_distance <span class="ot">&lt;-</span> behaviour_df[, <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"distance"</span>)]</span>
<span id="cb158-103"><a href="#cb158-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-104"><a href="#cb158-104" aria-hidden="true" tabindex="-1"></a>snakes_order_by_distance <span class="ot">&lt;-</span> snakes_order_by_distance[<span class="fu">order</span>(snakes_order_by_distance<span class="sc">$</span>distance, <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb158-105"><a href="#cb158-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-106"><a href="#cb158-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Long format</span></span>
<span id="cb158-107"><a href="#cb158-107" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(stacked_behaviour, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"headout_bf_bodyout"</span>, <span class="st">"headout_after_bodyout"</span>, <span class="st">"exploring_arena"</span>, <span class="st">"exploring_wall"</span>, <span class="st">"immobile_exposed"</span>, <span class="st">"hiding"</span>, <span class="st">"hiding_corner"</span>), <span class="at">names_to =</span> <span class="st">"Behaviour"</span>, <span class="at">values_to =</span> <span class="st">"Percentage"</span>)</span>
<span id="cb158-108"><a href="#cb158-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-109"><a href="#cb158-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of each behaviour</span></span>
<span id="cb158-110"><a href="#cb158-110" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_long <span class="ot">&lt;-</span> stacked_behaviour_long <span class="sc">%&gt;%</span></span>
<span id="cb158-111"><a href="#cb158-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Snake_ID) <span class="sc">%&gt;%</span></span>
<span id="cb158-112"><a href="#cb158-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage_total =</span> <span class="fu">sum</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb158-113"><a href="#cb158-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb158-114"><a href="#cb158-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Percentage <span class="sc">/</span> Percentage_total <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb158-115"><a href="#cb158-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-116"><a href="#cb158-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Order Snake ID by year of invasion</span></span>
<span id="cb158-117"><a href="#cb158-117" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_long<span class="sc">$</span>Snake_ID <span class="ot">&lt;-</span> <span class="fu">factor</span>(stacked_behaviour_long<span class="sc">$</span>Snake_ID, <span class="at">levels =</span> snakes_order_by_distance<span class="sc">$</span>Snake_ID)</span>
<span id="cb158-118"><a href="#cb158-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-119"><a href="#cb158-119" aria-hidden="true" tabindex="-1"></a><span class="co"># Order behaviour variables</span></span>
<span id="cb158-120"><a href="#cb158-120" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_long<span class="sc">$</span>Behaviour <span class="ot">&lt;-</span> <span class="fu">factor</span>(stacked_behaviour_long<span class="sc">$</span>Behaviour, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"immobile_exposed"</span>, <span class="st">"exploring_wall"</span>, <span class="st">"exploring_arena"</span>,  <span class="st">"headout_after_bodyout"</span>, <span class="st">"headout_bf_bodyout"</span>, <span class="st">"hiding_corner"</span>, <span class="st">"hiding"</span>))</span>
<span id="cb158-121"><a href="#cb158-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-122"><a href="#cb158-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors for behaviours</span></span>
<span id="cb158-123"><a href="#cb158-123" aria-hidden="true" tabindex="-1"></a>beh_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">7</span>], <span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">6</span>], <span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">5</span>], <span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">4</span>], <span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">3</span>], <span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="fu">viridis</span>(<span class="dv">7</span>)[<span class="dv">1</span>])</span>
<span id="cb158-124"><a href="#cb158-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-125"><a href="#cb158-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb158-126"><a href="#cb158-126" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stacked_behaviour_long, <span class="fu">aes</span>(<span class="at">x =</span> Snake_ID, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Behaviour)) <span class="sc">+</span></span>
<span id="cb158-127"><a href="#cb158-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb158-128"><a href="#cb158-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Snake ID"</span>, <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"% behaviours during"</span>, study_time<span class="sc">/</span><span class="dv">60</span>, <span class="st">"min test"</span>), <span class="at">fill =</span> <span class="st">"Behaviours"</span>) <span class="sc">+</span></span>
<span id="cb158-129"><a href="#cb158-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb158-130"><a href="#cb158-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb158-131"><a href="#cb158-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),  </span>
<span id="cb158-132"><a href="#cb158-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb158-133"><a href="#cb158-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb158-134"><a href="#cb158-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb158-135"><a href="#cb158-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> beh_colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/stacked%20behaviour-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="permanova" class="level4">
<h4 class="anchored" data-anchor-id="permanova">6.2.2. PERMANOVA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative data frame with invasion situation</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_treatment <span class="ot">&lt;-</span> behaviour_df</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete Snake ID column</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_complete <span class="ot">&lt;-</span> stacked_behaviour_treatment</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_treatment <span class="ot">&lt;-</span> <span class="fu">subset</span>(stacked_behaviour_treatment, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Snake_ID))</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset pca columns (numeric)</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_treatment_var <span class="ot">&lt;-</span> stacked_behaviour_treatment[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>pca_beh <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(stacked_behaviour_treatment_var, <span class="at">scale. =</span> T)</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Weights PCA axis</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>pca_beh<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             PC1         PC2         PC3         PC4
headout_bf_bodyout     0.4829386 -0.47346329  0.31745140 -0.01529214
headout_after_bodyout  0.1644386  0.60484679 -0.16154238 -0.29086084
exploring_arena       -0.6067900  0.05165254  0.07060439 -0.10746895
exploring_wall        -0.3667115 -0.30332578 -0.50276967 -0.33830013
immobile_exposed      -0.2788926  0.38166955  0.62425255  0.13981017
hiding                 0.3691774  0.41103487 -0.37490933  0.10040535
hiding_corner         -0.1516105 -0.02640169 -0.29175005  0.87151675
                              PC5         PC6       PC7
headout_bf_bodyout    -0.12946777 -0.04569154 0.6501876
headout_after_bodyout -0.62668010  0.16407951 0.2770818
exploring_arena        0.28908415  0.48404217 0.5428967
exploring_wall        -0.15782305 -0.57819686 0.2169611
immobile_exposed      -0.02433874 -0.58980416 0.1372873
hiding                 0.62326102 -0.23323480 0.3182253
hiding_corner         -0.30493558  0.01069360 0.1963609</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_beh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                         PC1    PC2    PC3    PC4     PC5     PC6      PC7
Standard deviation     1.504 1.2464 1.0590 1.0225 0.78490 0.63432 0.001138
Proportion of Variance 0.323 0.2219 0.1602 0.1494 0.08801 0.05748 0.000000
Cumulative Proportion  0.323 0.5449 0.7051 0.8545 0.94252 1.00000 1.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot front vs. core</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_beh, <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">habillage =</span> stacked_behaviour_treatment<span class="sc">$</span>treatment, </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointsize =</span> <span class="dv">3</span>,</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.level =</span> <span class="fl">0.9</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/PERMANOVA%20behaviour-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sex</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_beh, <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">habillage =</span> stacked_behaviour_treatment<span class="sc">$</span>Sex, </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointsize =</span> <span class="dv">3</span>,</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.level =</span> <span class="fl">0.9</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/PERMANOVA%20behaviour-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA variables</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>stacked_behaviour_treatment_env <span class="ot">&lt;-</span> stacked_behaviour_treatment[, <span class="fu">c</span>(<span class="st">"treatment"</span>, <span class="st">"distance"</span>, <span class="st">"SVL"</span>, <span class="st">"Sex"</span>, <span class="st">"temperature"</span>)]</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA without interaction</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>beh.permanova <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(stacked_behaviour_treatment_var <span class="sc">~</span> distance <span class="sc">+</span> SVL <span class="sc">+</span> Sex <span class="sc">+</span> temperature, <span class="at">data =</span> stacked_behaviour_treatment_env, <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>beh.permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = stacked_behaviour_treatment_var ~ distance + SVL + Sex + temperature, data = stacked_behaviour_treatment_env, permutations = 999, method = "euclidean")
            Df SumOfSqs      R2      F Pr(&gt;F)   
distance     1   364491 0.12009 5.6705  0.007 **
SVL          1    49094 0.01618 0.7638  0.440   
Sex          2   339683 0.11192 2.6423  0.044 * 
temperature  1    32073 0.01057 0.4990  0.644   
Residual    35  2249745 0.74125                 
Total       40  3035086 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA with interaction</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>beh.permanova <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(stacked_behaviour_treatment_var <span class="sc">~</span> distance <span class="sc">*</span> SVL <span class="sc">*</span> Sex <span class="sc">*</span> temperature, <span class="at">data =</span> stacked_behaviour_treatment_env, <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>beh.permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = stacked_behaviour_treatment_var ~ distance * SVL * Sex * temperature, data = stacked_behaviour_treatment_env, permutations = 999, method = "euclidean")
                             Df SumOfSqs      R2      F Pr(&gt;F)   
distance                      1   364491 0.12009 5.8113  0.005 **
SVL                           1    49094 0.01618 0.7827  0.474   
Sex                           2   339683 0.11192 2.7079  0.042 * 
temperature                   1    32073 0.01057 0.5114  0.662   
distance:SVL                  1    66472 0.02190 1.0598  0.341   
distance:Sex                  1   149515 0.04926 2.3838  0.075 . 
SVL:Sex                       1    43209 0.01424 0.6889  0.505   
distance:temperature          1   102750 0.03385 1.6382  0.214   
SVL:temperature               1     6434 0.00212 0.1026  0.969   
Sex:temperature               1    19727 0.00650 0.3145  0.826   
distance:SVL:Sex              1   117902 0.03885 1.8798  0.138   
distance:SVL:temperature      1   166589 0.05489 2.6560  0.066 . 
distance:Sex:temperature      1     3376 0.00111 0.0538  0.991   
SVL:Sex:temperature           1    35731 0.01177 0.5697  0.591   
distance:SVL:Sex:temperature  1    32730 0.01078 0.5218  0.658   
Residual                     24  1505310 0.49597                 
Total                        40  3035086 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="betadisper" class="level4">
<h4 class="anchored" data-anchor-id="betadisper">6.2.3 betadisper</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>beh.dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">decostand</span>(stacked_behaviour_treatment_var, <span class="st">"norm"</span>), <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>beh.dispersion <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(beh.dist, <span class="at">group =</span> stacked_behaviour_treatment_env<span class="sc">$</span>treatment)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(beh.dispersion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     1 0.0145 0.014504 0.3743    999  0.563
Residuals 39 1.5111 0.038747                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(beh.dispersion, <span class="at">hull =</span> <span class="cn">FALSE</span>, <span class="at">ellipse =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">"PCoA front vs. core dispersion"</span>) </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(beh.dispersion, <span class="at">main =</span> <span class="st">"Boxplot distance to centroids"</span>, <span class="at">xlab =</span> <span class="st">"Groups"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/betadisper%20behaviour-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sex</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>beh.dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">decostand</span>(stacked_behaviour_treatment_var, <span class="st">"norm"</span>), <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>beh.dispersion <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(beh.dist, <span class="at">group =</span> stacked_behaviour_treatment_env<span class="sc">$</span>Sex)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(beh.dispersion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.19089 0.095445 2.2134    999  0.113
Residuals 38 1.63858 0.043121                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(beh.dispersion, <span class="at">hull =</span> <span class="cn">FALSE</span>, <span class="at">ellipse =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">"PCoA M vs. F dispersion"</span>) </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(beh.dispersion, <span class="at">main =</span> <span class="st">"Boxplot distance to centroids"</span>, <span class="at">xlab =</span> <span class="st">"Groups"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/betadisper%20behaviour-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="area-use-analysis" class="level3">
<h3 class="anchored" data-anchor-id="area-use-analysis">6.3. Area use analysis</h3>
<p>In contrast to behaviour, here we want to know how much time did each snake spend doing head-out before and after body-out. We are going to analyse the use of the area only after body-out, because if we analysed area use after head-out, the initial refuge area would have bigger numbers. We want to know what areas did the snake visit after exiting the refuge, not taking into account the initial visual exploration that snakes performed during head-out before body-out.</p>
<section id="stacked-area-use-plot" class="level4">
<h4 class="anchored" data-anchor-id="stacked-area-use-plot">6.3.1. Stacked area use plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicate original data frame</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>Snake_array_dupl <span class="ot">&lt;-</span> Snake_array</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># No repeatability filter</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>snake_id <span class="ot">&lt;-</span> <span class="fu">names</span>(Snake_array[<span class="dv">1</span>,<span class="dv">1</span>,])</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>dupl_positions <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(snake_id)){</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">duplicated</span>(snake_id)[i] <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>    dupl_positions[a] <span class="ot">&lt;-</span> i</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> a <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Final data frame without duplicates (repeatability)</span></span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a>Snake_array_dupl <span class="ot">&lt;-</span> Snake_array_dupl[, , <span class="sc">-</span>dupl_positions]</span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a><span class="co"># How much time do we want to analyse</span></span>
<span id="cb175-30"><a href="#cb175-30" aria-hidden="true" tabindex="-1"></a>study_time <span class="ot">&lt;-</span> <span class="dv">900</span></span>
<span id="cb175-31"><a href="#cb175-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-32"><a href="#cb175-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb175-33"><a href="#cb175-33" aria-hidden="true" tabindex="-1"></a>area_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">16</span>, <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">names</span>(Snake_array_dupl[<span class="dv">1</span>,<span class="dv">1</span>,]))))</span>
<span id="cb175-34"><a href="#cb175-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-35"><a href="#cb175-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Column names</span></span>
<span id="cb175-36"><a href="#cb175-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(area_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"time_central_area"</span>, <span class="st">"time_intermediate_area"</span>, <span class="st">"time_refuge_area_1"</span>, <span class="st">"time_refuge_area_2"</span>, <span class="st">"time_initial_refuge"</span>, <span class="st">"time_distant_wall"</span>, <span class="st">"time_lateral_1"</span>, <span class="st">"time_lateral_2"</span>, <span class="st">"year"</span>, <span class="st">"distance"</span>, <span class="st">"Sex"</span>, <span class="st">"SVL"</span>, <span class="st">"treatment"</span>, <span class="st">"n_eggs"</span>, <span class="st">"temperature"</span>)</span>
<span id="cb175-37"><a href="#cb175-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-38"><a href="#cb175-38" aria-hidden="true" tabindex="-1"></a><span class="co"># For all snakes:</span></span>
<span id="cb175-39"><a href="#cb175-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(Snake_array_dupl[<span class="dv">1</span>,<span class="dv">1</span>,]))){</span>
<span id="cb175-40"><a href="#cb175-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb175-41"><a href="#cb175-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the snake exited the initial refuge and explored for more than the specified syudy time before time ran out</span></span>
<span id="cb175-42"><a href="#cb175-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time <span class="sc">&lt;=</span> <span class="dv">3000</span>){</span>
<span id="cb175-43"><a href="#cb175-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-44"><a href="#cb175-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Snake ID</span></span>
<span id="cb175-45"><a href="#cb175-45" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>Snake_ID[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Snake_ID[i]</span>
<span id="cb175-46"><a href="#cb175-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-47"><a href="#cb175-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Time spent in each of the areas</span></span>
<span id="cb175-48"><a href="#cb175-48" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_central_area[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Central area"</span>))</span>
<span id="cb175-49"><a href="#cb175-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-50"><a href="#cb175-50" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_intermediate_area[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Intermediate area"</span>))</span>
<span id="cb175-51"><a href="#cb175-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-52"><a href="#cb175-52" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_refuge_area_1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Refuge area 1"</span>))</span>
<span id="cb175-53"><a href="#cb175-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-54"><a href="#cb175-54" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_refuge_area_2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Refuge area 2"</span>))</span>
<span id="cb175-55"><a href="#cb175-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-56"><a href="#cb175-56" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_initial_refuge[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Initial refuge"</span>))</span>
<span id="cb175-57"><a href="#cb175-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-58"><a href="#cb175-58" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_distant_wall[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Distant wall"</span>))</span>
<span id="cb175-59"><a href="#cb175-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-60"><a href="#cb175-60" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_lateral_1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Lateral 1"</span>))</span>
<span id="cb175-61"><a href="#cb175-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-62"><a href="#cb175-62" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>time_lateral_2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">13</span>, i] <span class="sc">==</span> <span class="st">"Lateral 2"</span>))</span>
<span id="cb175-63"><a href="#cb175-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-64"><a href="#cb175-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Other variables</span></span>
<span id="cb175-65"><a href="#cb175-65" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>year[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion[i]</span>
<span id="cb175-66"><a href="#cb175-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-67"><a href="#cb175-67" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>distance[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs[i]</span>
<span id="cb175-68"><a href="#cb175-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-69"><a href="#cb175-69" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>Sex[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Sex[i]</span>
<span id="cb175-70"><a href="#cb175-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-71"><a href="#cb175-71" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>SVL[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>SVL[i]</span>
<span id="cb175-72"><a href="#cb175-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-73"><a href="#cb175-73" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>treatment[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Inv_situation[i]</span>
<span id="cb175-74"><a href="#cb175-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-75"><a href="#cb175-75" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>n_eggs[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>N_eggs[i]</span>
<span id="cb175-76"><a href="#cb175-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-77"><a href="#cb175-77" aria-hidden="true" tabindex="-1"></a>    area_df<span class="sc">$</span>temperature[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Temperature[i]</span>
<span id="cb175-78"><a href="#cb175-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-79"><a href="#cb175-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-80"><a href="#cb175-80" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb175-81"><a href="#cb175-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-82"><a href="#cb175-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb175-83"><a href="#cb175-83" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-84"><a href="#cb175-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb175-85"><a href="#cb175-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-86"><a href="#cb175-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-87"><a href="#cb175-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-88"><a href="#cb175-88" aria-hidden="true" tabindex="-1"></a>area_df <span class="ot">&lt;-</span> area_df <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(Snake_ID)</span>
<span id="cb175-89"><a href="#cb175-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-90"><a href="#cb175-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-91"><a href="#cb175-91" aria-hidden="true" tabindex="-1"></a><span class="co">#Select columns</span></span>
<span id="cb175-92"><a href="#cb175-92" aria-hidden="true" tabindex="-1"></a>stacked_area <span class="ot">&lt;-</span> area_df[, <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"time_central_area"</span>, <span class="st">"time_intermediate_area"</span>, <span class="st">"time_refuge_area_1"</span>, <span class="st">"time_refuge_area_2"</span>, <span class="st">"time_initial_refuge"</span>, <span class="st">"time_distant_wall"</span>, <span class="st">"time_lateral_1"</span>, <span class="st">"time_lateral_2"</span>)]</span>
<span id="cb175-93"><a href="#cb175-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-94"><a href="#cb175-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Snake_ID ordered by distance to Noah's garden</span></span>
<span id="cb175-95"><a href="#cb175-95" aria-hidden="true" tabindex="-1"></a>snakes_order_by_distance <span class="ot">&lt;-</span> area_df[, <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"distance"</span>)]</span>
<span id="cb175-96"><a href="#cb175-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-97"><a href="#cb175-97" aria-hidden="true" tabindex="-1"></a>snakes_order_by_distance <span class="ot">&lt;-</span> snakes_order_by_distance[<span class="fu">order</span>(snakes_order_by_distance<span class="sc">$</span>distance, <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb175-98"><a href="#cb175-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-99"><a href="#cb175-99" aria-hidden="true" tabindex="-1"></a><span class="co"># New variables (merge laterals)</span></span>
<span id="cb175-100"><a href="#cb175-100" aria-hidden="true" tabindex="-1"></a>stacked_area<span class="sc">$</span>refuge_area <span class="ot">&lt;-</span> stacked_area<span class="sc">$</span>time_refuge_area_1 <span class="sc">+</span> stacked_area<span class="sc">$</span>time_refuge_area_2</span>
<span id="cb175-101"><a href="#cb175-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-102"><a href="#cb175-102" aria-hidden="true" tabindex="-1"></a>stacked_area<span class="sc">$</span>over_lateral <span class="ot">&lt;-</span> stacked_area<span class="sc">$</span>time_lateral_1 <span class="sc">+</span> stacked_area<span class="sc">$</span>time_lateral_2</span>
<span id="cb175-103"><a href="#cb175-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-104"><a href="#cb175-104" aria-hidden="true" tabindex="-1"></a><span class="co"># We delete these intermediate variables used to calculate previous variables</span></span>
<span id="cb175-105"><a href="#cb175-105" aria-hidden="true" tabindex="-1"></a>stacked_area <span class="ot">&lt;-</span> <span class="fu">subset</span>(stacked_area, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(time_refuge_area_1, time_refuge_area_2, time_lateral_1, time_lateral_2))</span>
<span id="cb175-106"><a href="#cb175-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-107"><a href="#cb175-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative data frame with invasion situation</span></span>
<span id="cb175-108"><a href="#cb175-108" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment <span class="ot">&lt;-</span> stacked_area</span>
<span id="cb175-109"><a href="#cb175-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-110"><a href="#cb175-110" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment<span class="sc">$</span>treatment <span class="ot">&lt;-</span> area_df<span class="sc">$</span>treatment</span>
<span id="cb175-111"><a href="#cb175-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-112"><a href="#cb175-112" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment<span class="sc">$</span>year <span class="ot">&lt;-</span> area_df<span class="sc">$</span>year</span>
<span id="cb175-113"><a href="#cb175-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-114"><a href="#cb175-114" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment<span class="sc">$</span>SVL <span class="ot">&lt;-</span> area_df<span class="sc">$</span>SVL</span>
<span id="cb175-115"><a href="#cb175-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-116"><a href="#cb175-116" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment<span class="sc">$</span>distance <span class="ot">&lt;-</span> area_df<span class="sc">$</span>distance</span>
<span id="cb175-117"><a href="#cb175-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-118"><a href="#cb175-118" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment<span class="sc">$</span>sex <span class="ot">&lt;-</span> area_df<span class="sc">$</span>Sex</span>
<span id="cb175-119"><a href="#cb175-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-120"><a href="#cb175-120" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment<span class="sc">$</span>temperature <span class="ot">&lt;-</span> area_df<span class="sc">$</span>temperature</span>
<span id="cb175-121"><a href="#cb175-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-122"><a href="#cb175-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Long format</span></span>
<span id="cb175-123"><a href="#cb175-123" aria-hidden="true" tabindex="-1"></a>stacked_area_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(stacked_area, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"time_central_area"</span>, <span class="st">"time_intermediate_area"</span>, <span class="st">"time_initial_refuge"</span>, <span class="st">"time_distant_wall"</span>, <span class="st">"refuge_area"</span>, <span class="st">"over_lateral"</span>), <span class="at">names_to =</span> <span class="st">"Area"</span>, <span class="at">values_to =</span> <span class="st">"Percentage"</span>)</span>
<span id="cb175-124"><a href="#cb175-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-125"><a href="#cb175-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of each behaviour</span></span>
<span id="cb175-126"><a href="#cb175-126" aria-hidden="true" tabindex="-1"></a>stacked_area_long <span class="ot">&lt;-</span> stacked_area_long <span class="sc">%&gt;%</span></span>
<span id="cb175-127"><a href="#cb175-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Snake_ID) <span class="sc">%&gt;%</span></span>
<span id="cb175-128"><a href="#cb175-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage_total =</span> <span class="fu">sum</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb175-129"><a href="#cb175-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb175-130"><a href="#cb175-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Percentage <span class="sc">/</span> Percentage_total <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb175-131"><a href="#cb175-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-132"><a href="#cb175-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Order Snake ID by distance to Noah's garden</span></span>
<span id="cb175-133"><a href="#cb175-133" aria-hidden="true" tabindex="-1"></a>stacked_area_long<span class="sc">$</span>Snake_ID <span class="ot">&lt;-</span> <span class="fu">factor</span>(stacked_area_long<span class="sc">$</span>Snake_ID, <span class="at">levels =</span> snakes_order_by_distance<span class="sc">$</span>Snake_ID)</span>
<span id="cb175-134"><a href="#cb175-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-135"><a href="#cb175-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Order behaviour variables</span></span>
<span id="cb175-136"><a href="#cb175-136" aria-hidden="true" tabindex="-1"></a>stacked_area_long<span class="sc">$</span>Area <span class="ot">&lt;-</span> <span class="fu">factor</span>(stacked_area_long<span class="sc">$</span>Area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"time_central_area"</span>, <span class="st">"time_intermediate_area"</span>, <span class="st">"time_initial_refuge"</span>, <span class="st">"time_distant_wall"</span>, <span class="st">"refuge_area"</span>, <span class="st">"over_lateral"</span>))</span>
<span id="cb175-137"><a href="#cb175-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-138"><a href="#cb175-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-139"><a href="#cb175-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors for behaviours</span></span>
<span id="cb175-140"><a href="#cb175-140" aria-hidden="true" tabindex="-1"></a>area_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">6</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">5</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">4</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">3</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">2</span>], <span class="fu">viridis</span>(<span class="dv">6</span>)[<span class="dv">1</span>])</span>
<span id="cb175-141"><a href="#cb175-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-142"><a href="#cb175-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb175-143"><a href="#cb175-143" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stacked_area_long, <span class="fu">aes</span>(<span class="at">x =</span> Snake_ID, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Area)) <span class="sc">+</span></span>
<span id="cb175-144"><a href="#cb175-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb175-145"><a href="#cb175-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Snake ID"</span>, <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"% area use during"</span>, study_time<span class="sc">/</span><span class="dv">60</span>, <span class="st">"min test"</span>), <span class="at">fill =</span> <span class="st">"Area"</span>) <span class="sc">+</span></span>
<span id="cb175-146"><a href="#cb175-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb175-147"><a href="#cb175-147" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb175-148"><a href="#cb175-148" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),  </span>
<span id="cb175-149"><a href="#cb175-149" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb175-150"><a href="#cb175-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb175-151"><a href="#cb175-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb175-152"><a href="#cb175-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> area_colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/stacked%20area-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="permanova-1" class="level4">
<h4 class="anchored" data-anchor-id="permanova-1">6.3.2. PERMANOVA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete Snake ID column</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>stacked_area_complete <span class="ot">&lt;-</span> stacked_area_treatment</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment <span class="ot">&lt;-</span> <span class="fu">subset</span>(stacked_area_treatment, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Snake_ID))</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset pca columns (numeric)</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment_var <span class="ot">&lt;-</span> stacked_area_treatment[, <span class="fu">c</span>(<span class="st">"time_central_area"</span>, <span class="st">"time_intermediate_area"</span>, <span class="st">"time_initial_refuge"</span>, <span class="st">"time_distant_wall"</span>, <span class="st">"refuge_area"</span>, <span class="st">"over_lateral"</span>)]</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>pca_area <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(stacked_area_treatment_var, <span class="at">scale. =</span> T)</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Weights PCA axis</span></span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>pca_area<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              PC1        PC2         PC3         PC4
time_central_area      -0.5185508  0.2429416 -0.34613293  0.25182626
time_intermediate_area -0.5718452  0.2144910 -0.10348885  0.36055059
time_initial_refuge    -0.2265918  0.4244870  0.61699727 -0.39048376
time_distant_wall       0.1217155  0.2627736 -0.69544386 -0.56378275
refuge_area            -0.1962962 -0.7434357 -0.05527978  0.00199712
over_lateral            0.5471814  0.3050200 -0.04580838  0.57987434
                               PC5        PC6
time_central_area      -0.69763327 0.04656028
time_intermediate_area  0.68858992 0.11010885
time_initial_refuge    -0.09914015 0.47484207
time_distant_wall       0.16240156 0.29709926
refuge_area            -0.04242041 0.63554058
over_lateral           -0.03390015 0.51773872</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_area)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3    PC4     PC5       PC6
Standard deviation     1.4110 1.2893 1.1266 0.8557 0.58761 3.432e-16
Proportion of Variance 0.3318 0.2771 0.2115 0.1220 0.05755 0.000e+00
Cumulative Proportion  0.3318 0.6089 0.8204 0.9425 1.00000 1.000e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot front vs. core</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_area, <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">habillage =</span> stacked_area_treatment<span class="sc">$</span>treatment, </span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">pointsize =</span> <span class="dv">3</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.level =</span> <span class="fl">0.9</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/PERMANOVA%20area-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sex</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_area, <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">habillage =</span> stacked_area_treatment<span class="sc">$</span>sex, </span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">pointsize =</span> <span class="dv">3</span>,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.level =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/PERMANOVA%20area-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA variables</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>stacked_area_treatment_env <span class="ot">&lt;-</span> stacked_area_treatment[, <span class="fu">c</span>(<span class="st">"treatment"</span>, <span class="st">"distance"</span>, <span class="st">"SVL"</span>, <span class="st">"sex"</span>, <span class="st">"temperature"</span>)]</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA without interaction</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>beh.area <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(stacked_area_treatment_var <span class="sc">~</span> distance <span class="sc">+</span> SVL <span class="sc">+</span> sex <span class="sc">+</span> temperature, <span class="at">data =</span> stacked_area_treatment_env, <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>beh.area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = stacked_area_treatment_var ~ distance + SVL + sex + temperature, data = stacked_area_treatment_env, permutations = 999, method = "euclidean")
            Df SumOfSqs      R2      F Pr(&gt;F)
distance     1    43893 0.03592 1.3876  0.237
SVL          1    14645 0.01198 0.4630  0.667
sex          2   110387 0.09032 1.7448  0.151
temperature  1    40961 0.03352 1.2949  0.259
Residual    32  1012228 0.82826              
Total       37  1222113 1.00000              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA with interaction</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>beh.area <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(stacked_area_treatment_var <span class="sc">~</span> distance <span class="sc">*</span> SVL <span class="sc">*</span> sex <span class="sc">*</span> temperature, <span class="at">data =</span> stacked_area_treatment_env, <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>beh.area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = stacked_area_treatment_var ~ distance * SVL * sex * temperature, data = stacked_area_treatment_env, permutations = 999, method = "euclidean")
                             Df SumOfSqs      R2      F Pr(&gt;F)
distance                      1    43893 0.03592 1.5683  0.226
SVL                           1    14645 0.01198 0.5233  0.642
sex                           2   110387 0.09032 1.9721  0.119
temperature                   1    40961 0.03352 1.4636  0.256
distance:SVL                  1    45889 0.03755 1.6397  0.185
distance:sex                  1    49491 0.04050 1.7684  0.191
SVL:sex                       1    55737 0.04561 1.9915  0.150
distance:temperature          1    18641 0.01525 0.6661  0.531
SVL:temperature               1    46281 0.03787 1.6537  0.219
sex:temperature               1    48664 0.03982 1.7388  0.195
distance:SVL:sex              1    30309 0.02480 1.0830  0.356
distance:SVL:temperature      1    34548 0.02827 1.2344  0.296
distance:sex:temperature      1    36275 0.02968 1.2961  0.270
SVL:sex:temperature           1    47671 0.03901 1.7034  0.181
distance:SVL:sex:temperature  1    10998 0.00900 0.3930  0.732
Residual                     21   587723 0.48091              
Total                        37  1222113 1.00000              </code></pre>
</div>
</div>
</section>
<section id="betadisper-1" class="level4">
<h4 class="anchored" data-anchor-id="betadisper-1">6.3.3. betadisper</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>area.dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">decostand</span>(stacked_area_treatment_var, <span class="st">"norm"</span>), <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>area.dispersion <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(area.dist, <span class="at">group =</span> stacked_area_treatment_env<span class="sc">$</span>treatment)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(area.dispersion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     1 0.00474 0.004744 0.1547    999  0.726
Residuals 36 1.10383 0.030662                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(area.dispersion, <span class="at">hull =</span> <span class="cn">FALSE</span>, <span class="at">ellipse =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">"PCoA front vs. core dispersion"</span>) </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(area.dispersion, <span class="at">main =</span> <span class="st">"Boxplot distance to centroids"</span>, <span class="at">xlab =</span> <span class="st">"Groups"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/betadisper%20area-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sex</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>area.dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">decostand</span>(stacked_area_treatment_var, <span class="st">"norm"</span>), <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>area.dispersion <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(area.dist, <span class="at">group =</span> stacked_area_treatment_env<span class="sc">$</span>sex)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(area.dispersion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)   
Groups     2 0.24387 0.121935 5.7611    999  0.005 **
Residuals 35 0.74079 0.021165                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(area.dispersion, <span class="at">hull =</span> <span class="cn">FALSE</span>, <span class="at">ellipse =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">"PCoA M vs. F dispersion"</span>) </span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(area.dispersion, <span class="at">main =</span> <span class="st">"Boxplot distance to centroids"</span>, <span class="at">xlab =</span> <span class="st">"Groups"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/betadisper%20area-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="cumulative-exploration-tests" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-exploration-tests">7. Cumulative exploration tests</h2>
<p>In this section we will analyse whether there are differences between groups (FRONT vs.&nbsp;CORE and M vs.&nbsp;F) in terms of the behaviour expressed during a certain exploration time (i. e. 15 min). The variables we will look at are the average speed of the individuals, the total distance travelled (in total, including vertical, and only while exploring), the total time exploring, the total time hidden, the number of visits to refuges, the average time the snake has been hidden in these refuges, and the average time the snake is exposed between visits to refuges.</p>
<section id="data-filtering-and-shared-functions" class="level3">
<h3 class="anchored" data-anchor-id="data-filtering-and-shared-functions">7.1. Data filtering and shared functions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicate data frame</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>Snake_array_dupl <span class="ot">&lt;-</span> Snake_array</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co"># No repeatability filter</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>snake_id <span class="ot">&lt;-</span> <span class="fu">names</span>(Snake_array[<span class="dv">1</span>,<span class="dv">1</span>,])</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>dupl_positions <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(snake_id)){</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">duplicated</span>(snake_id)[i] <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>    dupl_positions[a] <span class="ot">&lt;-</span> i</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> a <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Final data frame without duplicates (repeatability)</span></span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a>Snake_array_dupl <span class="ot">&lt;-</span> Snake_array_dupl[, , <span class="sc">-</span>dupl_positions]</span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a><span class="co"># How much time do we want to analyse</span></span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a>study_time <span class="ot">&lt;-</span> <span class="dv">900</span></span>
<span id="cb192-31"><a href="#cb192-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-32"><a href="#cb192-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb192-33"><a href="#cb192-33" aria-hidden="true" tabindex="-1"></a>movement_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">18</span>, <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">names</span>(Snake_array_dupl[<span class="dv">1</span>,<span class="dv">1</span>,]))))</span>
<span id="cb192-34"><a href="#cb192-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-35"><a href="#cb192-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Column names</span></span>
<span id="cb192-36"><a href="#cb192-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(movement_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Snake_ID"</span>, <span class="st">"avg_speed"</span>, <span class="st">"total_dist_trav"</span>, <span class="st">"avg_speed_moving"</span>, <span class="st">"total_dist_trav_moving"</span>, <span class="st">"time_moving"</span>, <span class="st">"time_hidden"</span>, <span class="st">"n_visits_refuge"</span>, <span class="st">"avg_time_hidden"</span>, <span class="st">"avg_time_bw_refuges"</span>, <span class="st">"year"</span>, <span class="st">"distance"</span>, <span class="st">"Sex"</span>, <span class="st">"SVL"</span>, <span class="st">"Condition"</span>, <span class="st">"treatment"</span>, <span class="st">"n_eggs"</span>, <span class="st">"temperature"</span>)</span>
<span id="cb192-37"><a href="#cb192-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-38"><a href="#cb192-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(Snake_array_dupl[<span class="dv">1</span>,<span class="dv">1</span>,]))){</span>
<span id="cb192-39"><a href="#cb192-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-40"><a href="#cb192-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># body-out better than head-out</span></span>
<span id="cb192-41"><a href="#cb192-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time <span class="sc">&lt;=</span> <span class="dv">3000</span>){</span>
<span id="cb192-42"><a href="#cb192-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-43"><a href="#cb192-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># snake ID</span></span>
<span id="cb192-44"><a href="#cb192-44" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>Snake_ID[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Snake_ID[i]</span>
<span id="cb192-45"><a href="#cb192-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-46"><a href="#cb192-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># avg speed during the tested time, independent of behaviour</span></span>
<span id="cb192-47"><a href="#cb192-47" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>avg_speed[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">21</span>, i]))</span>
<span id="cb192-48"><a href="#cb192-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-49"><a href="#cb192-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># total distance travelled, independent of behaviour</span></span>
<span id="cb192-50"><a href="#cb192-50" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>total_dist_trav[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), <span class="dv">21</span>, i]))</span>
<span id="cb192-51"><a href="#cb192-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-52"><a href="#cb192-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-53"><a href="#cb192-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subsample: extract only rows when snake is moving</span></span>
<span id="cb192-54"><a href="#cb192-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-55"><a href="#cb192-55" aria-hidden="true" tabindex="-1"></a>    movement_df_moving <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), , i])</span>
<span id="cb192-56"><a href="#cb192-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-57"><a href="#cb192-57" aria-hidden="true" tabindex="-1"></a>    movement_df_moving <span class="ot">&lt;-</span> <span class="fu">subset</span>(movement_df_moving, behaviour <span class="sc">==</span> <span class="st">"moving"</span>, <span class="at">select =</span> t<span class="sc">:</span>behaviour)</span>
<span id="cb192-58"><a href="#cb192-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-59"><a href="#cb192-59" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>avg_speed_moving[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(movement_df_moving[, <span class="dv">21</span>]))</span>
<span id="cb192-60"><a href="#cb192-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-61"><a href="#cb192-61" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>total_dist_trav_moving[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(movement_df_moving[, <span class="dv">21</span>]))</span>
<span id="cb192-62"><a href="#cb192-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-63"><a href="#cb192-63" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>time_moving[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(movement_df_moving[, <span class="dv">22</span>] <span class="sc">==</span> <span class="st">"moving"</span>)</span>
<span id="cb192-64"><a href="#cb192-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-65"><a href="#cb192-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subsample: extract only rows when snake is hidden</span></span>
<span id="cb192-66"><a href="#cb192-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-67"><a href="#cb192-67" aria-hidden="true" tabindex="-1"></a>    movement_df_hidden <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Snake_array_dupl[(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(summary_tracking_complete_no_rep<span class="sc">$</span>Time_body_out_sec_raw[i] <span class="sc">+</span> study_time), , i])</span>
<span id="cb192-68"><a href="#cb192-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-69"><a href="#cb192-69" aria-hidden="true" tabindex="-1"></a>    movement_df_hidden <span class="ot">&lt;-</span> <span class="fu">subset</span>(movement_df_hidden, behaviour <span class="sc">==</span> <span class="st">"hidden"</span>, <span class="at">select =</span> t<span class="sc">:</span>behaviour)</span>
<span id="cb192-70"><a href="#cb192-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-71"><a href="#cb192-71" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>time_hidden[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(movement_df_hidden[, <span class="dv">22</span>] <span class="sc">==</span> <span class="st">"hidden"</span>)</span>
<span id="cb192-72"><a href="#cb192-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-73"><a href="#cb192-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># differences between numbers</span></span>
<span id="cb192-74"><a href="#cb192-74" aria-hidden="true" tabindex="-1"></a>    diff_hidden <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">as.numeric</span>(movement_df_hidden<span class="sc">$</span>t))</span>
<span id="cb192-75"><a href="#cb192-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-76"><a href="#cb192-76" aria-hidden="true" tabindex="-1"></a>    jumps <span class="ot">&lt;-</span> diff_hidden[diff_hidden <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb192-77"><a href="#cb192-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-78"><a href="#cb192-78" aria-hidden="true" tabindex="-1"></a>    n_jumps <span class="ot">&lt;-</span> <span class="fu">length</span>(jumps)</span>
<span id="cb192-79"><a href="#cb192-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-80"><a href="#cb192-80" aria-hidden="true" tabindex="-1"></a>    jump_index <span class="ot">&lt;-</span> <span class="fu">which</span>(diff_hidden <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb192-81"><a href="#cb192-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-82"><a href="#cb192-82" aria-hidden="true" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="fu">as.numeric</span>(movement_df_hidden<span class="sc">$</span>t), <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, diff_hidden <span class="sc">&gt;</span> <span class="dv">1</span>)))</span>
<span id="cb192-83"><a href="#cb192-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-84"><a href="#cb192-84" aria-hidden="true" tabindex="-1"></a>    chunk_length <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chunk, length)</span>
<span id="cb192-85"><a href="#cb192-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-86"><a href="#cb192-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># jump demonstrates a change from hide 1 to hide 2</span></span>
<span id="cb192-87"><a href="#cb192-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-88"><a href="#cb192-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We are going to select only those visits that last for longer than 5 seconds, as visits that last for less than 5 seconds, it's just exploration. The snake doesn't hide completely, it only enters its head and exits in a moment</span></span>
<span id="cb192-89"><a href="#cb192-89" aria-hidden="true" tabindex="-1"></a>    valid_visits <span class="ot">&lt;-</span> chunk_length <span class="sc">&gt;</span> <span class="dv">5</span></span>
<span id="cb192-90"><a href="#cb192-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-91"><a href="#cb192-91" aria-hidden="true" tabindex="-1"></a>    n_jumps_valid <span class="ot">&lt;-</span> <span class="fu">sum</span>(valid_visits) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb192-92"><a href="#cb192-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-93"><a href="#cb192-93" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>n_visits_refuge[i] <span class="ot">&lt;-</span> n_jumps <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb192-94"><a href="#cb192-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-95"><a href="#cb192-95" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>avg_time_bw_refuges[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(jumps[valid_visits[<span class="sc">-</span><span class="fu">length</span>(valid_visits)]])</span>
<span id="cb192-96"><a href="#cb192-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-97"><a href="#cb192-97" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>avg_time_hidden[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(chunk_length[valid_visits])</span>
<span id="cb192-98"><a href="#cb192-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-99"><a href="#cb192-99" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>year[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Year_invasion[i]</span>
<span id="cb192-100"><a href="#cb192-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-101"><a href="#cb192-101" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>distance[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Distance_Noahs[i]</span>
<span id="cb192-102"><a href="#cb192-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-103"><a href="#cb192-103" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>Sex[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Sex[i]</span>
<span id="cb192-104"><a href="#cb192-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-105"><a href="#cb192-105" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>SVL[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>SVL[i]</span>
<span id="cb192-106"><a href="#cb192-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-107"><a href="#cb192-107" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>Condition[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Condition[i]</span>
<span id="cb192-108"><a href="#cb192-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-109"><a href="#cb192-109" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>treatment[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Inv_situation[i]</span>
<span id="cb192-110"><a href="#cb192-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-111"><a href="#cb192-111" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>n_eggs[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>N_eggs[i]</span>
<span id="cb192-112"><a href="#cb192-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-113"><a href="#cb192-113" aria-hidden="true" tabindex="-1"></a>    movement_df<span class="sc">$</span>temperature[i] <span class="ot">&lt;-</span> summary_tracking_complete_no_rep<span class="sc">$</span>Temperature[i]</span>
<span id="cb192-114"><a href="#cb192-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-115"><a href="#cb192-115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-116"><a href="#cb192-116" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb192-117"><a href="#cb192-117" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-118"><a href="#cb192-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-119"><a href="#cb192-119" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb192-120"><a href="#cb192-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-121"><a href="#cb192-121" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-122"><a href="#cb192-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-123"><a href="#cb192-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-124"><a href="#cb192-124" aria-hidden="true" tabindex="-1"></a>movement_df <span class="ot">&lt;-</span> movement_df <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(Snake_ID)</span>
<span id="cb192-125"><a href="#cb192-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-126"><a href="#cb192-126" aria-hidden="true" tabindex="-1"></a><span class="co"># We delete juveniles, as for the paired comparisons, you need exactly 2 factors</span></span>
<span id="cb192-127"><a href="#cb192-127" aria-hidden="true" tabindex="-1"></a>movement_df <span class="ot">&lt;-</span> movement_df[<span class="fu">which</span>(movement_df<span class="sc">$</span>Sex <span class="sc">!=</span> <span class="st">"Juv"</span>),]</span>
<span id="cb192-128"><a href="#cb192-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-129"><a href="#cb192-129" aria-hidden="true" tabindex="-1"></a><span class="co"># t-tests</span></span>
<span id="cb192-130"><a href="#cb192-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compare different exploratory variables depending on front vs. core</span></span>
<span id="cb192-131"><a href="#cb192-131" aria-hidden="true" tabindex="-1"></a>compare_core_front <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-132"><a href="#cb192-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(movement_df[[variable]] <span class="sc">~</span> movement_df<span class="sc">$</span>treatment)</span>
<span id="cb192-133"><a href="#cb192-133" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-134"><a href="#cb192-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-135"><a href="#cb192-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compare different exploratory variables depending on male vs. female</span></span>
<span id="cb192-136"><a href="#cb192-136" aria-hidden="true" tabindex="-1"></a>compare_sex <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-137"><a href="#cb192-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(movement_df[[variable]] <span class="sc">~</span> movement_df<span class="sc">$</span>Sex)</span>
<span id="cb192-138"><a href="#cb192-138" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-139"><a href="#cb192-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-140"><a href="#cb192-140" aria-hidden="true" tabindex="-1"></a><span class="co"># To check normality and homoscedasticity</span></span>
<span id="cb192-141"><a href="#cb192-141" aria-hidden="true" tabindex="-1"></a>verify_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, group) {</span>
<span id="cb192-142"><a href="#cb192-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>(movement_df[[variable]])  </span>
<span id="cb192-143"><a href="#cb192-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leveneTest</span>(movement_df[[variable]] <span class="sc">~</span> movement_df[[group]])  </span>
<span id="cb192-144"><a href="#cb192-144" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-145"><a href="#cb192-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-146"><a href="#cb192-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb192-147"><a href="#cb192-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot 'core' vs 'front'</span></span>
<span id="cb192-148"><a href="#cb192-148" aria-hidden="true" tabindex="-1"></a>boxplot_core_front <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-149"><a href="#cb192-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(movement_df, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> .data[[variable]], <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb192-150"><a href="#cb192-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb192-151"><a href="#cb192-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplots"</span>,</span>
<span id="cb192-152"><a href="#cb192-152" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Group"</span>, <span class="at">y =</span> variable) <span class="sc">+</span></span>
<span id="cb192-153"><a href="#cb192-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb192-154"><a href="#cb192-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-155"><a href="#cb192-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-156"><a href="#cb192-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot M vs. F</span></span>
<span id="cb192-157"><a href="#cb192-157" aria-hidden="true" tabindex="-1"></a>boxplot_sex <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-158"><a href="#cb192-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(movement_df, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> .data[[variable]], <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb192-159"><a href="#cb192-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb192-160"><a href="#cb192-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb192-161"><a href="#cb192-161" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Sex"</span>, <span class="at">y =</span> variable) <span class="sc">+</span></span>
<span id="cb192-162"><a href="#cb192-162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb192-163"><a href="#cb192-163" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-164"><a href="#cb192-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-165"><a href="#cb192-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot 'distance'</span></span>
<span id="cb192-166"><a href="#cb192-166" aria-hidden="true" tabindex="-1"></a>scatterplot_distance <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-167"><a href="#cb192-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(movement_df, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">y =</span> .data[[variable]])) <span class="sc">+</span></span>
<span id="cb192-168"><a href="#cb192-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb192-169"><a href="#cb192-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb192-170"><a href="#cb192-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplots"</span>,</span>
<span id="cb192-171"><a href="#cb192-171" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Distance to Noah's garden"</span>, <span class="at">y =</span> variable) <span class="sc">+</span></span>
<span id="cb192-172"><a href="#cb192-172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb192-173"><a href="#cb192-173" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-174"><a href="#cb192-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-175"><a href="#cb192-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot 'year'</span></span>
<span id="cb192-176"><a href="#cb192-176" aria-hidden="true" tabindex="-1"></a>scatterplot_year <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-177"><a href="#cb192-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(movement_df, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> .data[[variable]])) <span class="sc">+</span></span>
<span id="cb192-178"><a href="#cb192-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb192-179"><a href="#cb192-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb192-180"><a href="#cb192-180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb192-181"><a href="#cb192-181" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> variable) <span class="sc">+</span></span>
<span id="cb192-182"><a href="#cb192-182" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb192-183"><a href="#cb192-183" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-184"><a href="#cb192-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-185"><a href="#cb192-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot 'condition'</span></span>
<span id="cb192-186"><a href="#cb192-186" aria-hidden="true" tabindex="-1"></a>scatterplot_condition <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-187"><a href="#cb192-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(movement_df, <span class="fu">aes</span>(<span class="at">x =</span> Condition, <span class="at">y =</span> .data[[variable]])) <span class="sc">+</span></span>
<span id="cb192-188"><a href="#cb192-188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb192-189"><a href="#cb192-189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb192-190"><a href="#cb192-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb192-191"><a href="#cb192-191" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> variable) <span class="sc">+</span></span>
<span id="cb192-192"><a href="#cb192-192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb192-193"><a href="#cb192-193" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-194"><a href="#cb192-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-195"><a href="#cb192-195" aria-hidden="true" tabindex="-1"></a>combine_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(variable) {</span>
<span id="cb192-196"><a href="#cb192-196" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crear los cinco gráficos utilizando las funciones existentes</span></span>
<span id="cb192-197"><a href="#cb192-197" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="ot">&lt;-</span> <span class="fu">boxplot_core_front</span>(variable)</span>
<span id="cb192-198"><a href="#cb192-198" aria-hidden="true" tabindex="-1"></a>  plot2 <span class="ot">&lt;-</span> <span class="fu">boxplot_sex</span>(variable)</span>
<span id="cb192-199"><a href="#cb192-199" aria-hidden="true" tabindex="-1"></a>  plot3 <span class="ot">&lt;-</span> <span class="fu">scatterplot_distance</span>(variable)</span>
<span id="cb192-200"><a href="#cb192-200" aria-hidden="true" tabindex="-1"></a>  plot4 <span class="ot">&lt;-</span> <span class="fu">scatterplot_year</span>(variable)</span>
<span id="cb192-201"><a href="#cb192-201" aria-hidden="true" tabindex="-1"></a>  plot5 <span class="ot">&lt;-</span> <span class="fu">scatterplot_condition</span>(variable)</span>
<span id="cb192-202"><a href="#cb192-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-203"><a href="#cb192-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combinar los gráficos en una única figura</span></span>
<span id="cb192-204"><a href="#cb192-204" aria-hidden="true" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> (plot1 <span class="sc">|</span> plot2) <span class="sc">/</span> (plot3 <span class="sc">|</span> plot4 <span class="sc">|</span> plot5)</span>
<span id="cb192-205"><a href="#cb192-205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-206"><a href="#cb192-206" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mostrar el gráfico combinado</span></span>
<span id="cb192-207"><a href="#cb192-207" aria-hidden="true" tabindex="-1"></a>  combined_plot</span>
<span id="cb192-208"><a href="#cb192-208" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="paired-t-tests-boxplots-linear-regressions" class="level3">
<h3 class="anchored" data-anchor-id="paired-t-tests-boxplots-linear-regressions">7.2. Paired t-tests + boxplots + linear regressions</h3>
<section id="average-speed-while-exploring" class="level4">
<h4 class="anchored" data-anchor-id="average-speed-while-exploring">7.2.1. Average speed while exploring</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test + normality &amp; homoscedasticity check</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables to compare</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"avg_speed_moving"</span>)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>results_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_core_front)</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_core_front) <span class="ot">&lt;-</span> variables</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Males vs. females</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>results_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_sex)</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_sex) <span class="ot">&lt;-</span> variables</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify normality and homoscedasticity</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>verify_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"treatment"</span>)</span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>verify_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"Sex"</span>)</span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>results_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg_speed_moving

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$treatment
t = -1.042, df = 16.147, p-value = 0.3128
alternative hypothesis: true difference in means between group CORE and group FRONT is not equal to 0
95 percent confidence interval:
 -0.02564877  0.00873517
sample estimates:
 mean in group CORE mean in group FRONT 
         0.09237024          0.10082704 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>results_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg_speed_moving

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$Sex
t = -2.2866, df = 29.86, p-value = 0.02949
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -0.028854209 -0.001625485
sample estimates:
mean in group F mean in group M 
     0.08925133      0.10449118 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>verify_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  0.1212 0.7298
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>verify_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  0.0016 0.9681
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>model_distance <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_speed_moving <span class="sc">~</span> distance <span class="sc">+</span> Condition <span class="sc">+</span> Sex <span class="sc">+</span> temperature, <span class="at">data =</span> movement_df)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = avg_speed_moving ~ distance + Condition + Sex + 
    temperature, data = movement_df)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.033713 -0.008278  0.000310  0.008282  0.027440 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.074e-01  3.255e-02  -3.300  0.00238 ** 
distance     3.095e-07  1.038e-06   0.298  0.76742    
Condition    1.381e-01  3.106e-02   4.448  9.8e-05 ***
SexM         1.168e-02  5.440e-03   2.148  0.03943 *  
temperature  1.938e-03  7.967e-04   2.433  0.02074 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01399 on 32 degrees of freedom
Multiple R-squared:  0.6046,    Adjusted R-squared:  0.5551 
F-statistic: 12.23 on 4 and 32 DF,  p-value: 3.816e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">combine_plots</span>(variables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/avg%20speed-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="total-distance-traveled-while-exploring" class="level4">
<h4 class="anchored" data-anchor-id="total-distance-traveled-while-exploring">7.2.2. Total distance traveled while exploring</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test + normality &amp; homoscedasticity check</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables to compare</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"total_dist_trav_moving"</span>)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>results_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_core_front)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_core_front) <span class="ot">&lt;-</span> variables</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Males vs. females</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>results_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_sex)</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_sex) <span class="ot">&lt;-</span> variables</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify normality and homoscedasticity</span></span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>verify_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"treatment"</span>)</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>verify_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"Sex"</span>)</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>results_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$total_dist_trav_moving

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$treatment
t = -0.98434, df = 25.351, p-value = 0.3342
alternative hypothesis: true difference in means between group CORE and group FRONT is not equal to 0
95 percent confidence interval:
 -17.029926   6.010272
sample estimates:
 mean in group CORE mean in group FRONT 
           49.70076            55.21059 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>results_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$total_dist_trav_moving

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$Sex
t = -0.87692, df = 23.848, p-value = 0.3893
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -18.360687   7.413347
sample estimates:
mean in group F mean in group M 
       50.31792        55.79158 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>verify_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  0.9556  0.335
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>verify_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  1.2323 0.2745
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>model_distance <span class="ot">&lt;-</span> <span class="fu">lm</span>(total_dist_trav_moving <span class="sc">~</span> distance <span class="sc">+</span> Condition <span class="sc">+</span> Sex <span class="sc">+</span> temperature, <span class="at">data =</span> movement_df)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = total_dist_trav_moving ~ distance + Condition + 
    Sex + temperature, data = movement_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-27.903 -12.182  -2.492  11.660  29.267 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -5.848e+01  3.790e+01  -1.543   0.1327  
distance     3.057e-04  1.208e-03   0.253   0.8018  
Condition    6.506e+01  3.616e+01   1.799   0.0814 .
SexM         3.676e+00  6.334e+00   0.580   0.5657  
temperature  1.439e+00  9.276e-01   1.552   0.1306  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.29 on 32 degrees of freedom
Multiple R-squared:  0.2316,    Adjusted R-squared:  0.1356 
F-statistic: 2.411 on 4 and 32 DF,  p-value: 0.06949</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">combine_plots</span>(variables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/total%20distance-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="number-of-refuge-visits" class="level4">
<h4 class="anchored" data-anchor-id="number-of-refuge-visits">7.2.3. Number of refuge visits</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test + normality &amp; homoscedasticity check</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables to compare</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"n_visits_refuge"</span>)</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>results_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_core_front)</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_core_front) <span class="ot">&lt;-</span> variables</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Males vs. females</span></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>results_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_sex)</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_sex) <span class="ot">&lt;-</span> variables</span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify normality and homoscedasticity</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>verify_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"treatment"</span>)</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>verify_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"Sex"</span>)</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>results_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$n_visits_refuge

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$treatment
t = -1.7375, df = 16.595, p-value = 0.1008
alternative hypothesis: true difference in means between group CORE and group FRONT is not equal to 0
95 percent confidence interval:
 -3.1078194  0.3036236
sample estimates:
 mean in group CORE mean in group FRONT 
           4.636364            6.038462 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>results_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$n_visits_refuge

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$Sex
t = 1.9574, df = 26.194, p-value = 0.06104
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -0.07074495  2.91316919
sample estimates:
mean in group F mean in group M 
       6.466667        5.045455 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>verify_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  0.2813 0.5992
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>verify_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  0.1337 0.7168
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>model_distance <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_visits_refuge <span class="sc">~</span> distance <span class="sc">+</span> Condition <span class="sc">+</span> Sex <span class="sc">+</span> temperature, <span class="at">data =</span> movement_df)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = n_visits_refuge ~ distance + Condition + Sex + temperature, 
    data = movement_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.0183 -1.1698 -0.0217  0.9987  3.3444 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -1.863e+00  4.828e+00  -0.386   0.7021  
distance    -5.163e-05  1.539e-04  -0.335   0.7395  
Condition    4.216e+00  4.607e+00   0.915   0.3670  
SexM        -1.772e+00  8.069e-01  -2.195   0.0355 *
temperature  1.688e-01  1.182e-01   1.428   0.1629  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.075 on 32 degrees of freedom
Multiple R-squared:  0.1926,    Adjusted R-squared:  0.09168 
F-statistic: 1.908 on 4 and 32 DF,  p-value: 0.1331</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">combine_plots</span>(variables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/refuge%20visits-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="average-time-hiding" class="level4">
<h4 class="anchored" data-anchor-id="average-time-hiding">7.2.4. Average time hiding</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test + normality &amp; homoscedasticity check</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables to compare</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"avg_time_hidden"</span>)</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>results_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_core_front)</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_core_front) <span class="ot">&lt;-</span> variables</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Males vs. females</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>results_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_sex)</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_sex) <span class="ot">&lt;-</span> variables</span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify normality and homoscedasticity</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>verify_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"treatment"</span>)</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>verify_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"Sex"</span>)</span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>results_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg_time_hidden

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$treatment
t = 1.1601, df = 13.039, p-value = 0.2668
alternative hypothesis: true difference in means between group CORE and group FRONT is not equal to 0
95 percent confidence interval:
 -8.066321 26.788932
sample estimates:
 mean in group CORE mean in group FRONT 
           30.84848            21.48718 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>results_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg_time_hidden

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$Sex
t = 1.5272, df = 18.123, p-value = 0.144
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -3.924404 24.852788
sample estimates:
mean in group F mean in group M 
       30.49222        20.02803 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>verify_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.4107 0.1295
      35               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>verify_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  1  3.9949 0.05345 .
      35                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>model_distance <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_time_hidden <span class="sc">~</span> distance <span class="sc">+</span> Condition <span class="sc">+</span> Sex <span class="sc">+</span> temperature, <span class="at">data =</span> movement_df)</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = avg_time_hidden ~ distance + Condition + Sex + temperature, 
    data = movement_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-21.894 -12.788  -2.632   5.615  41.634 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  1.194e+02  4.066e+01   2.935  0.00613 **
distance     1.236e-04  1.296e-03   0.095  0.92463   
Condition   -4.522e+01  3.880e+01  -1.166  0.25241   
SexM        -7.870e+00  6.796e+00  -1.158  0.25545   
temperature -1.619e+00  9.953e-01  -1.627  0.11357   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.48 on 32 degrees of freedom
Multiple R-squared:  0.2078,    Adjusted R-squared:  0.1088 
F-statistic: 2.099 on 4 and 32 DF,  p-value: 0.104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">combine_plots</span>(variables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/avg%20time%20hidden-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="average-time-between-refuge-visits" class="level4">
<h4 class="anchored" data-anchor-id="average-time-between-refuge-visits">7.2.5. Average time between refuge visits</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test + normality &amp; homoscedasticity check</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables to compare</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"avg_time_bw_refuges"</span>)</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Front vs. core</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>results_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_core_front)</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_core_front) <span class="ot">&lt;-</span> variables</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Males vs. females</span></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>results_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, compare_sex)</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(results_sex) <span class="ot">&lt;-</span> variables</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify normality and homoscedasticity</span></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a>verify_core_front <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"treatment"</span>)</span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>verify_sex <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables, verify_norm, <span class="at">group =</span> <span class="st">"Sex"</span>)</span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>results_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg_time_bw_refuges

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$treatment
t = 1.2161, df = 17.321, p-value = 0.2403
alternative hypothesis: true difference in means between group CORE and group FRONT is not equal to 0
95 percent confidence interval:
 -18.36256  68.49923
sample estimates:
 mean in group CORE mean in group FRONT 
           141.3767            116.3083 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>results_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg_time_bw_refuges

    Welch Two Sample t-test

data:  movement_df[[variable]] by movement_df$Sex
t = -1.0522, df = 33.765, p-value = 0.3002
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -55.61414  17.67669
sample estimates:
mean in group F mean in group M 
       111.6798        130.6485 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>verify_core_front</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  0.4426 0.5104
      34               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>verify_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.2173 0.1457
      34               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>model_distance <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_time_bw_refuges <span class="sc">~</span> distance <span class="sc">+</span> Condition <span class="sc">+</span> Sex <span class="sc">+</span> temperature, <span class="at">data =</span> movement_df)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = avg_time_bw_refuges ~ distance + Condition + Sex + 
    temperature, data = movement_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-111.803  -35.028   -9.471   37.225  112.966 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 132.136070 140.324486   0.942    0.354
distance     -0.002935   0.004406  -0.666    0.510
Condition   -12.359148 133.191952  -0.093    0.927
SexM         11.507480  23.340636   0.493    0.625
temperature   0.896479   3.383519   0.265    0.793

Residual standard error: 59.39 on 31 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.04697,   Adjusted R-squared:  -0.076 
F-statistic: 0.3819 on 4 and 31 DF,  p-value: 0.8198</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">combine_plots</span>(variables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Snake_tracking_clean_script_files/figure-html/avg%20time%20bw%20refuges-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>